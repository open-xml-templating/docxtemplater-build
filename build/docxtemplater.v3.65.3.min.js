(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Docxtemplater=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var validLen=b64.indexOf("=");if(validLen===-1)validLen=len;var placeHoldersLen=validLen===len?0:4-validLen%4;return[validLen,placeHoldersLen]}function byteLength(b64){var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function _byteLength(b64,validLen,placeHoldersLen){return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function toByteArray(b64){var tmp;var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen));var curByte=0;var len=placeHoldersLen>0?validLen-4:validLen;for(var i=0;i<len;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[curByte++]=tmp>>16&255;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}if(placeHoldersLen===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[curByte++]=tmp&255}if(placeHoldersLen===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255);output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"=")}return parts.join("")}},{}],2:[function(require,module,exports){"use strict";var base64=require("base64-js");var ieee754=require("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}var buf=new Uint8Array(length);buf.__proto__=Buffer.prototype;return buf}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="string"){return fromString(value,encodingOrOffset)}if(ArrayBuffer.isView(value)){return fromArrayLike(value)}if(value==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var valueOf=value.valueOf&&value.valueOf();if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}var b=fromObject(value);if(b)return b;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==="function"){return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer.allocUnsafe=function(size){return allocUnsafe(size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer.prototype;return buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj.length!==undefined){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true&&b!==Buffer.prototype};Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength);if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength);if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof string)}var len=string.length;var mustMatch=arguments.length>2&&arguments[2]===true;if(!mustMatch&&len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4)}return this};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();if(this.length>max)str+=" ... ";return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof target)}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break}}if(found)return i}}return-1}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(this===target&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}if(val.length===1){var code=val.charCodeAt(0);if(encoding==="utf8"&&code<128||encoding==="latin1"){val=code}}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding);var len=bytes.length;if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.split("=")[0];str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isInstance(obj,type){return obj instanceof type||obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!==obj}},{"base64-js":1,ieee754:3}],3:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],4:[function(require,module,exports){"use strict";var coreContentType="application/vnd.openxmlformats-package.core-properties+xml";var appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml";var customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml";var settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml";var diagramDataContentType="application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml";var diagramDrawingContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml";module.exports={settingsContentType:settingsContentType,coreContentType:coreContentType,appContentType:appContentType,customContentType:customContentType,diagramDataContentType:diagramDataContentType,diagramDrawingContentType:diagramDrawingContentType}},{}],5:[function(require,module,exports){"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}var _require=require("@xmldom/xmldom"),DOMParser=_require.DOMParser,XMLSerializer=_require.XMLSerializer;var _require2=require("./errors.js"),throwXmlTagNotFound=_require2.throwXmlTagNotFound;var _require3=require("./utils.js"),last=_require3.last,first=_require3.first;function isWhiteSpace(value){return/^[ \n\r\t]+$/.test(value)}function parser(tag){return{get:function get(scope){if(tag==="."){return scope}if(scope){return scope[tag]}return scope}}}var attrToRegex={};function setSingleAttribute(partValue,attr,attrValue){var regex;if(attrToRegex[attr]){regex=attrToRegex[attr]}else{regex=new RegExp("(<.* ".concat(attr,'=")([^"]*)(".*)$'));attrToRegex[attr]=regex}if(regex.test(partValue)){return partValue.replace(regex,"$1".concat(attrValue,"$3"))}var end=partValue.lastIndexOf("/>");if(end===-1){end=partValue.lastIndexOf(">")}return partValue.substr(0,end)+" ".concat(attr,'="').concat(attrValue,'"')+partValue.substr(end)}function getSingleAttribute(value,attributeName){var index=value.indexOf(" ".concat(attributeName,'="'));if(index===-1){return null}var startIndex=value.substr(index).search(/["']/)+index;var endIndex=value.substr(startIndex+1).search(/["']/)+startIndex;return value.substr(startIndex+1,endIndex-startIndex)}function endsWith(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1}function startsWith(str,prefix){return str.substring(0,prefix.length)===prefix}function getDuplicates(arr){var duplicates=[];var hash={},result=[];for(var i=0,l=arr.length;i<l;++i){if(!hash[arr[i]]){hash[arr[i]]=true;result.push(arr[i])}else{duplicates.push(arr[i])}}return duplicates}function uniq(arr){var hash={},result=[];for(var i=0,l=arr.length;i<l;++i){if(!hash[arr[i]]){hash[arr[i]]=true;result.push(arr[i])}}return result}function chunkBy(parsed,f){var chunks=[[]];for(var _i2=0;_i2<parsed.length;_i2++){var p=parsed[_i2];var currentChunk=chunks[chunks.length-1];var res=f(p);if(res==="start"){chunks.push([p])}else if(res==="end"){currentChunk.push(p);chunks.push([])}else{currentChunk.push(p)}}var result=[];for(var _i4=0;_i4<chunks.length;_i4++){var chunk=chunks[_i4];if(chunk.length>0){result.push(chunk)}}return result}function getDefaults(){return{errorLogging:"json",stripInvalidXMLChars:false,paragraphLoop:false,nullGetter:function nullGetter(part){return part.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:parser,linebreaks:false,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{changeDelimiterPrefix:"="}}}function xml2str(xmlNode){return(new XMLSerializer).serializeToString(xmlNode).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")}function str2xml(str){if(str.charCodeAt(0)===65279){str=str.substr(1)}return(new DOMParser).parseFromString(str,"text/xml")}var charMap=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]];var charMapRegexes=charMap.map(function(_ref){var _ref2=_slicedToArray(_ref,2),endChar=_ref2[0],startChar=_ref2[1];return{rstart:new RegExp(startChar,"g"),rend:new RegExp(endChar,"g"),start:startChar,end:endChar}});function wordToUtf8(string){for(var i=charMapRegexes.length-1;i>=0;i--){var r=charMapRegexes[i];string=string.replace(r.rstart,r.end)}return string}function utf8ToWord(string){var _string;if((_string=string)!==null&&_string!==void 0&&_string.toString){string=string.toString()}else{string=""}var r;for(var i=0,l=charMapRegexes.length;i<l;i++){r=charMapRegexes[i];string=string.replace(r.rend,r.start)}return string}function concatArrays(arrays){var result=[];for(var _i6=0;_i6<arrays.length;_i6++){var array=arrays[_i6];for(var _i8=0;_i8<array.length;_i8++){var el=array[_i8];result.push(el)}}return result}function pushArray(array1,array2){if(!array2){return array1}for(var i=0,len=array2.length;i<len;i++){array1.push(array2[i])}return array1}var spaceRegexp=new RegExp(String.fromCharCode(160),"g");function convertSpaces(s){return s.replace(spaceRegexp," ")}function pregMatchAll(regex,content){var matchArray=[];var match;while((match=regex.exec(content))!=null){matchArray.push({array:match,offset:match.index})}return matchArray}function isEnding(value,element){return value==="</"+element+">"}function isStarting(value,element){return value.indexOf("<"+element)===0&&[">"," ","/"].indexOf(value[element.length+1])!==-1}function getRight(parsed,element,index){var val=getRightOrNull(parsed,element,index);if(val!==null){return val}throwXmlTagNotFound({position:"right",element:element,parsed:parsed,index:index})}function getRightOrNull(parsed,elements,index){if(typeof elements==="string"){elements=[elements]}var level=1;for(var i=index,l=parsed.length;i<l;i++){var part=parsed[i];for(var _i0=0,_elements2=elements;_i0<_elements2.length;_i0++){var element=_elements2[_i0];if(isEnding(part.value,element)){level--}if(isStarting(part.value,element)){level++}if(level===0){return i}}}return null}function getLeft(parsed,element,index){var val=getLeftOrNull(parsed,element,index);if(val!==null){return val}throwXmlTagNotFound({position:"left",element:element,parsed:parsed,index:index})}function getLeftOrNull(parsed,elements,index){if(typeof elements==="string"){elements=[elements]}var level=1;for(var i=index;i>=0;i--){var part=parsed[i];for(var _i10=0,_elements4=elements;_i10<_elements4.length;_i10++){var element=_elements4[_i10];if(isStarting(part.value,element)){level--}if(isEnding(part.value,element)){level++}if(level===0){return i}}}return null}function isTagStart(tagType,_ref3){var type=_ref3.type,tag=_ref3.tag,position=_ref3.position;return type==="tag"&&tag===tagType&&(position==="start"||position==="selfclosing")}function isTagEnd(tagType,_ref4){var type=_ref4.type,tag=_ref4.tag,position=_ref4.position;return type==="tag"&&tag===tagType&&position==="end"}function isParagraphStart(_ref5){var type=_ref5.type,tag=_ref5.tag,position=_ref5.position;return["w:p","a:p"].indexOf(tag)!==-1&&type==="tag"&&position==="start"}function isParagraphEnd(_ref6){var type=_ref6.type,tag=_ref6.tag,position=_ref6.position;return["w:p","a:p"].indexOf(tag)!==-1&&type==="tag"&&position==="end"}function isTextStart(_ref7){var type=_ref7.type,position=_ref7.position,text=_ref7.text;return text&&type==="tag"&&position==="start"}function isTextEnd(_ref8){var type=_ref8.type,position=_ref8.position,text=_ref8.text;return text&&type==="tag"&&position==="end"}function isContent(_ref9){var type=_ref9.type,position=_ref9.position;return type==="placeholder"||type==="content"&&position==="insidetag"}function isModule(_ref0,modules){var module=_ref0.module,type=_ref0.type;if(!(modules instanceof Array)){modules=[modules]}return type==="placeholder"&&modules.indexOf(module)!==-1}var corruptCharacters=/[\x00-\x08\x0B\x0C\x0E-\x1F]/g;function hasCorruptCharacters(string){corruptCharacters.lastIndex=0;return corruptCharacters.test(string)}function removeCorruptCharacters(string){if(typeof string!=="string"){string=String(string)}return string.replace(corruptCharacters,"")}function invertMap(map){var invertedMap={};for(var key in map){var value=map[key];invertedMap[value]||(invertedMap[value]=[]);invertedMap[value].push(key)}return invertedMap}function stableSort(arr,compare){return arr.map(function(item,index){return{item:item,index:index}}).sort(function(a,b){return compare(a.item,b.item)||a.index-b.index}).map(function(_ref1){var item=_ref1.item;return item})}module.exports={endsWith:endsWith,startsWith:startsWith,isContent:isContent,isParagraphStart:isParagraphStart,isParagraphEnd:isParagraphEnd,isTagStart:isTagStart,isTagEnd:isTagEnd,isTextStart:isTextStart,isTextEnd:isTextEnd,isStarting:isStarting,isEnding:isEnding,isModule:isModule,uniq:uniq,getDuplicates:getDuplicates,chunkBy:chunkBy,last:last,first:first,xml2str:xml2str,str2xml:str2xml,getRightOrNull:getRightOrNull,getRight:getRight,getLeftOrNull:getLeftOrNull,getLeft:getLeft,pregMatchAll:pregMatchAll,convertSpaces:convertSpaces,charMapRegexes:charMapRegexes,hasCorruptCharacters:hasCorruptCharacters,removeCorruptCharacters:removeCorruptCharacters,getDefaults:getDefaults,wordToUtf8:wordToUtf8,utf8ToWord:utf8ToWord,concatArrays:concatArrays,pushArray:pushArray,invertMap:invertMap,charMap:charMap,getSingleAttribute:getSingleAttribute,setSingleAttribute:setSingleAttribute,isWhiteSpace:isWhiteSpace,stableSort:stableSort}},{"./errors.js":7,"./utils.js":31,"@xmldom/xmldom":40}],6:[function(require,module,exports){"use strict";var _require=require("./doc-utils.js"),pushArray=_require.pushArray;function replaceErrors(key,value){if(value instanceof Error){return pushArray(Object.getOwnPropertyNames(value),["stack"]).reduce(function(error,key){error[key]=value[key];if(key==="stack"){error[key]=value[key].toString()}return error},{})}return value}function logger(error,logging){console.log(JSON.stringify({error:error},replaceErrors,logging==="json"?2:null));if(error.properties&&error.properties.errors instanceof Array){var errorMessages=error.properties.errors.map(function(error){return error.properties.explanation}).join("\n");console.log("errorMessages",errorMessages)}}module.exports=logger},{"./doc-utils.js":5}],7:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("./utils.js"),last=_require.last,first=_require.first;function XTError(message){this.name="GenericError";this.message=message;this.stack=new Error(message).stack}XTError.prototype=Error.prototype;function XTTemplateError(message){this.name="TemplateError";this.message=message;this.stack=new Error(message).stack}XTTemplateError.prototype=new XTError;function XTRenderingError(message){this.name="RenderingError";this.message=message;this.stack=new Error(message).stack}XTRenderingError.prototype=new XTError;function XTScopeParserError(message){this.name="ScopeParserError";this.message=message;this.stack=new Error(message).stack}XTScopeParserError.prototype=new XTError;function XTInternalError(message){this.name="InternalError";this.properties={explanation:"InternalError"};this.message=message;this.stack=new Error(message).stack}XTInternalError.prototype=new XTError;function XTAPIVersionError(message){this.name="APIVersionError";this.properties={explanation:"APIVersionError"};this.message=message;this.stack=new Error(message).stack}XTAPIVersionError.prototype=new XTError;function throwApiVersionError(msg,properties){var err=new XTAPIVersionError(msg);err.properties=_objectSpread({id:"api_version_error"},properties);throw err}function throwMultiError(errors){var err=new XTTemplateError("Multi error");err.properties={errors:errors,id:"multi_error",explanation:"The template has multiple errors"};throw err}function getUnopenedTagException(options){var err=new XTTemplateError("Unopened tag");err.properties={xtag:last(options.xtag.split(" ")),id:"unopened_tag",context:options.xtag,offset:options.offset,lIndex:options.lIndex,explanation:'The tag beginning with "'.concat(options.xtag.substr(0,10),'" is unopened')};return err}function getDuplicateOpenTagException(options){var err=new XTTemplateError("Duplicate open tag, expected one open tag");err.properties={xtag:first(options.xtag.split(" ")),id:"duplicate_open_tag",context:options.xtag,offset:options.offset,lIndex:options.lIndex,explanation:'The tag beginning with "'.concat(options.xtag.substr(0,10),'" has duplicate open tags')};return err}function getDuplicateCloseTagException(options){var err=new XTTemplateError("Duplicate close tag, expected one close tag");err.properties={xtag:first(options.xtag.split(" ")),id:"duplicate_close_tag",context:options.xtag,offset:options.offset,lIndex:options.lIndex,explanation:'The tag ending with "'.concat(options.xtag.substr(0,10),'" has duplicate close tags')};return err}function getUnclosedTagException(options){var err=new XTTemplateError("Unclosed tag");err.properties={xtag:first(options.xtag.split(" ")).substr(1),id:"unclosed_tag",context:options.xtag,offset:options.offset,lIndex:options.lIndex,explanation:'The tag beginning with "'.concat(options.xtag.substr(0,10),'" is unclosed')};return err}function throwXmlTagNotFound(options){var err=new XTTemplateError('No tag "'.concat(options.element,'" was found at the ').concat(options.position));var part=options.parsed[options.index];err.properties={id:"no_xml_tag_found_at_".concat(options.position),explanation:'No tag "'.concat(options.element,'" was found at the ').concat(options.position),offset:part.offset,part:part,parsed:options.parsed,index:options.index,element:options.element};throw err}function getCorruptCharactersException(_ref){var tag=_ref.tag,value=_ref.value,offset=_ref.offset;var err=new XTRenderingError("There are some XML corrupt characters");err.properties={id:"invalid_xml_characters",xtag:tag,value:value,offset:offset,explanation:"There are some corrupt characters for the field ".concat(tag)};return err}function getInvalidRawXMLValueException(_ref2){var tag=_ref2.tag,value=_ref2.value,offset=_ref2.offset;var err=new XTRenderingError("Non string values are not allowed for rawXML tags");err.properties={id:"invalid_raw_xml_value",xtag:tag,value:value,offset:offset,explanation:"The value of the raw tag : '".concat(tag,"' is not a string")};return err}function throwExpandNotFound(options){var _options$part=options.part,value=_options$part.value,offset=_options$part.offset,_options$id=options.id,id=_options$id===void 0?"raw_tag_outerxml_invalid":_options$id,_options$message=options.message,message=_options$message===void 0?"Raw tag not in paragraph":_options$message;var part=options.part;var _options$explanation=options.explanation,explanation=_options$explanation===void 0?'The tag "'.concat(value,'" is not inside a paragraph'):_options$explanation;if(typeof explanation==="function"){explanation=explanation(part)}var err=new XTTemplateError(message);err.properties={id:id,explanation:explanation,rootError:options.rootError,xtag:value,offset:offset,postparsed:options.postparsed,expandTo:options.expandTo,index:options.index};throw err}function throwRawTagShouldBeOnlyTextInParagraph(options){var err=new XTTemplateError("Raw tag should be the only text in paragraph");var tag=options.part.value;err.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(tag,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:tag,offset:options.part.offset,paragraphParts:options.paragraphParts};throw err}function getUnmatchedLoopException(part){var location=part.location,offset=part.offset,square=part.square;var t=location==="start"?"unclosed":"unopened";var T=location==="start"?"Unclosed":"Unopened";var err=new XTTemplateError("".concat(T," loop"));var tag=part.value;err.properties={id:"".concat(t,"_loop"),explanation:'The loop with tag "'.concat(tag,'" is ').concat(t),xtag:tag,offset:offset};if(square){err.properties.square=square}return err}function getUnbalancedLoopException(pair,lastPair){var err=new XTTemplateError("Unbalanced loop tag");var lastL=lastPair[0].part.value;var lastR=lastPair[1].part.value;var l=pair[0].part.value;var r=pair[1].part.value;err.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(lastL,"}{/").concat(lastR,"}{#").concat(l,"}{/").concat(r,"}"),offset:[lastPair[0].part.offset,pair[1].part.offset],lastPair:{left:lastPair[0].part.value,right:lastPair[1].part.value},pair:{left:pair[0].part.value,right:pair[1].part.value}};return err}function getClosingTagNotMatchOpeningTag(_ref3){var tags=_ref3.tags;var err=new XTTemplateError("Closing tag does not match opening tag");err.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(tags[0].value,'" is closed by the tag "').concat(tags[1].value,'"'),openingtag:first(tags).value,offset:[first(tags).offset,last(tags).offset],closingtag:last(tags).value};if(first(tags).square){err.properties.square=[first(tags).square,last(tags).square]}return err}function getScopeCompilationError(_ref4){var tag=_ref4.tag,rootError=_ref4.rootError,offset=_ref4.offset;var err=new XTScopeParserError("Scope parser compilation failed");err.properties={id:"scopeparser_compilation_failed",offset:offset,xtag:tag,explanation:'The scope parser for the tag "'.concat(tag,'" failed to compile'),rootError:rootError};return err}function getScopeParserExecutionError(_ref5){var tag=_ref5.tag,scope=_ref5.scope,error=_ref5.error,offset=_ref5.offset;var err=new XTScopeParserError("Scope parser execution failed");err.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(tag," failed to execute"),scope:scope,offset:offset,xtag:tag,rootError:error};return err}function getLoopPositionProducesInvalidXMLError(_ref6){var tag=_ref6.tag,offset=_ref6.offset;var err=new XTTemplateError('The position of the loop tags "'.concat(tag,'" would produce invalid XML'));err.properties={xtag:tag,id:"loop_position_invalid",explanation:'The tags "'.concat(tag,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:offset};return err}function throwUnimplementedTagType(part,index){var errorMsg='Unimplemented tag type "'.concat(part.type,'"');if(part.module){errorMsg+=' "'.concat(part.module,'"')}var err=new XTTemplateError(errorMsg);err.properties={part:part,index:index,id:"unimplemented_tag_type"};throw err}function throwMalformedXml(){var err=new XTInternalError("Malformed xml");err.properties={explanation:"The template contains malformed xml",id:"malformed_xml"};throw err}function throwResolveBeforeCompile(){var err=new XTInternalError("You must run `.compile()` before running `.resolveData()`");err.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"};throw err}function throwRenderInvalidTemplate(){var err=new XTInternalError("You should not call .render on a document that had compilation errors");err.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"};throw err}function throwRenderTwice(){var err=new XTInternalError("You should not call .render twice on the same docxtemplater instance");err.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"};throw err}function throwFileTypeNotIdentified(zip){var files=Object.keys(zip.files).slice(0,10);var msg="";if(files.length===0){msg="Empty zip file"}else{msg="Zip file contains : ".concat(files.join(","))}var err=new XTInternalError("The filetype for this file could not be identified, is this file corrupted ? ".concat(msg));err.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ? ".concat(msg)};throw err}function throwXmlInvalid(content,offset){var err=new XTTemplateError("An XML file has invalid xml");err.properties={id:"file_has_invalid_xml",content:content,offset:offset,explanation:"The docx contains invalid XML, it is most likely corrupt"};throw err}function throwFileTypeNotHandled(fileType){var err=new XTInternalError('The filetype "'.concat(fileType,'" is not handled by docxtemplater'));err.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(fileType,'", but only docx and pptx formats are handled'),fileType:fileType};throw err}module.exports={XTError:XTError,XTTemplateError:XTTemplateError,XTInternalError:XTInternalError,XTScopeParserError:XTScopeParserError,XTAPIVersionError:XTAPIVersionError,RenderingError:XTRenderingError,XTRenderingError:XTRenderingError,getClosingTagNotMatchOpeningTag:getClosingTagNotMatchOpeningTag,getLoopPositionProducesInvalidXMLError:getLoopPositionProducesInvalidXMLError,getScopeCompilationError:getScopeCompilationError,getScopeParserExecutionError:getScopeParserExecutionError,getUnclosedTagException:getUnclosedTagException,getUnopenedTagException:getUnopenedTagException,getUnmatchedLoopException:getUnmatchedLoopException,getDuplicateCloseTagException:getDuplicateCloseTagException,getDuplicateOpenTagException:getDuplicateOpenTagException,getCorruptCharactersException:getCorruptCharactersException,getInvalidRawXMLValueException:getInvalidRawXMLValueException,getUnbalancedLoopException:getUnbalancedLoopException,throwApiVersionError:throwApiVersionError,throwFileTypeNotHandled:throwFileTypeNotHandled,throwFileTypeNotIdentified:throwFileTypeNotIdentified,throwMalformedXml:throwMalformedXml,throwMultiError:throwMultiError,throwExpandNotFound:throwExpandNotFound,throwRawTagShouldBeOnlyTextInParagraph:throwRawTagShouldBeOnlyTextInParagraph,throwUnimplementedTagType:throwUnimplementedTagType,throwXmlTagNotFound:throwXmlTagNotFound,throwXmlInvalid:throwXmlInvalid,throwResolveBeforeCompile:throwResolveBeforeCompile,throwRenderInvalidTemplate:throwRenderInvalidTemplate,throwRenderTwice:throwRenderTwice}},{"./utils.js":31}],8:[function(require,module,exports){"use strict";var loopModule=require("./modules/loop.js");var spacePreserveModule=require("./modules/space-preserve.js");var rawXmlModule=require("./modules/rawxml.js");var expandPairTrait=require("./modules/expand-pair-trait.js");var render=require("./modules/render.js");function DocXFileTypeConfig(){return{getTemplatedFiles:function getTemplatedFiles(){return[]},textPath:function textPath(doc){return doc.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","w:t","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:true}],tagRawXml:"w:p",baseModules:[loopModule,spacePreserveModule,expandPairTrait,rawXmlModule,render],tagShouldContain:[{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:tr",shouldContain:["w:tc"],drop:true},{tag:"w:tbl",shouldContain:["w:tr"],drop:true}]}}function PptXFileTypeConfig(){return{getTemplatedFiles:function getTemplatedFiles(){return[]},textPath:function textPath(doc){return doc.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:graphicData","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:true}],tagRawXml:"p:sp",baseModules:[loopModule,expandPairTrait,rawXmlModule,render],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],dropParent:"p:graphicFrame"},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}module.exports={docx:DocXFileTypeConfig,pptx:PptXFileTypeConfig}},{"./modules/expand-pair-trait.js":19,"./modules/loop.js":20,"./modules/rawxml.js":21,"./modules/render.js":22,"./modules/space-preserve.js":23}],9:[function(require,module,exports){"use strict";var docxContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml";var docxmContentType="application/vnd.ms-word.document.macroEnabled.main+xml";var dotxContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml";var dotmContentType="application/vnd.ms-word.template.macroEnabledTemplate.main+xml";var headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml";var footnotesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml";var commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml";var footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml";var pptxContentType="application/vnd.openxmlformats-officedocument.presentationml.slide+xml";var pptxSlideMaster="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml";var pptxSlideLayout="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml";var pptxPresentationContentType="application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml";var xlsxContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml";var xlsmContentType="application/vnd.ms-excel.sheet.macroEnabled.main+xml";var xlsxWorksheetContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml";var main=[docxContentType,docxmContentType,dotxContentType,dotmContentType];var filetypes={main:main,docx:[headerContentType].concat(main,[footerContentType,footnotesContentType,commentsContentType]),pptx:[pptxContentType,pptxSlideMaster,pptxSlideLayout,pptxPresentationContentType],xlsx:[xlsxContentType,xlsmContentType,xlsxWorksheetContentType]};module.exports=filetypes},{}],10:[function(require,module,exports){"use strict";var _require=require("./doc-utils.js"),str2xml=_require.str2xml;var ctXML="[Content_Types].xml";function collectContentTypes(overrides,defaults,zip){var partNames={};for(var _i2=0;_i2<overrides.length;_i2++){var override=overrides[_i2];var contentType=override.getAttribute("ContentType");var partName=override.getAttribute("PartName").substr(1);partNames[partName]=contentType}var _loop=function _loop(){var def=defaults[_i4];var contentType=def.getAttribute("ContentType");var extension=def.getAttribute("Extension");zip.file(/./).map(function(_ref){var name=_ref.name;if(name.slice(name.length-extension.length)===extension&&!partNames[name]&&name!==ctXML){partNames[name]=contentType}})};for(var _i4=0;_i4<defaults.length;_i4++){_loop()}return partNames}function getContentTypes(zip){var contentTypes=zip.files[ctXML];var contentTypeXml=contentTypes?str2xml(contentTypes.asText()):null;var overrides=contentTypeXml?contentTypeXml.getElementsByTagName("Override"):null;var defaults=contentTypeXml?contentTypeXml.getElementsByTagName("Default"):null;return{overrides:overrides,defaults:defaults,contentTypes:contentTypes,contentTypeXml:contentTypeXml}}module.exports={collectContentTypes:collectContentTypes,getContentTypes:getContentTypes}},{"./doc-utils.js":5}],11:[function(require,module,exports){"use strict";var _require=require("./doc-utils.js"),str2xml=_require.str2xml;var relsFile="_rels/.rels";function getRelsTypes(zip){var rootRels=zip.files[relsFile];var rootRelsXml=rootRels?str2xml(rootRels.asText()):null;var rootRelationships=rootRelsXml?rootRelsXml.getElementsByTagName("Relationship"):[];var relsTypes={};for(var _i2=0;_i2<rootRelationships.length;_i2++){var relation=rootRelationships[_i2];relsTypes[relation.getAttribute("Target")]=relation.getAttribute("Type")}return relsTypes}module.exports={getRelsTypes:getRelsTypes}},{"./doc-utils.js":5}],12:[function(require,module,exports){"use strict";function getResolvedId(part,options){if(part.lIndex==null){return null}var path=options.scopeManager.scopePathItem;if(part.parentPart){path=path.slice(0,path.length-1)}var res=options.filePath+"@"+part.lIndex.toString()+"-"+path.join("-");return res}module.exports=getResolvedId},{}],13:[function(require,module,exports){"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function isPlaceholder(part){return part.type==="placeholder"}function getTags(postParsed){var tags={};var stack=[{items:postParsed.filter(isPlaceholder),parents:[],path:[]}];function processFiltered(part,current,filtered){if(filtered.length){stack.push({items:filtered,parents:[].concat(_toConsumableArray(current.parents),[part]),path:part.dataBound!==false&&!part.attrParsed&&part.value&&!part.attrParsed?[].concat(_toConsumableArray(current.path),[part.value]):_toConsumableArray(current.path)})}}function getLocalTags(tags,path){var sizeScope=arguments.length>2&&arguments[2]!==undefined?arguments[2]:path.length;var localTags=tags;for(var i=0;i<sizeScope;i++){localTags=localTags[path[i]]}return localTags}function getScopeSize(part,parents){var size=parents.length;for(var _i2=0;_i2<parents.length;_i2++){var parent=parents[_i2];var lIndexLoop=typeof parent.lIndex==="number"?parent.lIndex:parseInt(parent.lIndex.split("-")[0],10);if(lIndexLoop>part.lIndex){size--}}return size}while(stack.length>0){var current=stack.pop();var localTags=getLocalTags(tags,current.path);for(var _i4=0,_current$items2=current.items;_i4<_current$items2.length;_i4++){var _localTags4,_part$value2;var part=_current$items2[_i4];if(part.attrParsed){for(var key in part.attrParsed){processFiltered(part,current,part.attrParsed[key].filter(isPlaceholder))}continue}if(part.subparsed){if(part.dataBound!==false){var _localTags,_part$value;(_localTags=localTags)[_part$value=part.value]||(_localTags[_part$value]={})}processFiltered(part,current,part.subparsed.filter(isPlaceholder));continue}if(part.cellParsed){for(var _i6=0,_part$cellPostParsed2=part.cellPostParsed;_i6<_part$cellPostParsed2.length;_i6++){var cp=_part$cellPostParsed2[_i6];if(cp.type==="placeholder"){if(cp.module==="pro-xml-templating/xls-module-loop"){continue}else if(cp.subparsed){var _localTags2,_cp$value;(_localTags2=localTags)[_cp$value=cp.value]||(_localTags2[_cp$value]={});processFiltered(cp,current,cp.subparsed.filter(isPlaceholder))}else{var _localTags3,_cp$value2;var sizeScope=getScopeSize(part,current.parents);localTags=getLocalTags(tags,current.path,sizeScope);(_localTags3=localTags)[_cp$value2=cp.value]||(_localTags3[_cp$value2]={})}}}continue}if(part.dataBound===false){continue}(_localTags4=localTags)[_part$value2=part.value]||(_localTags4[_part$value2]={})}}return tags}module.exports={getTags:getTags,isPlaceholder:isPlaceholder}},{}],14:[function(require,module,exports){"use strict";var _require=require("./doc-utils.js"),startsWith=_require.startsWith,endsWith=_require.endsWith,isStarting=_require.isStarting,isEnding=_require.isEnding,isWhiteSpace=_require.isWhiteSpace;var filetypes=require("./filetypes.js");function addEmptyParagraphAfterTable(parts){var lastNonEmpty="";for(var i=0,len=parts.length;i<len;i++){var p=parts[i];if(isWhiteSpace(p)||startsWith(p,"<w:bookmarkEnd")){continue}if(endsWith(lastNonEmpty,"</w:tbl>")){if(!startsWith(p,"<w:p")&&!startsWith(p,"<w:tbl")&&!startsWith(p,"<w:sectPr")){p="<w:p/>".concat(p)}}lastNonEmpty=p;parts[i]=p}return parts}function joinUncorrupt(parts,options){var contains=options.fileTypeConfig.tagShouldContain||[];var collecting="";var currentlyCollecting=-1;if(filetypes.docx.indexOf(options.contentType)!==-1){parts=addEmptyParagraphAfterTable(parts)}var startIndex=-1;for(var j=0,len2=contains.length;j<len2;j++){var _contains$j=contains[j],tag=_contains$j.tag,shouldContain=_contains$j.shouldContain,value=_contains$j.value,drop=_contains$j.drop,dropParent=_contains$j.dropParent;for(var i=0,len=parts.length;i<len;i++){var part=parts[i];if(currentlyCollecting===j){if(isEnding(part,tag)){currentlyCollecting=-1;if(dropParent){var start=-1;for(var k=startIndex;k>0;k--){if(isStarting(parts[k],dropParent)){start=k;break}}for(var _k=start;_k<=parts.length;_k++){if(isEnding(parts[_k],dropParent)){parts[_k]="";break}parts[_k]=""}}else{for(var _k2=startIndex;_k2<=i;_k2++){parts[_k2]=""}if(!drop){parts[i]=collecting+value+part}}}collecting+=part;for(var _k3=0,len3=shouldContain.length;_k3<len3;_k3++){var sc=shouldContain[_k3];if(isStarting(part,sc)){currentlyCollecting=-1;break}}}if(currentlyCollecting===-1&&isStarting(part,tag)&&part.substr(1).indexOf("<")===-1){if(part[part.length-2]==="/"){parts[i]=""}else{startIndex=i;currentlyCollecting=j;collecting=part}}}}return parts}module.exports=joinUncorrupt},{"./doc-utils.js":5,"./filetypes.js":9}],15:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("./errors.js"),getUnclosedTagException=_require.getUnclosedTagException,getUnopenedTagException=_require.getUnopenedTagException,getDuplicateOpenTagException=_require.getDuplicateOpenTagException,getDuplicateCloseTagException=_require.getDuplicateCloseTagException,throwMalformedXml=_require.throwMalformedXml,throwXmlInvalid=_require.throwXmlInvalid,XTTemplateError=_require.XTTemplateError;var _require2=require("./doc-utils.js"),isTextStart=_require2.isTextStart,isTextEnd=_require2.isTextEnd,wordToUtf8=_require2.wordToUtf8,pushArray=_require2.pushArray;var DELIMITER_NONE=0,DELIMITER_EQUAL=1,DELIMITER_START=2,DELIMITER_END=3;function inRange(range,match){return range[0]<=match.offset&&match.offset<range[1]}function updateInTextTag(part,inTextTag){if(isTextStart(part)){if(inTextTag){throwMalformedXml()}return true}if(isTextEnd(part)){if(!inTextTag){throwMalformedXml()}return false}return inTextTag}function getTag(tag){var position="";var start=1;var end=tag.indexOf(" ");if(tag[tag.length-2]==="/"){position="selfclosing";if(end===-1){end=tag.length-2}}else if(tag[1]==="/"){start=2;position="end";if(end===-1){end=tag.length-1}}else{position="start";if(end===-1){end=tag.length-1}}return{tag:tag.slice(start,end),position:position}}function tagMatcher(content,textMatchArray,othersMatchArray){var cursor=0;var contentLength=content.length;var allMatches={};for(var _i2=0;_i2<textMatchArray.length;_i2++){var m=textMatchArray[_i2];allMatches[m]=true}for(var _i4=0;_i4<othersMatchArray.length;_i4++){var _m=othersMatchArray[_i4];allMatches[_m]=false}var totalMatches=[];while(cursor<contentLength){cursor=content.indexOf("<",cursor);if(cursor===-1){break}var offset=cursor;var nextOpening=content.indexOf("<",cursor+1);cursor=content.indexOf(">",cursor);if(cursor===-1||nextOpening!==-1&&cursor>nextOpening){throwXmlInvalid(content,offset)}var tagText=content.slice(offset,cursor+1);var _getTag=getTag(tagText),tag=_getTag.tag,position=_getTag.position;var text=allMatches[tag];if(text==null){continue}totalMatches.push({type:"tag",position:position,text:text,offset:offset,value:tagText,tag:tag})}return totalMatches}function getDelimiterErrors(delimiterMatches,fullText,syntaxOptions){var errors=[];var inDelimiter=false;var lastDelimiterMatch={offset:0};var xtag;var delimiterWithErrors=delimiterMatches.reduce(function(delimiterAcc,currDelimiterMatch){var position=currDelimiterMatch.position;var delimiterOffset=currDelimiterMatch.offset;var lastDelimiterOffset=lastDelimiterMatch.offset;var lastDelimiterLength=lastDelimiterMatch.length;xtag=fullText.substr(lastDelimiterOffset,delimiterOffset-lastDelimiterOffset);if(inDelimiter&&position==="start"){if(lastDelimiterOffset+lastDelimiterLength===delimiterOffset){xtag=fullText.substr(lastDelimiterOffset,delimiterOffset-lastDelimiterOffset+lastDelimiterLength+4);if(!syntaxOptions.allowUnclosedTag){errors.push(getDuplicateOpenTagException({xtag:xtag,offset:lastDelimiterOffset}));lastDelimiterMatch=currDelimiterMatch;delimiterAcc.push(_objectSpread(_objectSpread({},currDelimiterMatch),{},{error:true}));return delimiterAcc}}if(!syntaxOptions.allowUnclosedTag){errors.push(getUnclosedTagException({xtag:wordToUtf8(xtag),offset:lastDelimiterOffset}));lastDelimiterMatch=currDelimiterMatch;delimiterAcc.push(_objectSpread(_objectSpread({},currDelimiterMatch),{},{error:true}));return delimiterAcc}delimiterAcc.pop()}if(!inDelimiter&&position==="end"){if(syntaxOptions.allowUnopenedTag){return delimiterAcc}if(lastDelimiterOffset+lastDelimiterLength===delimiterOffset){xtag=fullText.substr(lastDelimiterOffset-4,delimiterOffset-lastDelimiterOffset+lastDelimiterLength+4);errors.push(getDuplicateCloseTagException({xtag:xtag,offset:lastDelimiterOffset}));lastDelimiterMatch=currDelimiterMatch;delimiterAcc.push(_objectSpread(_objectSpread({},currDelimiterMatch),{},{error:true}));return delimiterAcc}errors.push(getUnopenedTagException({xtag:xtag,offset:delimiterOffset}));lastDelimiterMatch=currDelimiterMatch;delimiterAcc.push(_objectSpread(_objectSpread({},currDelimiterMatch),{},{error:true}));return delimiterAcc}inDelimiter=position==="start";lastDelimiterMatch=currDelimiterMatch;delimiterAcc.push(currDelimiterMatch);return delimiterAcc},[]);if(inDelimiter){var lastDelimiterOffset=lastDelimiterMatch.offset;xtag=fullText.substr(lastDelimiterOffset,fullText.length-lastDelimiterOffset);if(!syntaxOptions.allowUnclosedTag){errors.push(getUnclosedTagException({xtag:wordToUtf8(xtag),offset:lastDelimiterOffset}))}else{delimiterWithErrors.pop()}}return{delimiterWithErrors:delimiterWithErrors,errors:errors}}function compareOffsets(startOffset,endOffset){if(startOffset===-1&&endOffset===-1){return DELIMITER_NONE}if(startOffset===endOffset){return DELIMITER_EQUAL}if(startOffset===-1||endOffset===-1){return endOffset<startOffset?DELIMITER_START:DELIMITER_END}return startOffset<endOffset?DELIMITER_START:DELIMITER_END}function splitDelimiters(inside){var newDelimiters=inside.split(" ");if(newDelimiters.length!==2){var err=new XTTemplateError("New Delimiters cannot be parsed");err.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"};throw err}var _newDelimiters=_slicedToArray(newDelimiters,2),start=_newDelimiters[0],end=_newDelimiters[1];if(start.length===0||end.length===0){var _err=new XTTemplateError("New Delimiters cannot be parsed");_err.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"};throw _err}return[start,end]}function getAllDelimiterIndexes(fullText,delimiters,syntaxOptions){var indexes=[];var start=delimiters.start,end=delimiters.end;var offset=-1;var insideTag=false;if(start==null&&end==null){return[]}while(true){var startOffset=fullText.indexOf(start,offset+1);var endOffset=fullText.indexOf(end,offset+1);var position=null;var len=void 0;var compareResult=compareOffsets(startOffset,endOffset);if(compareResult===DELIMITER_EQUAL){compareResult=insideTag?DELIMITER_END:DELIMITER_START}switch(compareResult){case DELIMITER_NONE:return indexes;case DELIMITER_END:insideTag=false;offset=endOffset;position="end";len=end.length;break;case DELIMITER_START:insideTag=true;offset=startOffset;position="start";len=start.length;break}if(syntaxOptions.changeDelimiterPrefix&&compareResult===DELIMITER_START&&fullText[offset+start.length]===syntaxOptions.changeDelimiterPrefix){indexes.push({offset:startOffset,position:"start",length:start.length,changedelimiter:true});var nextEqual=fullText.indexOf(syntaxOptions.changeDelimiterPrefix,offset+start.length+1);var nextEndOffset=fullText.indexOf(end,nextEqual+1);indexes.push({offset:nextEndOffset,position:"end",length:end.length,changedelimiter:true});var _insideTag=fullText.substr(offset+start.length+1,nextEqual-offset-start.length-1);var _splitDelimiters=splitDelimiters(_insideTag);var _splitDelimiters2=_slicedToArray(_splitDelimiters,2);start=_splitDelimiters2[0];end=_splitDelimiters2[1];offset=nextEndOffset;continue}indexes.push({offset:offset,position:position,length:len})}}function parseDelimiters(innerContentParts,delimiters,syntaxOptions){var full=innerContentParts.map(function(p){return p.value}).join("");var delimiterMatches=getAllDelimiterIndexes(full,delimiters,syntaxOptions);var offset=0;var ranges=innerContentParts.map(function(part){offset+=part.value.length;return{offset:offset-part.value.length,lIndex:part.lIndex}});var _getDelimiterErrors=getDelimiterErrors(delimiterMatches,full,syntaxOptions),delimiterWithErrors=_getDelimiterErrors.delimiterWithErrors,errors=_getDelimiterErrors.errors;var cutNext=0;var delimiterIndex=0;var parsed=ranges.map(function(p,i){var offset=p.offset;var range=[offset,offset+innerContentParts[i].value.length];var partContent=innerContentParts[i].value;var delimitersInOffset=[];while(delimiterIndex<delimiterWithErrors.length&&inRange(range,delimiterWithErrors[delimiterIndex])){delimitersInOffset.push(delimiterWithErrors[delimiterIndex]);delimiterIndex++}var parts=[];var cursor=0;if(cutNext>0){cursor=cutNext;cutNext=0}for(var _i6=0;_i6<delimitersInOffset.length;_i6++){var delimiterInOffset=delimitersInOffset[_i6];var _value=partContent.substr(cursor,delimiterInOffset.offset-offset-cursor);if(delimiterInOffset.changedelimiter){if(delimiterInOffset.position==="start"){if(_value.length>0){parts.push({type:"content",value:_value})}}else{cursor=delimiterInOffset.offset-offset+delimiterInOffset.length}continue}if(_value.length>0){parts.push({type:"content",value:_value});cursor+=_value.length}var delimiterPart={type:"delimiter",position:delimiterInOffset.position,offset:cursor+offset};parts.push(delimiterPart);cursor=delimiterInOffset.offset-offset+delimiterInOffset.length}cutNext=cursor-partContent.length;var value=partContent.substr(cursor);if(value.length>0){parts.push({type:"content",value:value})}return parts},this);return{parsed:parsed,errors:errors}}function isInsideContent(part){return part.type==="content"&&part.position==="insidetag"}function getContentParts(xmlparsed){return xmlparsed.filter(isInsideContent)}function decodeContentParts(xmlparsed,fileType){var inTextTag=false;for(var _i8=0;_i8<xmlparsed.length;_i8++){var part=xmlparsed[_i8];inTextTag=updateInTextTag(part,inTextTag);if(part.type==="content"){part.position=inTextTag?"insidetag":"outsidetag"}if(fileType!=="text"&&isInsideContent(part)){part.value=part.value.replace(/>/g,"&gt;")}}}module.exports={parseDelimiters:parseDelimiters,parse:function parse(xmllexed,delimiters,syntax,fileType){decodeContentParts(xmllexed,fileType);var _parseDelimiters=parseDelimiters(getContentParts(xmllexed),delimiters,syntax),delimiterParsed=_parseDelimiters.parsed,errors=_parseDelimiters.errors;var lexed=[];var index=0;var lIndex=0;for(var _i0=0;_i0<xmllexed.length;_i0++){var part=xmllexed[_i0];if(isInsideContent(part)){for(var _i10=0,_delimiterParsed$inde2=delimiterParsed[index];_i10<_delimiterParsed$inde2.length;_i10++){var p=_delimiterParsed$inde2[_i10];if(p.type==="content"){p.position="insidetag"}p.lIndex=lIndex++}pushArray(lexed,delimiterParsed[index]);index++}else{part.lIndex=lIndex++;lexed.push(part)}}return{errors:errors,lexed:lexed}},xmlparse:function xmlparse(content,xmltags){var matches=tagMatcher(content,xmltags.text,xmltags.other);var cursor=0;var parsed=[];for(var _i12=0;_i12<matches.length;_i12++){var match=matches[_i12];if(content.length>cursor&&match.offset-cursor>0){parsed.push({type:"content",value:content.substr(cursor,match.offset-cursor)})}cursor=match.offset+match.value.length;delete match.offset;parsed.push(match)}if(content.length>cursor){parsed.push({type:"content",value:content.substr(cursor)})}return parsed}}},{"./doc-utils.js":5,"./errors.js":7}],16:[function(require,module,exports){"use strict";function getMinFromArrays(arrays,state){var minIndex=-1;for(var i=0,l=arrays.length;i<l;i++){if(state[i]>=arrays[i].length){continue}if(minIndex===-1||arrays[i][state[i]].offset<arrays[minIndex][state[minIndex]].offset){minIndex=i}}return minIndex}module.exports=function(arrays){var totalLength=0;for(var _i2=0,_arrays2=arrays;_i2<_arrays2.length;_i2++){var array=_arrays2[_i2];totalLength+=array.length}arrays=arrays.filter(function(array){return array.length>0});var resultArray=new Array(totalLength);var state=arrays.map(function(){return 0});for(var i=0;i<totalLength;i++){var arrayIndex=getMinFromArrays(arrays,state);resultArray[i]=arrays[arrayIndex][state[arrayIndex]];state[arrayIndex]++}return resultArray}},{}],17:[function(require,module,exports){"use strict";var _require=require("./errors.js"),XTInternalError=_require.XTInternalError;function emptyFun(){}function identity(i){return i}module.exports=function(module){var defaults={set:emptyFun,matchers:function matchers(){return[]},parse:emptyFun,render:emptyFun,getTraits:emptyFun,getFileType:emptyFun,nullGetter:emptyFun,optionsTransformer:identity,postrender:identity,errorsTransformer:identity,getRenderedMap:identity,preparse:identity,postparse:identity,on:emptyFun,resolve:emptyFun,preResolve:emptyFun};if(Object.keys(defaults).every(function(key){return!module[key]})){var err=new XTInternalError("This module cannot be wrapped, because it doesn't define any of the necessary functions");err.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"};throw err}for(var key in defaults){module[key]||(module[key]=defaults[key])}return module}},{"./errors.js":7}],18:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("../doc-utils.js"),pushArray=_require.pushArray;var wrapper=require("../module-wrapper.js");var filetypes=require("../filetypes.js");var _require2=require("../content-types.js"),settingsContentType=_require2.settingsContentType,coreContentType=_require2.coreContentType,appContentType=_require2.appContentType,customContentType=_require2.customContentType,diagramDataContentType=_require2.diagramDataContentType,diagramDrawingContentType=_require2.diagramDrawingContentType;var commonContentTypes=[settingsContentType,coreContentType,appContentType,customContentType,diagramDataContentType,diagramDrawingContentType];var Common=function(){function Common(){_classCallCheck(this,Common);this.name="Common"}return _createClass(Common,[{key:"getFileType",value:function getFileType(_ref){var doc=_ref.doc;var invertedContentTypes=doc.invertedContentTypes;if(!invertedContentTypes){return}for(var _i2=0;_i2<commonContentTypes.length;_i2++){var ct=commonContentTypes[_i2];if(invertedContentTypes[ct]){pushArray(doc.targets,invertedContentTypes[ct])}}var keys=["docx","pptx","xlsx"];var ftCandidate;for(var _i4=0;_i4<keys.length;_i4++){var key=keys[_i4];var contentTypes=filetypes[key];for(var _i6=0;_i6<contentTypes.length;_i6++){var _ct=contentTypes[_i6];if(invertedContentTypes[_ct]){for(var _i8=0,_invertedContentTypes2=invertedContentTypes[_ct];_i8<_invertedContentTypes2.length;_i8++){var target=_invertedContentTypes2[_i8];if(doc.relsTypes[target]&&["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(doc.relsTypes[target])===-1){continue}ftCandidate=key;if(filetypes.main.indexOf(_ct)!==-1||_ct===filetypes.pptx[0]){doc.textTarget||(doc.textTarget=target)}if(ftCandidate==="xlsx"){continue}doc.targets.push(target)}}}if(ftCandidate){return ftCandidate}}return ftCandidate}}])}();module.exports=function(){return wrapper(new Common)}},{"../content-types.js":4,"../doc-utils.js":5,"../filetypes.js":9,"../module-wrapper.js":17}],19:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var traitName="expandPair";var mergeSort=require("../merge-sort.js");var _require=require("../doc-utils.js"),getLeft=_require.getLeft,getRight=_require.getRight,pushArray=_require.pushArray;var wrapper=require("../module-wrapper.js");var _require2=require("../traits.js"),getExpandToDefault=_require2.getExpandToDefault;var _require3=require("../errors.js"),getUnmatchedLoopException=_require3.getUnmatchedLoopException,getClosingTagNotMatchOpeningTag=_require3.getClosingTagNotMatchOpeningTag,getUnbalancedLoopException=_require3.getUnbalancedLoopException;function getOpenCountChange(part){switch(part.location){case"start":return 1;case"end":return-1}}function match(start,end){return start!=null&&end!=null&&(start.part.location==="start"&&end.part.location==="end"&&start.part.value===end.part.value||end.part.value==="")}function transformer(traits){var i=0;var errors=[];while(i<traits.length){var part=traits[i].part;if(part.location==="end"){if(i===0){traits.splice(0,1);errors.push(getUnmatchedLoopException(part));return{traits:traits,errors:errors}}var endIndex=i;var startIndex=i-1;var offseter=1;if(match(traits[startIndex],traits[endIndex])){traits.splice(endIndex,1);traits.splice(startIndex,1);return{errors:errors,traits:traits}}while(offseter<50){var startCandidate=traits[startIndex-offseter];var endCandidate=traits[endIndex+offseter];if(match(startCandidate,traits[endIndex])){traits.splice(endIndex,1);traits.splice(startIndex-offseter,1);return{errors:errors,traits:traits}}if(match(traits[startIndex],endCandidate)){traits.splice(endIndex+offseter,1);traits.splice(startIndex,1);return{errors:errors,traits:traits}}offseter++}errors.push(getClosingTagNotMatchOpeningTag({tags:[traits[startIndex].part,traits[endIndex].part]}));traits.splice(endIndex,1);traits.splice(startIndex,1);return{traits:traits,errors:errors}}i++}for(var _i2=0;_i2<traits.length;_i2++){var _part=traits[_i2].part;errors.push(getUnmatchedLoopException(_part))}return{traits:[],errors:errors}}function getPairs(traits){var levelTraits={};var errors=[];var pairs=[];var transformedTraits=[];pushArray(transformedTraits,traits);while(transformedTraits.length>0){var result=transformer(transformedTraits);pushArray(errors,result.errors);transformedTraits=result.traits}if(errors.length>0){return{pairs:pairs,errors:errors}}var countOpen=0;for(var _i4=0;_i4<traits.length;_i4++){var currentTrait=traits[_i4];var part=currentTrait.part;var change=getOpenCountChange(part);countOpen+=change;if(change===1){levelTraits[countOpen]=currentTrait}else{var startTrait=levelTraits[countOpen+1];if(countOpen===0){pairs.push([startTrait,currentTrait])}}countOpen=countOpen>=0?countOpen:0}return{pairs:pairs,errors:errors}}var ExpandPairTrait=function(){function ExpandPairTrait(){_classCallCheck(this,ExpandPairTrait);this.name="ExpandPairTrait"}return _createClass(ExpandPairTrait,[{key:"optionsTransformer",value:function optionsTransformer(options,docxtemplater){if(docxtemplater.options.paragraphLoop){pushArray(docxtemplater.fileTypeConfig.expandTags,docxtemplater.fileTypeConfig.onParagraphLoop)}this.expandTags=docxtemplater.fileTypeConfig.expandTags;return options}},{key:"postparse",value:function postparse(postparsed,_ref){var _this=this;var getTraits=_ref.getTraits,_postparse=_ref.postparse,fileType=_ref.fileType;var traits=getTraits(traitName,postparsed);traits=traits.map(function(trait){return trait||[]});traits=mergeSort(traits);var _getPairs=getPairs(traits),pairs=_getPairs.pairs,errors=_getPairs.errors;var lastRight=0;var lastPair=null;var expandedPairs=pairs.map(function(pair){var expandTo=pair[0].part.expandTo;if(expandTo==="auto"&&fileType!=="text"){var result=getExpandToDefault(postparsed,pair,_this.expandTags);if(result.error){errors.push(result.error)}expandTo=result.value}if(!expandTo||fileType==="text"){var _left=pair[0].offset;var _right=pair[1].offset;if(_left<lastRight&&!_this.docxtemplater.options.syntax.allowUnbalancedLoops){errors.push(getUnbalancedLoopException(pair,lastPair))}lastPair=pair;lastRight=_right;return[_left,_right]}var left,right;try{left=getLeft(postparsed,expandTo,pair[0].offset)}catch(e){errors.push(e)}try{right=getRight(postparsed,expandTo,pair[1].offset)}catch(e){errors.push(e)}if(left<lastRight&&!_this.docxtemplater.options.syntax.allowUnbalancedLoops){errors.push(getUnbalancedLoopException(pair,lastPair))}lastRight=right;lastPair=pair;return[left,right]});if(errors.length>0){return{postparsed:postparsed,errors:errors}}var currentPairIndex=0;var innerParts;var newParsed=postparsed.reduce(function(newParsed,part,i){var inPair=currentPairIndex<pairs.length&&expandedPairs[currentPairIndex][0]<=i&&i<=expandedPairs[currentPairIndex][1];var pair=pairs[currentPairIndex];var expandedPair=expandedPairs[currentPairIndex];if(!inPair){newParsed.push(part);return newParsed}if(expandedPair[0]===i){innerParts=[]}if(pair[0].offset!==i&&pair[1].offset!==i){innerParts.push(part)}if(expandedPair[1]===i){var basePart=postparsed[pair[0].offset];basePart.subparsed=_postparse(innerParts,{basePart:basePart});basePart.endLindex=pair[1].part.lIndex;delete basePart.location;delete basePart.expandTo;newParsed.push(basePart);currentPairIndex++;var _expandedPair=expandedPairs[currentPairIndex];while(_expandedPair&&_expandedPair[0]<i){currentPairIndex++;_expandedPair=expandedPairs[currentPairIndex]}}return newParsed},[]);return{postparsed:newParsed,errors:errors}}}])}();module.exports=function(){return wrapper(new ExpandPairTrait)}},{"../doc-utils.js":5,"../errors.js":7,"../merge-sort.js":16,"../module-wrapper.js":17,"../traits.js":30}],20:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("../doc-utils.js"),chunkBy=_require.chunkBy,last=_require.last,isParagraphStart=_require.isParagraphStart,isModule=_require.isModule,pushArray=_require.pushArray,isParagraphEnd=_require.isParagraphEnd,isContent=_require.isContent,startsWith=_require.startsWith,isTagEnd=_require.isTagEnd,isTagStart=_require.isTagStart,getSingleAttribute=_require.getSingleAttribute,setSingleAttribute=_require.setSingleAttribute;var filetypes=require("../filetypes.js");var wrapper=require("../module-wrapper.js");var moduleName="loop";function hasContent(parts){return parts.some(function(part){return isContent(part)})}function getFirstMeaningFulPart(parsed){for(var _i2=0;_i2<parsed.length;_i2++){var part=parsed[_i2];if(part.type!=="content"){return part}}return null}function isInsideParagraphLoop(part){var firstMeaningfulPart=getFirstMeaningFulPart(part.subparsed);return firstMeaningfulPart!=null&&firstMeaningfulPart.tag!=="w:t"}function getPageBreakIfApplies(part){return part.hasPageBreak&&isInsideParagraphLoop(part)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function isEnclosedByParagraphs(parsed){return parsed.length&&isParagraphStart(parsed[0])&&isParagraphEnd(last(parsed))}function getOffset(chunk){return hasContent(chunk)?0:chunk.length}function addPageBreakAtEnd(subRendered){var j=subRendered.parts.length-1;if(subRendered.parts[j]==="</w:p>"){subRendered.parts.splice(j,0,'<w:r><w:br w:type="page"/></w:r>')}else{subRendered.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}}function addPageBreakAtBeginning(subRendered){subRendered.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function isContinuous(parts){return parts.some(function(part){return isTagStart("w:type",part)&&part.value.indexOf("continuous")!==-1})}function isNextPage(parts){return parts.some(function(part){return isTagStart("w:type",part)&&part.value.indexOf('w:val="nextPage"')!==-1})}function addSectionBefore(parts,sect){return pushArray(["<w:p><w:pPr>".concat(sect.map(function(_ref){var value=_ref.value;return value}).join(""),"</w:pPr></w:p>")],parts)}function addContinuousType(parts){var stop=false;var inSectPr=false;var result=[];for(var _i4=0;_i4<parts.length;_i4++){var part=parts[_i4];if(stop===false&&startsWith(part,"<w:sectPr")){inSectPr=true}if(inSectPr){if(startsWith(part,"<w:type")){stop=true}if(stop===false&&startsWith(part,"</w:sectPr")){result.push('<w:type w:val="continuous"/>')}}result.push(part)}return result}function dropHeaderFooterRefs(parts){return parts.filter(function(text){return!startsWith(text,"<w:headerReference")&&!startsWith(text,"<w:footerReference")})}function hasPageBreak(chunk){return chunk.some(function(part){return part.tag==="w:br"&&part.value.indexOf('w:type="page"')!==-1})}function hasImage(chunk){return chunk.some(function(_ref2){var tag=_ref2.tag;return tag==="w:drawing"})}function getSectPr(chunks){var collectSectPr=false;var sectPrs=[];for(var _i6=0;_i6<chunks.length;_i6++){var part=chunks[_i6];if(isTagStart("w:sectPr",part)){sectPrs.push([]);collectSectPr=true}if(collectSectPr){sectPrs[sectPrs.length-1].push(part)}if(isTagEnd("w:sectPr",part)){collectSectPr=false}}return sectPrs}function getSectPrHeaderFooterChangeCount(chunks){var collectSectPr=false;var sectPrCount=0;for(var _i8=0;_i8<chunks.length;_i8++){var part=chunks[_i8];if(isTagStart("w:sectPr",part)){collectSectPr=true}if(collectSectPr){if(part.tag==="w:headerReference"||part.tag==="w:footerReference"){sectPrCount++;collectSectPr=false}}if(isTagEnd("w:sectPr",part)){collectSectPr=false}}return sectPrCount}function getLastSectPr(parsed){var sectPr=[];var inSectPr=false;for(var i=parsed.length-1;i>=0;i--){var part=parsed[i];if(isTagEnd("w:sectPr",part)){inSectPr=true}if(isTagStart("w:sectPr",part)){sectPr.unshift(part.value);inSectPr=false}if(inSectPr){sectPr.unshift(part.value)}if(isParagraphStart(part)){if(sectPr.length>0){return sectPr.join("")}break}}return""}var LoopModule=function(){function LoopModule(){_classCallCheck(this,LoopModule);this.name="LoopModule";this.inXfrm=false;this.totalSectPr=0;this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}}return _createClass(LoopModule,[{key:"optionsTransformer",value:function optionsTransformer(opts,docxtemplater){this.docxtemplater=docxtemplater;return opts}},{key:"preparse",value:function preparse(parsed,_ref3){var contentType=_ref3.contentType;if(filetypes.main.indexOf(contentType)!==-1){this.sects=getSectPr(parsed)}}},{key:"matchers",value:function matchers(){var module=moduleName;return[[this.prefix.start,module,{expandTo:"auto",location:"start",inverted:false}],[this.prefix.inverted,module,{expandTo:"auto",location:"start",inverted:true}],[this.prefix.end,module,{location:"end"}],[this.prefix.dash,module,function(_ref4){var _ref5=_slicedToArray(_ref4,3),expandTo=_ref5[1],value=_ref5[2];return{location:"start",inverted:false,expandTo:expandTo,value:value}}]]}},{key:"getTraits",value:function getTraits(traitName,parsed){if(traitName!=="expandPair"){return}var tags=[];for(var offset=0,len=parsed.length;offset<len;offset++){var part=parsed[offset];if(isModule(part,moduleName)&&part.subparsed==null){tags.push({part:part,offset:offset})}}return tags}},{key:"postparse",value:function postparse(parsed,_ref6){var basePart=_ref6.basePart;if(basePart&&this.docxtemplater.fileType==="docx"&&parsed.length>0){basePart.sectPrCount=getSectPrHeaderFooterChangeCount(parsed);this.totalSectPr+=basePart.sectPrCount;var sects=this.sects;sects.some(function(sect,index){if(basePart.lIndex<sect[0].lIndex){if(index+1<sects.length&&isContinuous(sects[index+1])){basePart.addContinuousType=true}return true}if(parsed[0].lIndex<sect[0].lIndex&&sect[0].lIndex<basePart.lIndex){if(isNextPage(sects[index])){basePart.addNextPage={index:index}}return true}});basePart.lastParagrapSectPr=getLastSectPr(parsed)}if(!basePart||basePart.expandTo!=="auto"||basePart.module!==moduleName||!isEnclosedByParagraphs(parsed)){return parsed}basePart.paragraphLoop=true;var level=0;var chunks=chunkBy(parsed,function(p){if(isParagraphStart(p)){level++;if(level===1){return"start"}}if(isParagraphEnd(p)){level--;if(level===0){return"end"}}return null});var firstChunk=chunks[0];var lastChunk=last(chunks);var firstOffset=getOffset(firstChunk);var lastOffset=getOffset(lastChunk);basePart.hasPageBreakBeginning=hasPageBreak(firstChunk);basePart.hasPageBreak=hasPageBreak(lastChunk);if(hasImage(firstChunk)){firstOffset=0}if(hasImage(lastChunk)){lastOffset=0}return parsed.slice(firstOffset,parsed.length-lastOffset)}},{key:"resolve",value:function resolve(part,options){if(!isModule(part,moduleName)){return null}var sm=options.scopeManager;var promisedValue=sm.getValueAsync(part.value,{part:part});var promises=[];function loopOver(scope,i,length){var scopeManager=sm.createSubScopeManager(scope,part.value,i,part,length);promises.push(options.resolve(_objectSpread(_objectSpread({},options),{},{compiled:part.subparsed,tags:{},scopeManager:scopeManager})))}var errorList=[];return promisedValue.then(function(values){values!==null&&values!==void 0?values:values=options.nullGetter(part);return new Promise(function(resolve){if(values instanceof Promise){return values.then(function(values){if(values instanceof Array){Promise.all(values).then(resolve)}else{resolve(values)}})}if(values instanceof Array){Promise.all(values).then(resolve)}else{resolve(values)}}).then(function(values){sm.loopOverValue(values,loopOver,part.inverted);return Promise.all(promises).then(function(r){return r.map(function(_ref7){var resolved=_ref7.resolved,errors=_ref7.errors;pushArray(errorList,errors);return resolved})}).then(function(value){if(errorList.length>0){throw errorList}return value})})})}},{key:"render",value:function render(part,options){if(part.tag==="p:xfrm"){this.inXfrm=part.position==="start"}if(part.tag==="a:ext"&&this.inXfrm){this.lastExt=part;return part}if(!isModule(part,moduleName)){return null}var totalValue=[];var errors=[];var heightOffset=0;var self=this;var firstTag=part.subparsed[0];var tagHeight=0;if((firstTag===null||firstTag===void 0?void 0:firstTag.tag)==="a:tr"){tagHeight=+getSingleAttribute(firstTag.value,"h")}heightOffset-=tagHeight;var a16RowIdOffset=0;var insideParagraphLoop=isInsideParagraphLoop(part);function loopOver(scope,i,length){heightOffset+=tagHeight;var scopeManager=options.scopeManager.createSubScopeManager(scope,part.value,i,part,length);for(var _i0=0,_part$subparsed2=part.subparsed;_i0<_part$subparsed2.length;_i0++){var pp=_part$subparsed2[_i0];if(isTagStart("a16:rowId",pp)){var val=+getSingleAttribute(pp.value,"val")+a16RowIdOffset;a16RowIdOffset=1;pp.value=setSingleAttribute(pp.value,"val",val)}}var subRendered=options.render(_objectSpread(_objectSpread({},options),{},{compiled:part.subparsed,tags:{},scopeManager:scopeManager}));if(part.hasPageBreak&&i===length-1&&insideParagraphLoop){addPageBreakAtEnd(subRendered)}var isNotFirst=scopeManager.scopePathItem.some(function(i){return i!==0});if(isNotFirst){if(part.sectPrCount===1){subRendered.parts=dropHeaderFooterRefs(subRendered.parts)}if(part.addContinuousType){subRendered.parts=addContinuousType(subRendered.parts)}}else if(part.addNextPage){subRendered.parts=addSectionBefore(subRendered.parts,self.sects[part.addNextPage.index])}if(part.addNextPage){addPageBreakAtEnd(subRendered)}if(part.hasPageBreakBeginning&&insideParagraphLoop){addPageBreakAtBeginning(subRendered)}for(var _i10=0,_subRendered$parts2=subRendered.parts;_i10<_subRendered$parts2.length;_i10++){var _val=_subRendered$parts2[_i10];totalValue.push(_val)}pushArray(errors,subRendered.errors)}var value=options.scopeManager.getValue(part.value,{part:part});value!==null&&value!==void 0?value:value=options.nullGetter(part);var result=options.scopeManager.loopOverValue(value,loopOver,part.inverted);if(result===false){if(part.lastParagrapSectPr){if(part.paragraphLoop){return{value:"<w:p><w:pPr>".concat(part.lastParagrapSectPr,"</w:pPr></w:p>")}}return{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(part.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}}return{value:getPageBreakIfApplies(part)||"",errors:errors}}if(heightOffset!==0){var cy=+getSingleAttribute(this.lastExt.value,"cy");this.lastExt.value=setSingleAttribute(this.lastExt.value,"cy",cy+heightOffset)}return{value:options.joinUncorrupt(totalValue,_objectSpread(_objectSpread({},options),{},{basePart:part})),errors:errors}}}])}();module.exports=function(){return wrapper(new LoopModule)}},{"../doc-utils.js":5,"../filetypes.js":9,"../module-wrapper.js":17}],21:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var traits=require("../traits.js");var _require=require("../doc-utils.js"),isContent=_require.isContent;var _require2=require("../errors.js"),throwRawTagShouldBeOnlyTextInParagraph=_require2.throwRawTagShouldBeOnlyTextInParagraph,getInvalidRawXMLValueException=_require2.getInvalidRawXMLValueException;var wrapper=require("../module-wrapper.js");var moduleName="rawxml";function getInner(_ref){var part=_ref.part,left=_ref.left,right=_ref.right,postparsed=_ref.postparsed,index=_ref.index;var paragraphParts=postparsed.slice(left+1,right);for(var i=0,len=paragraphParts.length;i<len;i++){if(i===index-left-1){continue}var p=paragraphParts[i];if(isContent(p)){throwRawTagShouldBeOnlyTextInParagraph({paragraphParts:paragraphParts,part:part})}}return part}var RawXmlModule=function(){function RawXmlModule(){_classCallCheck(this,RawXmlModule);this.name="RawXmlModule";this.prefix="@"}return _createClass(RawXmlModule,[{key:"optionsTransformer",value:function optionsTransformer(options,docxtemplater){this.fileTypeConfig=docxtemplater.fileTypeConfig;return options}},{key:"matchers",value:function matchers(){return[[this.prefix,moduleName]]}},{key:"postparse",value:function postparse(postparsed){return traits.expandToOne(postparsed,{moduleName:moduleName,getInner:getInner,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function explanation(part){return'The tag "'.concat(part.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function render(part,options){if(part.module!==moduleName){return null}var value;var errors=[];try{value=options.scopeManager.getValue(part.value,{part:part});value!==null&&value!==void 0?value:value=options.nullGetter(part)}catch(e){errors.push(e);return{errors:errors}}value=value?value:"";if(typeof value==="string"){return{value:value}}return{errors:[getInvalidRawXMLValueException({tag:part.value,value:value,offset:part.offset})]}}}])}();module.exports=function(){return wrapper(new RawXmlModule)}},{"../doc-utils.js":5,"../errors.js":7,"../module-wrapper.js":17,"../traits.js":30}],22:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var wrapper=require("../module-wrapper.js");var _require=require("../errors.js"),getScopeCompilationError=_require.getScopeCompilationError,getCorruptCharactersException=_require.getCorruptCharactersException;var _require2=require("../doc-utils.js"),utf8ToWord=_require2.utf8ToWord,hasCorruptCharacters=_require2.hasCorruptCharacters,removeCorruptCharacters=_require2.removeCorruptCharacters;var _require3=require("../content-types.js"),settingsContentType=_require3.settingsContentType,coreContentType=_require3.coreContentType,appContentType=_require3.appContentType,customContentType=_require3.customContentType;var NON_LINE_BREAKS_CONTENT_TYPE=[settingsContentType,coreContentType,appContentType,customContentType];var ftprefix={docx:"w",pptx:"a"};var Render=function(){function Render(){_classCallCheck(this,Render);this.name="Render";this.recordRun=false;this.recordedRun=[]}return _createClass(Render,[{key:"optionsTransformer",value:function optionsTransformer(options,docxtemplater){this.docxtemplater=docxtemplater;this.brTag=docxtemplater.fileType==="docx"?"<w:r><w:br/></w:r>":"<a:br/>";this.prefix=ftprefix[docxtemplater.fileType];this.runStartTag="".concat(this.prefix,":r");this.runPropsStartTag="".concat(this.prefix,":rPr");return options}},{key:"set",value:function set(obj){if(obj.compiled){this.compiled=obj.compiled}if(obj.data!=null){this.data=obj.data}}},{key:"getRenderedMap",value:function getRenderedMap(mapper){for(var from in this.compiled){mapper[from]={from:from,data:this.data}}return mapper}},{key:"postparse",value:function postparse(postparsed,options){var errors=[];for(var _i2=0;_i2<postparsed.length;_i2++){var p=postparsed[_i2];if(p.type==="placeholder"){var tag=p.value;try{options.cachedParsers[p.lIndex]=this.docxtemplater.parser(tag,{tag:p})}catch(rootError){errors.push(getScopeCompilationError({tag:tag,rootError:rootError,offset:p.offset}))}}}return{postparsed:postparsed,errors:errors}}},{key:"render",value:function render(part,_ref){var contentType=_ref.contentType,scopeManager=_ref.scopeManager,linebreaks=_ref.linebreaks,nullGetter=_ref.nullGetter,fileType=_ref.fileType,stripInvalidXMLChars=_ref.stripInvalidXMLChars;if(NON_LINE_BREAKS_CONTENT_TYPE.indexOf(contentType)!==-1){linebreaks=false}if(linebreaks){this.recordRuns(part)}if(part.type!=="placeholder"||part.module){return}var value;try{value=scopeManager.getValue(part.value,{part:part})}catch(e){return{errors:[e]}}value!==null&&value!==void 0?value:value=nullGetter(part);if(typeof value==="string"){if(stripInvalidXMLChars){value=removeCorruptCharacters(value)}else if(["docx","pptx","xlsx"].indexOf(fileType)!==-1&&hasCorruptCharacters(value)){return{errors:[getCorruptCharactersException({tag:part.value,value:value,offset:part.offset})]}}}if(fileType==="text"){return{value:value}}return{value:linebreaks&&typeof value==="string"?this.renderLineBreaks(value):utf8ToWord(value)}}},{key:"recordRuns",value:function recordRuns(part){if(part.tag===this.runStartTag){this.recordedRun=""}else if(part.tag===this.runPropsStartTag){if(part.position==="start"){this.recordRun=true;this.recordedRun+=part.value}if(part.position==="end"||part.position==="selfclosing"){this.recordedRun+=part.value;this.recordRun=false}}else if(this.recordRun){this.recordedRun+=part.value}}},{key:"renderLineBreaks",value:function renderLineBreaks(value){var result=[];var lines=value.split("\n");for(var i=0,len=lines.length;i<len;i++){result.push(utf8ToWord(lines[i]));if(i<lines.length-1){result.push("</".concat(this.prefix,":t></").concat(this.prefix,":r>").concat(this.brTag,"<").concat(this.prefix,":r>").concat(this.recordedRun,"<").concat(this.prefix,":t").concat(this.docxtemplater.fileType==="docx"?' xml:space="preserve"':"",">"))}}return result}}])}();module.exports=function(){return wrapper(new Render)}},{"../content-types.js":4,"../doc-utils.js":5,"../errors.js":7,"../module-wrapper.js":17}],23:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var wrapper=require("../module-wrapper.js");var _require=require("../doc-utils.js"),isTextStart=_require.isTextStart,isTextEnd=_require.isTextEnd,endsWith=_require.endsWith,startsWith=_require.startsWith,pushArray=_require.pushArray;var wTpreserve='<w:t xml:space="preserve">';var wTpreservelen=wTpreserve.length;var wtEnd="</w:t>";var wtEndlen=wtEnd.length;function isWtStart(part){return isTextStart(part)&&part.tag==="w:t"}function addXMLPreserve(chunk,index){var tag=chunk[index].value;if(chunk[index+1].value==="</w:t>"){return tag}if(tag.indexOf('xml:space="preserve"')!==-1){return tag}return tag.substr(0,tag.length-1)+' xml:space="preserve">'}function isInsideLoop(meta,chunk){return meta&&meta.basePart&&chunk.length>1}var SpacePreserve=function(){function SpacePreserve(){_classCallCheck(this,SpacePreserve);this.name="SpacePreserveModule"}return _createClass(SpacePreserve,[{key:"postparse",value:function postparse(postparsed,meta){var chunk=[],inTextTag=false,endLindex=0,lastTextTag=0;function isStartingPlaceHolder(part,chunk){return part.type==="placeholder"&&chunk.length>1}var result=postparsed.reduce(function(postparsed,part){if(isWtStart(part)){inTextTag=true;lastTextTag=chunk.length}if(!inTextTag){postparsed.push(part);return postparsed}chunk.push(part);if(isInsideLoop(meta,chunk)){endLindex=meta.basePart.endLindex;chunk[0].value=addXMLPreserve(chunk,0)}if(isStartingPlaceHolder(part,chunk)){chunk[lastTextTag].value=addXMLPreserve(chunk,lastTextTag);endLindex=part.endLindex}if(isTextEnd(part)&&part.lIndex>endLindex){if(endLindex!==0){chunk[lastTextTag].value=addXMLPreserve(chunk,lastTextTag)}pushArray(postparsed,chunk);chunk=[];inTextTag=false;endLindex=0;lastTextTag=0}return postparsed},[]);pushArray(result,chunk);return result}},{key:"postrender",value:function postrender(parts){var lastNonEmpty="";var lastNonEmptyIndex=0;for(var i=0,len=parts.length;i<len;i++){var p=parts[i];if(p===""){continue}if(endsWith(lastNonEmpty,wTpreserve)&&startsWith(p,wtEnd)){parts[lastNonEmptyIndex]=lastNonEmpty.substr(0,lastNonEmpty.length-wTpreservelen)+"<w:t/>";p=p.substr(wtEndlen)}lastNonEmpty=p;lastNonEmptyIndex=i;parts[i]=p}return parts}}])}();module.exports=function(){return wrapper(new SpacePreserve)}},{"../doc-utils.js":5,"../module-wrapper.js":17}],24:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}var _require=require("./doc-utils.js"),wordToUtf8=_require.wordToUtf8,pushArray=_require.pushArray;var _require2=require("./prefix-matcher.js"),match=_require2.match,getValue=_require2.getValue,getValues=_require2.getValues;function getMatchers(modules,options){var allMatchers=[];for(var _i2=0;_i2<modules.length;_i2++){var _module=modules[_i2];if(_module.matchers){var matchers=_module.matchers(options);if(!(matchers instanceof Array)){throw new Error("module matcher returns a non array")}pushArray(allMatchers,matchers)}}return allMatchers}function getMatches(matchers,placeHolderContent,options){var matches=[];for(var _i4=0;_i4<matchers.length;_i4++){var matcher=matchers[_i4];var _matcher=_slicedToArray(matcher,2),prefix=_matcher[0],_module2=_matcher[1];var properties=matcher[2]||{};if(options.match(prefix,placeHolderContent)){var values=options.getValues(prefix,placeHolderContent);if(typeof properties==="function"){properties=properties(values)}if(!properties.value){var _values=_slicedToArray(values,2);properties.value=_values[1]}matches.push(_objectSpread({type:"placeholder",prefix:prefix,module:_module2,onMatch:properties.onMatch,priority:properties.priority},properties))}}return matches}function moduleParse(placeHolderContent,options){var modules=options.modules,startOffset=options.startOffset;var endLindex=options.lIndex;var moduleParsed;options.offset=startOffset;options.match=match;options.getValue=getValue;options.getValues=getValues;var matchers=getMatchers(modules,options);var matches=getMatches(matchers,placeHolderContent,options);if(matches.length>0){var bestMatch=null;for(var _i6=0;_i6<matches.length;_i6++){var _match=matches[_i6];_match.priority||(_match.priority=-_match.value.length);if(!bestMatch||_match.priority>bestMatch.priority){bestMatch=_match}}bestMatch.offset=startOffset;delete bestMatch.priority;bestMatch.endLindex=endLindex;bestMatch.lIndex=endLindex;bestMatch.raw=placeHolderContent;if(bestMatch.onMatch){bestMatch.onMatch(bestMatch)}delete bestMatch.onMatch;delete bestMatch.prefix;return bestMatch}for(var _i8=0;_i8<modules.length;_i8++){var _module3=modules[_i8];moduleParsed=_module3.parse(placeHolderContent,options);if(moduleParsed){moduleParsed.offset=startOffset;moduleParsed.endLindex=endLindex;moduleParsed.lIndex=endLindex;moduleParsed.raw=placeHolderContent;return moduleParsed}}return{type:"placeholder",value:placeHolderContent,offset:startOffset,endLindex:endLindex,lIndex:endLindex}}var parser={preparse:function preparse(parsed,modules,options){function preparse(parsed,options){for(var _i0=0;_i0<modules.length;_i0++){var _module4=modules[_i0];parsed=_module4.preparse(parsed,options)||parsed}return parsed}return preparse(parsed,options)},parse:function parse(lexed,modules,options){var inPlaceHolder=false;var placeHolderContent="";var startOffset;var tailParts=[];var droppedTags=options.fileTypeConfig.droppedTagsInsidePlaceholder||[];return lexed.reduce(function(parsed,token){if(token.type==="delimiter"){inPlaceHolder=token.position==="start";if(token.position==="end"){options.parse=function(placeHolderContent){return moduleParse(placeHolderContent,_objectSpread(_objectSpread(_objectSpread({},options),token),{},{startOffset:startOffset,modules:modules}))};parsed.push(options.parse(wordToUtf8(placeHolderContent)));pushArray(parsed,tailParts);tailParts=[]}if(token.position==="start"){tailParts=[];startOffset=token.offset}placeHolderContent="";return parsed}if(!inPlaceHolder){parsed.push(token);return parsed}if(token.type!=="content"||token.position!=="insidetag"){if(droppedTags.indexOf(token.tag)!==-1){return parsed}tailParts.push(token);return parsed}placeHolderContent+=token.value;return parsed},[])},postparse:function postparse(postparsed,modules,options){function getTraits(traitName,postparsed){return modules.map(function(module){return module.getTraits(traitName,postparsed)})}var errors=[];function _postparse(postparsed,options){var newPostparsed=postparsed;for(var _i10=0;_i10<modules.length;_i10++){var _module5=modules[_i10];var postparseResult=_module5.postparse(newPostparsed,_objectSpread(_objectSpread({},options),{},{postparse:function postparse(parsed,opts){return _postparse(parsed,_objectSpread(_objectSpread({},options),opts))},getTraits:getTraits}));if(postparseResult==null){continue}if(postparseResult.errors){pushArray(errors,postparseResult.errors);newPostparsed=postparseResult.postparsed;continue}newPostparsed=postparseResult}return newPostparsed}return{postparsed:_postparse(postparsed,options),errors:errors}}};module.exports=parser},{"./doc-utils.js":5,"./prefix-matcher.js":26}],25:[function(require,module,exports){"use strict";function string2buf(str){var c,c2,mPos,i,bufLen=0;var strLen=str.length;for(mPos=0;mPos<strLen;mPos++){c=str.charCodeAt(mPos);if((c&64512)===55296&&mPos+1<strLen){c2=str.charCodeAt(mPos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);mPos++}}bufLen+=c<128?1:c<2048?2:c<65536?3:4}var buf=new Uint8Array(bufLen);for(i=0,mPos=0;i<bufLen;mPos++){c=str.charCodeAt(mPos);if((c&64512)===55296&&mPos+1<strLen){c2=str.charCodeAt(mPos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);mPos++}}if(c<128){buf[i++]=c}else if(c<2048){buf[i++]=192|c>>>6;buf[i++]=128|c&63}else if(c<65536){buf[i++]=224|c>>>12;buf[i++]=128|c>>>6&63;buf[i++]=128|c&63}else{buf[i++]=240|c>>>18;buf[i++]=128|c>>>12&63;buf[i++]=128|c>>>6&63;buf[i++]=128|c&63}}return buf}function postrender(parts,options){for(var _i2=0,_options$modules2=options.modules;_i2<_options$modules2.length;_i2++){var _module=_options$modules2[_i2];parts=_module.postrender(parts,options)}var fullLength=0;var newParts=options.joinUncorrupt(parts,options);var longStr="";var lenStr=0;var maxCompact=65536;var uintArrays=[];for(var i=0,len=newParts.length;i<len;i++){var part=newParts[i];if(part.length+lenStr>maxCompact){var _arr=string2buf(longStr);fullLength+=_arr.length;uintArrays.push(_arr);longStr=""}longStr+=part;lenStr+=part.length;delete newParts[i]}var arr=string2buf(longStr);fullLength+=arr.length;uintArrays.push(arr);var array=new Uint8Array(fullLength);var j=0;for(var _i4=0;_i4<uintArrays.length;_i4++){var buf=uintArrays[_i4];for(var _i5=0;_i5<buf.length;++_i5){array[_i5+j]=buf[_i5]}j+=buf.length}return array}module.exports=postrender},{}],26:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var nbspRegex=new RegExp(String.fromCharCode(160),"g");function replaceNbsps(str){return str.replace(nbspRegex," ")}function match(condition,placeHolderContent){var type=_typeof(condition);if(type==="string"){return replaceNbsps(placeHolderContent.substr(0,condition.length))===condition}if(condition instanceof RegExp){return condition.test(replaceNbsps(placeHolderContent))}if(type==="function"){return!!condition(placeHolderContent)}}function getValue(condition,placeHolderContent){var type=_typeof(condition);if(type==="string"){return replaceNbsps(placeHolderContent).substr(condition.length)}if(condition instanceof RegExp){return replaceNbsps(placeHolderContent).match(condition)[1]}if(type==="function"){return condition(placeHolderContent)}}function getValues(condition,placeHolderContent){var type=_typeof(condition);if(type==="string"){return[placeHolderContent,replaceNbsps(placeHolderContent).substr(condition.length)]}if(condition instanceof RegExp){return replaceNbsps(placeHolderContent).match(condition)}if(type==="function"){return[placeHolderContent,condition(placeHolderContent)]}}module.exports={match:match,getValue:getValue,getValues:getValues}},{}],27:[function(require,module,exports){"use strict";var _require=require("./errors.js"),throwUnimplementedTagType=_require.throwUnimplementedTagType,XTScopeParserError=_require.XTScopeParserError;var _require2=require("./doc-utils.js"),pushArray=_require2.pushArray;var getResolvedId=require("./get-resolved-id.js");function moduleRender(part,options){for(var _i2=0,_options$modules2=options.modules;_i2<_options$modules2.length;_i2++){var _module=_options$modules2[_i2];var moduleRendered=_module.render(part,options);if(moduleRendered){return moduleRendered}}return false}function render(options){var baseNullGetter=options.baseNullGetter;var compiled=options.compiled,scopeManager=options.scopeManager;options.nullGetter=function(part,sm){return baseNullGetter(part,sm||scopeManager)};var errors=[];var parts=[];for(var i=0,len=compiled.length;i<len;i++){var part=compiled[i];options.index=i;options.resolvedId=getResolvedId(part,options);var moduleRendered=void 0;try{moduleRendered=moduleRender(part,options)}catch(e){if(e instanceof XTScopeParserError){errors.push(e);parts.push(part);continue}throw e}if(moduleRendered){if(moduleRendered.errors){pushArray(errors,moduleRendered.errors)}parts.push(moduleRendered);continue}if(part.type==="content"||part.type==="tag"){parts.push(part);continue}throwUnimplementedTagType(part,i)}var totalParts=[];for(var _i4=0;_i4<parts.length;_i4++){var value=parts[_i4].value;if(value instanceof Array){pushArray(totalParts,value)}else if(value){totalParts.push(value)}}return{errors:errors,parts:totalParts}}module.exports=render},{"./doc-utils.js":5,"./errors.js":7,"./get-resolved-id.js":12}],28:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("./doc-utils.js"),pushArray=_require.pushArray;var getResolvedId=require("./get-resolved-id.js");function moduleResolve(part,options){for(var _i2=0,_options$modules2=options.modules;_i2<_options$modules2.length;_i2++){var _module=_options$modules2[_i2];var moduleResolved=_module.resolve(part,options);if(moduleResolved){return moduleResolved}}return false}function resolve(options){var resolved=[];var baseNullGetter=options.baseNullGetter;var compiled=options.compiled,scopeManager=options.scopeManager;options.nullGetter=function(part,sm){return baseNullGetter(part,sm||scopeManager)};options.resolved=resolved;var errors=[];return Promise.all(compiled.filter(function(part){return["content","tag"].indexOf(part.type)===-1}).reduce(function(promises,part){var moduleResolved=moduleResolve(part,_objectSpread(_objectSpread({},options),{},{resolvedId:getResolvedId(part,options)}));var result;if(moduleResolved){result=moduleResolved.then(function(value){resolved.push({tag:part.value,lIndex:part.lIndex,value:value})})}else if(part.type==="placeholder"){result=scopeManager.getValueAsync(part.value,{part:part}).then(function(value){return value==null?options.nullGetter(part):value}).then(function(value){resolved.push({tag:part.value,lIndex:part.lIndex,value:value});return value})}else{return}promises.push(result["catch"](function(e){if(e instanceof Array){pushArray(errors,e)}else{errors.push(e)}}));return promises},[])).then(function(){return{errors:errors,resolved:resolved}})}module.exports=resolve},{"./doc-utils.js":5,"./get-resolved-id.js":12}],29:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("./errors.js"),getScopeParserExecutionError=_require.getScopeParserExecutionError;var _require2=require("./utils.js"),last=_require2.last;var _require3=require("./doc-utils.js"),concatArrays=_require3.concatArrays;function find(list,fn){var length=list.length>>>0;var value;for(var i=0;i<length;i++){value=list[i];if(fn.call(this,value,i,list)){return value}}return undefined}function _getValue(tag,meta,num){var _this=this;var scope=this.scopeList[num];if(this.root.finishedResolving){var w=this.resolved;var _loop=function _loop(){var lIndex=_this.scopeLindex[i];w=find(w,function(r){return r.lIndex===lIndex});w=w.value[_this.scopePathItem[i]]};for(var i=this.resolveOffset,len=this.scopePath.length;i<len;i++){_loop()}return find(w,function(r){return meta.part.lIndex===r.lIndex}).value}var result;var parser;if(!this.cachedParsers||!meta.part){parser=this.parser(tag,{tag:meta.part,scopePath:this.scopePath})}else if(this.cachedParsers[meta.part.lIndex]){parser=this.cachedParsers[meta.part.lIndex]}else{parser=this.cachedParsers[meta.part.lIndex]=this.parser(tag,{tag:meta.part,scopePath:this.scopePath})}try{result=parser.get(scope,this.getContext(meta,num))}catch(error){throw getScopeParserExecutionError({tag:tag,scope:scope,error:error,offset:meta.part.offset})}if(result==null&&num>0){return _getValue.call(this,tag,meta,num-1)}return result}function _getValueAsync(tag,meta,num){var _this2=this;var scope=this.scopeList[num];var parser;if(!this.cachedParsers||!meta.part){parser=this.parser(tag,{tag:meta.part,scopePath:this.scopePath})}else if(this.cachedParsers[meta.part.lIndex]){parser=this.cachedParsers[meta.part.lIndex]}else{parser=this.cachedParsers[meta.part.lIndex]=this.parser(tag,{tag:meta.part,scopePath:this.scopePath})}return Promise.resolve().then(function(){return parser.get(scope,_this2.getContext(meta,num))})["catch"](function(error){throw getScopeParserExecutionError({tag:tag,scope:scope,error:error,offset:meta.part.offset})}).then(function(result){if(result==null&&num>0){return _getValueAsync.call(_this2,tag,meta,num-1)}return result})}var ScopeManager=function(){function ScopeManager(options){_classCallCheck(this,ScopeManager);this.root=options.root||this;this.resolveOffset=options.resolveOffset||0;this.scopePath=options.scopePath;this.scopePathItem=options.scopePathItem;this.scopePathLength=options.scopePathLength;this.scopeList=options.scopeList;this.scopeType="";this.scopeTypes=options.scopeTypes;this.scopeLindex=options.scopeLindex;this.parser=options.parser;this.resolved=options.resolved;this.cachedParsers=options.cachedParsers}return _createClass(ScopeManager,[{key:"loopOver",value:function loopOver(tag,functor,inverted,meta){return this.loopOverValue(this.getValue(tag,meta),functor,inverted)}},{key:"functorIfInverted",value:function functorIfInverted(inverted,functor,value,i,length){if(inverted){functor(value,i,length)}return inverted}},{key:"isValueFalsy",value:function isValueFalsy(value,type){return value==null||!value||type==="[object Array]"&&value.length===0}},{key:"loopOverValue",value:function loopOverValue(value,functor,inverted){if(this.root.finishedResolving){inverted=false}var type=Object.prototype.toString.call(value);if(this.isValueFalsy(value,type)){this.scopeType=false;return this.functorIfInverted(inverted,functor,last(this.scopeList),0,1)}if(type==="[object Array]"){this.scopeType="array";for(var i=0;i<value.length;i++){this.functorIfInverted(!inverted,functor,value[i],i,value.length)}return true}if(type==="[object Object]"){this.scopeType="object";return this.functorIfInverted(!inverted,functor,value,0,1)}return this.functorIfInverted(!inverted,functor,last(this.scopeList),0,1)}},{key:"getValue",value:function getValue(tag,meta){var result=_getValue.call(this,tag,meta,this.scopeList.length-1);if(typeof result==="function"){return result(this.scopeList[this.scopeList.length-1],this)}return result}},{key:"getValueAsync",value:function getValueAsync(tag,meta){var _this3=this;return _getValueAsync.call(this,tag,meta,this.scopeList.length-1).then(function(result){if(typeof result==="function"){return result(_this3.scopeList[_this3.scopeList.length-1],_this3)}return result})}},{key:"getContext",value:function getContext(meta,num){return{num:num,meta:meta,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function createSubScopeManager(scope,tag,i,part,length){return new ScopeManager({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:concatArrays([this.scopeTypes,[this.scopeType]]),scopeList:concatArrays([this.scopeList,[scope]]),scopePath:concatArrays([this.scopePath,[tag]]),scopePathItem:concatArrays([this.scopePathItem,[i]]),scopePathLength:concatArrays([this.scopePathLength,[length]]),scopeLindex:concatArrays([this.scopeLindex,[part.lIndex]])})}}])}();module.exports=function(options){options.scopePath=[];options.scopePathItem=[];options.scopePathLength=[];options.scopeTypes=[];options.scopeLindex=[];options.scopeList=[options.tags];return new ScopeManager(options)}},{"./doc-utils.js":5,"./errors.js":7,"./utils.js":31}],30:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("./doc-utils.js"),getRightOrNull=_require.getRightOrNull,getRight=_require.getRight,getLeft=_require.getLeft,getLeftOrNull=_require.getLeftOrNull,chunkBy=_require.chunkBy,isTagStart=_require.isTagStart,isTagEnd=_require.isTagEnd,isContent=_require.isContent,last=_require.last,first=_require.first;var _require2=require("./errors.js"),XTTemplateError=_require2.XTTemplateError,throwExpandNotFound=_require2.throwExpandNotFound,getLoopPositionProducesInvalidXMLError=_require2.getLoopPositionProducesInvalidXMLError;function lastTagIsOpenTag(tags,tag){if(tags.length===0){return false}var innerLastTag=last(tags).substr(1);return innerLastTag.indexOf(tag)===0}function getListXmlElements(parts){var result=[];for(var _i2=0;_i2<parts.length;_i2++){var _parts$_i=parts[_i2],position=_parts$_i.position,value=_parts$_i.value,tag=_parts$_i.tag;if(!tag){continue}if(position==="end"){if(lastTagIsOpenTag(result,tag)){result.pop()}else{result.push(value)}}else if(position==="start"){result.push(value)}}return result}function has(name,xmlElements){for(var _i4=0;_i4<xmlElements.length;_i4++){var xmlElement=xmlElements[_i4];if(xmlElement.indexOf("<".concat(name))===0){return true}}return false}function getExpandToDefault(postparsed,pair,expandTags){var parts=postparsed.slice(pair[0].offset,pair[1].offset);var xmlElements=getListXmlElements(parts);var closingTagCount=xmlElements.filter(function(tag){return tag[1]==="/"}).length;var startingTagCount=xmlElements.filter(function(tag){return tag[1]!=="/"&&tag[tag.length-2]!=="/"}).length;if(closingTagCount!==startingTagCount){return{error:getLoopPositionProducesInvalidXMLError({tag:first(pair).part.value,offset:[first(pair).part.offset,last(pair).part.offset]})}}var _loop=function _loop(){var _expandTags$_i=expandTags[_i6],contains=_expandTags$_i.contains,expand=_expandTags$_i.expand,onlyTextInTag=_expandTags$_i.onlyTextInTag;if(has(contains,xmlElements)){if(onlyTextInTag){var left=getLeftOrNull(postparsed,contains,pair[0].offset);var right=getRightOrNull(postparsed,contains,pair[1].offset);if(left===null||right===null){return 0}var chunks=chunkBy(postparsed.slice(left,right),function(p){return isTagStart(contains,p)?"start":isTagEnd(contains,p)?"end":null});var firstChunk=first(chunks);var lastChunk=last(chunks);var firstContent=firstChunk.filter(isContent);var lastContent=lastChunk.filter(isContent);if(firstContent.length!==1||lastContent.length!==1){return 0}}return{v:{value:expand}}}},_ret;for(var _i6=0;_i6<expandTags.length;_i6++){_ret=_loop();if(_ret===0)continue;if(_ret)return _ret.v}return{}}function getExpandLimit(part,index,postparsed,options){var expandTo=part.expandTo||options.expandTo;if(!expandTo){return}var right,left;try{left=getLeft(postparsed,expandTo,index);right=getRight(postparsed,expandTo,index)}catch(rootError){var errProps=_objectSpread({part:part,rootError:rootError,postparsed:postparsed,expandTo:expandTo,index:index},options.error);if(options.onError){var errorResult=options.onError(errProps);if(errorResult==="ignore"){return}}throwExpandNotFound(errProps)}return[left,right]}function expandOne(_ref,part,postparsed,options){var _ref2=_slicedToArray(_ref,2),left=_ref2[0],right=_ref2[1];var index=postparsed.indexOf(part);var leftParts=postparsed.slice(left,index);var rightParts=postparsed.slice(index+1,right+1);var inner=options.getInner({postparse:options.postparse,index:index,part:part,leftParts:leftParts,rightParts:rightParts,left:left,right:right,postparsed:postparsed});if(!inner.length){inner.expanded=[leftParts,rightParts];inner=[inner]}return{left:left,right:right,inner:inner}}function expandToOne(postparsed,options){var errors=[];if(postparsed.errors){errors=postparsed.errors;postparsed=postparsed.postparsed}var limits=[];for(var i=0,len=postparsed.length;i<len;i++){var part=postparsed[i];if(part.type==="placeholder"&&part.module===options.moduleName&&!part.subparsed&&!part.expanded){try{var limit=getExpandLimit(part,i,postparsed,options);if(!limit){continue}var _limit=_slicedToArray(limit,2),left=_limit[0],right=_limit[1];limits.push({left:left,right:right,part:part,i:i,leftPart:postparsed[left],rightPart:postparsed[right]})}catch(error){errors.push(error)}}}limits.sort(function(l1,l2){if(l1.left===l2.left){return l2.part.lIndex<l1.part.lIndex?1:-1}return l2.left<l1.left?1:-1});var maxRight=-1;var offset=0;for(var _i7=0,_len=limits.length;_i7<_len;_i7++){var _postparsed;var _limit2=limits[_i7];maxRight=Math.max(maxRight,_i7>0?limits[_i7-1].right:0);if(_limit2.left<maxRight){continue}var result=void 0;try{result=expandOne([_limit2.left+offset,_limit2.right+offset],_limit2.part,postparsed,options)}catch(error){if(options.onError){var errorResult=options.onError(_objectSpread({part:_limit2.part,rootError:error,postparsed:postparsed,expandOne:expandOne},options.errors));if(errorResult==="ignore"){continue}}if(error instanceof XTTemplateError){errors.push(error)}else{throw error}}if(!result){continue}offset+=result.inner.length-(result.right+1-result.left);(_postparsed=postparsed).splice.apply(_postparsed,[result.left,result.right+1-result.left].concat(_toConsumableArray(result.inner)))}return{postparsed:postparsed,errors:errors}}module.exports={expandToOne:expandToOne,getExpandToDefault:getExpandToDefault}},{"./doc-utils.js":5,"./errors.js":7}],31:[function(require,module,exports){"use strict";function last(a){return a[a.length-1]}function first(a){return a[0]}module.exports={last:last,first:first}},{}],32:[function(require,module,exports){"use strict";var _require=require("./doc-utils.js"),pregMatchAll=_require.pregMatchAll;module.exports=function xmlMatcher(content,tagsXmlArray){var res={content:content};var taj=tagsXmlArray.join("|");var regexp=new RegExp("(?:(<(?:".concat(taj,")[^>]*>)([^<>]*)</(?:").concat(taj,")>)|(<(?:").concat(taj,")[^>]*/>)"),"g");res.matches=pregMatchAll(regexp,res.content);return res}},{"./doc-utils.js":5}],33:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var _require=require("./doc-utils.js"),pushArray=_require.pushArray,wordToUtf8=_require.wordToUtf8,convertSpaces=_require.convertSpaces;var xmlMatcher=require("./xml-matcher.js");var Lexer=require("./lexer.js");var Parser=require("./parser.js");var _render=require("./render.js");var postrender=require("./postrender.js");var resolve=require("./resolve.js");var joinUncorrupt=require("./join-uncorrupt.js");function _getFullText(content,tagsXmlArray){var matcher=xmlMatcher(content,tagsXmlArray);var result=matcher.matches.map(function(match){return match.array[2]});return wordToUtf8(convertSpaces(result.join("")))}module.exports=function(){function XmlTemplater(content,options){_classCallCheck(this,XmlTemplater);this.cachedParsers={};this.content=content;for(var key in options){this[key]=options[key]}this.setModules({inspect:{filePath:options.filePath}})}return _createClass(XmlTemplater,[{key:"resolveTags",value:function resolveTags(tags){var _this=this;this.tags=tags;var options=this.getOptions();var filePath=this.filePath;options.scopeManager=this.scopeManager;options.resolve=resolve;var errors=[];return Promise.all(this.modules.map(function(module){return Promise.resolve(module.preResolve(options))["catch"](function(e){errors.push(e)})})).then(function(){if(errors.length!==0){throw errors}return resolve(options).then(function(_ref){var resolved=_ref.resolved,errors=_ref.errors;errors=errors.map(function(error){var _error;if(!(error instanceof Error)){error=new Error(error)}(_error=error).properties||(_error.properties={});error.properties.file=filePath;return error});if(errors.length!==0){throw errors}return Promise.all(resolved).then(function(resolved){options.scopeManager.root.finishedResolving=true;options.scopeManager.resolved=resolved;_this.setModules({inspect:{resolved:resolved,filePath:filePath}});return resolved})})["catch"](function(error){_this.errorChecker(error);throw error})})}},{key:"getFullText",value:function getFullText(){return _getFullText(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function setModules(obj){for(var _i2=0,_this$modules2=this.modules;_i2<_this$modules2.length;_i2++){var _module=_this$modules2[_i2];_module.set(obj)}}},{key:"preparse",value:function preparse(){this.allErrors=[];this.xmllexed=Lexer.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray});this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var _Lexer$parse=Lexer.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType),lexed=_Lexer$parse.lexed,lexerErrors=_Lexer$parse.errors;pushArray(this.allErrors,lexerErrors);this.lexed=lexed;this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}});var options=this.getOptions();this.lexed=Parser.preparse(this.lexed,this.modules,options)}},{key:"parse",value:function parse(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},noPostParse=_ref2.noPostParse;this.setModules({inspect:{filePath:this.filePath}});var options=this.getOptions();this.parsed=Parser.parse(this.lexed,this.modules,options);this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}});if(noPostParse){return this}return this.postparse()}},{key:"postparse",value:function postparse(){var options=this.getOptions();var _Parser$postparse=Parser.postparse(this.parsed,this.modules,options),postparsed=_Parser$postparse.postparsed,postparsedErrors=_Parser$postparse.errors;this.postparsed=postparsed;this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}});pushArray(this.allErrors,postparsedErrors);this.errorChecker(this.allErrors);return this}},{key:"errorChecker",value:function errorChecker(errors){for(var _i4=0,_errors2=errors;_i4<_errors2.length;_i4++){var error=_errors2[_i4];error.properties||(error.properties={});error.properties.file=this.filePath}for(var _i6=0,_this$modules4=this.modules;_i6<_this$modules4.length;_i6++){var _module2=_this$modules4[_i6];errors=_module2.errorsTransformer(errors)}}},{key:"baseNullGetter",value:function baseNullGetter(part,sm){var value=null;for(var _i8=0,_this$modules6=this.modules;_i8<_this$modules6.length;_i8++){var _module3=_this$modules6[_i8];if(value!=null){continue}value=_module3.nullGetter(part,sm,this)}if(value!=null){return value}return this.nullGetter(part,sm)}},{key:"getOptions",value:function getOptions(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks,stripInvalidXMLChars:this.stripInvalidXMLChars}}},{key:"render",value:function render(to){this.filePath=to;var options=this.getOptions();options.resolved=this.scopeManager.resolved;options.scopeManager=this.scopeManager;options.render=_render;options.joinUncorrupt=joinUncorrupt;var _render2=_render(options),errors=_render2.errors,parts=_render2.parts;if(errors.length>0){this.allErrors=errors;this.errorChecker(errors);return this}this.content=postrender(parts,options);this.setModules({inspect:{filePath:this.filePath,content:this.content}});return this}}])}()},{"./doc-utils.js":5,"./join-uncorrupt.js":14,"./lexer.js":15,"./parser.js":24,"./postrender.js":25,"./render.js":27,"./resolve.js":28,"./xml-matcher.js":32}],34:[function(require,module,exports){"use strict";function find(list,predicate,ac){if(ac===undefined){ac=Array.prototype}if(list&&typeof ac.find==="function"){return ac.find.call(list,predicate)}for(var i=0;i<list.length;i++){if(hasOwn(list,i)){var item=list[i];if(predicate.call(undefined,item,i,list)){return item}}}}function freeze(object,oc){if(oc===undefined){oc=Object}if(oc&&typeof oc.getOwnPropertyDescriptors==="function"){object=oc.create(null,oc.getOwnPropertyDescriptors(object))}return oc&&typeof oc.freeze==="function"?oc.freeze(object):object}function hasOwn(object,key){return Object.prototype.hasOwnProperty.call(object,key)}function assign(target,source){if(target===null||typeof target!=="object"){throw new TypeError("target is not an object")}for(var key in source){if(hasOwn(source,key)){target[key]=source[key]}}return target}var HTML_BOOLEAN_ATTRIBUTES=freeze({allowfullscreen:true,async:true,autofocus:true,autoplay:true,checked:true,controls:true,default:true,defer:true,disabled:true,formnovalidate:true,hidden:true,ismap:true,itemscope:true,loop:true,multiple:true,muted:true,nomodule:true,novalidate:true,open:true,playsinline:true,readonly:true,required:true,reversed:true,selected:true});function isHTMLBooleanAttribute(name){return hasOwn(HTML_BOOLEAN_ATTRIBUTES,name.toLowerCase())}var HTML_VOID_ELEMENTS=freeze({area:true,base:true,br:true,col:true,embed:true,hr:true,img:true,input:true,link:true,meta:true,param:true,source:true,track:true,wbr:true});function isHTMLVoidElement(tagName){return hasOwn(HTML_VOID_ELEMENTS,tagName.toLowerCase())}var HTML_RAW_TEXT_ELEMENTS=freeze({script:false,style:false,textarea:true,title:true});function isHTMLRawTextElement(tagName){var key=tagName.toLowerCase();return hasOwn(HTML_RAW_TEXT_ELEMENTS,key)&&!HTML_RAW_TEXT_ELEMENTS[key]}function isHTMLEscapableRawTextElement(tagName){var key=tagName.toLowerCase();return hasOwn(HTML_RAW_TEXT_ELEMENTS,key)&&HTML_RAW_TEXT_ELEMENTS[key]}function isHTMLMimeType(mimeType){return mimeType===MIME_TYPE.HTML}function hasDefaultHTMLNamespace(mimeType){return isHTMLMimeType(mimeType)||mimeType===MIME_TYPE.XML_XHTML_APPLICATION}var MIME_TYPE=freeze({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"});var _MIME_TYPES=Object.keys(MIME_TYPE).map(function(key){return MIME_TYPE[key]});function isValidMimeType(mimeType){return _MIME_TYPES.indexOf(mimeType)>-1}var NAMESPACE=freeze({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});exports.assign=assign;exports.find=find;exports.freeze=freeze;exports.HTML_BOOLEAN_ATTRIBUTES=HTML_BOOLEAN_ATTRIBUTES;exports.HTML_RAW_TEXT_ELEMENTS=HTML_RAW_TEXT_ELEMENTS;exports.HTML_VOID_ELEMENTS=HTML_VOID_ELEMENTS;exports.hasDefaultHTMLNamespace=hasDefaultHTMLNamespace;exports.hasOwn=hasOwn;exports.isHTMLBooleanAttribute=isHTMLBooleanAttribute;exports.isHTMLRawTextElement=isHTMLRawTextElement;exports.isHTMLEscapableRawTextElement=isHTMLEscapableRawTextElement;exports.isHTMLMimeType=isHTMLMimeType;exports.isHTMLVoidElement=isHTMLVoidElement;exports.isValidMimeType=isValidMimeType;exports.MIME_TYPE=MIME_TYPE;exports.NAMESPACE=NAMESPACE},{}],35:[function(require,module,exports){"use strict";var conventions=require("./conventions");var dom=require("./dom");var errors=require("./errors");var entities=require("./entities");var sax=require("./sax");var DOMImplementation=dom.DOMImplementation;var hasDefaultHTMLNamespace=conventions.hasDefaultHTMLNamespace;var isHTMLMimeType=conventions.isHTMLMimeType;var isValidMimeType=conventions.isValidMimeType;var MIME_TYPE=conventions.MIME_TYPE;var NAMESPACE=conventions.NAMESPACE;var ParseError=errors.ParseError;var XMLReader=sax.XMLReader;function normalizeLineEndings(input){return input.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028\u2029]/g,"\n")}function DOMParser(options){options=options||{};if(options.locator===undefined){options.locator=true}this.assign=options.assign||conventions.assign;this.domHandler=options.domHandler||DOMHandler;this.onError=options.onError||options.errorHandler;if(options.errorHandler&&typeof options.errorHandler!=="function"){throw new TypeError("errorHandler object is no longer supported, switch to onError!")}else if(options.errorHandler){options.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this)}this.normalizeLineEndings=options.normalizeLineEndings||normalizeLineEndings;this.locator=!!options.locator;this.xmlns=this.assign(Object.create(null),options.xmlns)}DOMParser.prototype.parseFromString=function(source,mimeType){if(!isValidMimeType(mimeType)){throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+mimeType+'" is not valid.')}var defaultNSMap=this.assign(Object.create(null),this.xmlns);var entityMap=entities.XML_ENTITIES;var defaultNamespace=defaultNSMap[""]||null;if(hasDefaultHTMLNamespace(mimeType)){entityMap=entities.HTML_ENTITIES;defaultNamespace=NAMESPACE.HTML}else if(mimeType===MIME_TYPE.XML_SVG_IMAGE){defaultNamespace=NAMESPACE.SVG}defaultNSMap[""]=defaultNamespace;defaultNSMap.xml=defaultNSMap.xml||NAMESPACE.XML;var domBuilder=new this.domHandler({mimeType:mimeType,defaultNamespace:defaultNamespace,onError:this.onError});var locator=this.locator?{}:undefined;if(this.locator){domBuilder.setDocumentLocator(locator)}var sax=new XMLReader;sax.errorHandler=domBuilder;sax.domBuilder=domBuilder;var isXml=!conventions.isHTMLMimeType(mimeType);if(isXml&&typeof source!=="string"){sax.errorHandler.fatalError("source is not a string")}sax.parse(this.normalizeLineEndings(String(source)),defaultNSMap,entityMap);if(!domBuilder.doc.documentElement){sax.errorHandler.fatalError("missing root element")}return domBuilder.doc};function DOMHandler(options){var opt=options||{};this.mimeType=opt.mimeType||MIME_TYPE.XML_APPLICATION;this.defaultNamespace=opt.defaultNamespace||null;this.cdata=false;this.currentElement=undefined;this.doc=undefined;this.locator=undefined;this.onError=opt.onError}function position(locator,node){node.lineNumber=locator.lineNumber;node.columnNumber=locator.columnNumber}DOMHandler.prototype={startDocument:function(){var impl=new DOMImplementation;this.doc=isHTMLMimeType(this.mimeType)?impl.createHTMLDocument(false):impl.createDocument(this.defaultNamespace,"")},startElement:function(namespaceURI,localName,qName,attrs){var doc=this.doc;var el=doc.createElementNS(namespaceURI,qName||localName);var len=attrs.length;appendElement(this,el);this.currentElement=el;this.locator&&position(this.locator,el);for(var i=0;i<len;i++){var namespaceURI=attrs.getURI(i);var value=attrs.getValue(i);var qName=attrs.getQName(i);var attr=doc.createAttributeNS(namespaceURI,qName);this.locator&&position(attrs.getLocator(i),attr);attr.value=attr.nodeValue=value;el.setAttributeNode(attr)}},endElement:function(namespaceURI,localName,qName){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(prefix,uri){},endPrefixMapping:function(prefix){},processingInstruction:function(target,data){var ins=this.doc.createProcessingInstruction(target,data);this.locator&&position(this.locator,ins);appendElement(this,ins)},ignorableWhitespace:function(ch,start,length){},characters:function(chars,start,length){chars=_toString.apply(this,arguments);if(chars){if(this.cdata){var charNode=this.doc.createCDATASection(chars)}else{var charNode=this.doc.createTextNode(chars)}if(this.currentElement){this.currentElement.appendChild(charNode)}else if(/^\s*$/.test(chars)){this.doc.appendChild(charNode)}this.locator&&position(this.locator,charNode)}},skippedEntity:function(name){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(locator){if(locator){locator.lineNumber=0}this.locator=locator},comment:function(chars,start,length){chars=_toString.apply(this,arguments);var comm=this.doc.createComment(chars);this.locator&&position(this.locator,comm);appendElement(this,comm)},startCDATA:function(){this.cdata=true},endCDATA:function(){this.cdata=false},startDTD:function(name,publicId,systemId,internalSubset){var impl=this.doc.implementation;if(impl&&impl.createDocumentType){var dt=impl.createDocumentType(name,publicId,systemId,internalSubset);this.locator&&position(this.locator,dt);appendElement(this,dt);this.doc.doctype=dt}},reportError:function(level,message){if(typeof this.onError==="function"){try{this.onError(level,message,this)}catch(e){throw new ParseError("Reporting "+level+' "'+message+'" caused '+e,this.locator)}}else{console.error("[xmldom "+level+"]\t"+message,_locator(this.locator))}},warning:function(message){this.reportError("warning",message)},error:function(message){this.reportError("error",message)},fatalError:function(message){this.reportError("fatalError",message);throw new ParseError(message,this.locator)}};function _locator(l){if(l){return"\n@#[line:"+l.lineNumber+",col:"+l.columnNumber+"]"}}function _toString(chars,start,length){if(typeof chars=="string"){return chars.substr(start,length)}else{if(chars.length>=start+length||start){return new java.lang.String(chars,start,length)+""}return chars}}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(key){DOMHandler.prototype[key]=function(){return null}});function appendElement(handler,node){if(!handler.currentElement){handler.doc.appendChild(node)}else{handler.currentElement.appendChild(node)}}function onErrorStopParsing(level){if(level==="error")throw"onErrorStopParsing"}function onWarningStopParsing(){throw"onWarningStopParsing"}exports.__DOMHandler=DOMHandler;exports.DOMParser=DOMParser;exports.normalizeLineEndings=normalizeLineEndings;exports.onErrorStopParsing=onErrorStopParsing;exports.onWarningStopParsing=onWarningStopParsing},{"./conventions":34,"./dom":36,"./entities":37,"./errors":38,"./sax":41}],36:[function(require,module,exports){"use strict";var conventions=require("./conventions");var find=conventions.find;var hasDefaultHTMLNamespace=conventions.hasDefaultHTMLNamespace;var hasOwn=conventions.hasOwn;var isHTMLMimeType=conventions.isHTMLMimeType;var isHTMLRawTextElement=conventions.isHTMLRawTextElement;var isHTMLVoidElement=conventions.isHTMLVoidElement;var MIME_TYPE=conventions.MIME_TYPE;var NAMESPACE=conventions.NAMESPACE;var PDC=Symbol();var errors=require("./errors");var DOMException=errors.DOMException;var DOMExceptionName=errors.DOMExceptionName;var g=require("./grammar");function checkSymbol(symbol){if(symbol!==PDC){throw new TypeError("Illegal constructor")}}function notEmptyString(input){return input!==""}function splitOnASCIIWhitespace(input){return input?input.split(/[\t\n\f\r ]+/).filter(notEmptyString):[]}function orderedSetReducer(current,element){if(!hasOwn(current,element)){current[element]=true}return current}function toOrderedSet(input){if(!input)return[];var list=splitOnASCIIWhitespace(input);return Object.keys(list.reduce(orderedSetReducer,{}))}function arrayIncludes(list){return function(element){return list&&list.indexOf(element)!==-1}}function validateQualifiedName(qualifiedName){if(!g.QName_exact.test(qualifiedName)){throw new DOMException(DOMException.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+qualifiedName+'"')}}function validateAndExtract(namespace,qualifiedName){validateQualifiedName(qualifiedName);namespace=namespace||null;var prefix=null;var localName=qualifiedName;if(qualifiedName.indexOf(":")>=0){var splitResult=qualifiedName.split(":");prefix=splitResult[0];localName=splitResult[1]}if(prefix!==null&&namespace===null){throw new DOMException(DOMException.NAMESPACE_ERR,"prefix is non-null and namespace is null")}if(prefix==="xml"&&namespace!==conventions.NAMESPACE.XML){throw new DOMException(DOMException.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace')}if((prefix==="xmlns"||qualifiedName==="xmlns")&&namespace!==conventions.NAMESPACE.XMLNS){throw new DOMException(DOMException.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace')}if(namespace===conventions.NAMESPACE.XMLNS&&prefix!=="xmlns"&&qualifiedName!=="xmlns"){throw new DOMException(DOMException.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"')}return[namespace,prefix,localName]}function copy(src,dest){for(var p in src){if(hasOwn(src,p)){dest[p]=src[p]}}}function _extends(Class,Super){var pt=Class.prototype;if(!(pt instanceof Super)){function t(){}t.prototype=Super.prototype;t=new t;copy(pt,t);Class.prototype=pt=t}if(pt.constructor!=Class){if(typeof Class!="function"){console.error("unknown Class:"+Class)}pt.constructor=Class}}var NodeType={};var ELEMENT_NODE=NodeType.ELEMENT_NODE=1;var ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2;var TEXT_NODE=NodeType.TEXT_NODE=3;var CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4;var ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5;var ENTITY_NODE=NodeType.ENTITY_NODE=6;var PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7;var COMMENT_NODE=NodeType.COMMENT_NODE=8;var DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9;var DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10;var DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11;var NOTATION_NODE=NodeType.NOTATION_NODE=12;var DocumentPosition=conventions.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function commonAncestor(a,b){if(b.length<a.length)return commonAncestor(b,a);var c=null;for(var n in a){if(a[n]!==b[n])return c;c=a[n]}return c}function docGUID(doc){if(!doc.guid)doc.guid=Math.random();return doc.guid}function NodeList(){}NodeList.prototype={length:0,item:function(index){return index>=0&&index<this.length?this[index]:null},toString:function(nodeFilter){for(var buf=[],i=0;i<this.length;i++){serializeToString(this[i],buf,nodeFilter)}return buf.join("")},filter:function(predicate){return Array.prototype.filter.call(this,predicate)},indexOf:function(item){return Array.prototype.indexOf.call(this,item)}};NodeList.prototype[Symbol.iterator]=function(){var me=this;var index=0;return{next:function(){if(index<me.length){return{value:me[index++],done:false}}else{return{done:true}}},return:function(){return{done:true}}}};function LiveNodeList(node,refresh){this._node=node;this._refresh=refresh;_updateLiveList(this)}function _updateLiveList(list){var inc=list._node._inc||list._node.ownerDocument._inc;if(list._inc!==inc){var ls=list._refresh(list._node);__set__(list,"length",ls.length);if(!list.$$length||ls.length<list.$$length){for(var i=ls.length;i in list;i++){if(hasOwn(list,i)){delete list[i]}}}copy(ls,list);list._inc=inc}}LiveNodeList.prototype.item=function(i){_updateLiveList(this);return this[i]||null};_extends(LiveNodeList,NodeList);function NamedNodeMap(){}function _findNodeIndex(list,node){var i=0;while(i<list.length){if(list[i]===node){return i}i++}}function _addNamedNode(el,list,newAttr,oldAttr){if(oldAttr){list[_findNodeIndex(list,oldAttr)]=newAttr}else{list[list.length]=newAttr;list.length++}if(el){newAttr.ownerElement=el;var doc=el.ownerDocument;if(doc){oldAttr&&_onRemoveAttribute(doc,el,oldAttr);_onAddAttribute(doc,el,newAttr)}}}function _removeNamedNode(el,list,attr){var i=_findNodeIndex(list,attr);if(i>=0){var lastIndex=list.length-1;while(i<=lastIndex){list[i]=list[++i]}list.length=lastIndex;if(el){var doc=el.ownerDocument;if(doc){_onRemoveAttribute(doc,el,attr)}attr.ownerElement=null}}}NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(localName){if(this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()){localName=localName.toLowerCase()}var i=0;while(i<this.length){var attr=this[i];if(attr.nodeName===localName){return attr}i++}return null},setNamedItem:function(attr){var el=attr.ownerElement;if(el&&el!==this._ownerElement){throw new DOMException(DOMException.INUSE_ATTRIBUTE_ERR)}var oldAttr=this.getNamedItemNS(attr.namespaceURI,attr.localName);if(oldAttr===attr){return attr}_addNamedNode(this._ownerElement,this,attr,oldAttr);return oldAttr},setNamedItemNS:function(attr){return this.setNamedItem(attr)},removeNamedItem:function(localName){var attr=this.getNamedItem(localName);if(!attr){throw new DOMException(DOMException.NOT_FOUND_ERR,localName)}_removeNamedNode(this._ownerElement,this,attr);return attr},removeNamedItemNS:function(namespaceURI,localName){var attr=this.getNamedItemNS(namespaceURI,localName);if(!attr){throw new DOMException(DOMException.NOT_FOUND_ERR,namespaceURI?namespaceURI+" : "+localName:localName)}_removeNamedNode(this._ownerElement,this,attr);return attr},getNamedItemNS:function(namespaceURI,localName){if(!namespaceURI){namespaceURI=null}var i=0;while(i<this.length){var node=this[i];if(node.localName===localName&&node.namespaceURI===namespaceURI){return node}i++}return null}};NamedNodeMap.prototype[Symbol.iterator]=function(){var me=this;var index=0;return{next:function(){if(index<me.length){return{value:me[index++],done:false}}else{return{done:true}}},return:function(){return{done:true}}}};function DOMImplementation(){}DOMImplementation.prototype={hasFeature:function(feature,version){return true},createDocument:function(namespaceURI,qualifiedName,doctype){var contentType=MIME_TYPE.XML_APPLICATION;if(namespaceURI===NAMESPACE.HTML){contentType=MIME_TYPE.XML_XHTML_APPLICATION}else if(namespaceURI===NAMESPACE.SVG){contentType=MIME_TYPE.XML_SVG_IMAGE}var doc=new Document(PDC,{contentType:contentType});doc.implementation=this;doc.childNodes=new NodeList;doc.doctype=doctype||null;if(doctype){doc.appendChild(doctype)}if(qualifiedName){var root=doc.createElementNS(namespaceURI,qualifiedName);doc.appendChild(root)}return doc},createDocumentType:function(qualifiedName,publicId,systemId,internalSubset){validateQualifiedName(qualifiedName);var node=new DocumentType(PDC);node.name=qualifiedName;node.nodeName=qualifiedName;node.publicId=publicId||"";node.systemId=systemId||"";node.internalSubset=internalSubset||"";node.childNodes=new NodeList;return node},createHTMLDocument:function(title){var doc=new Document(PDC,{contentType:MIME_TYPE.HTML});doc.implementation=this;doc.childNodes=new NodeList;if(title!==false){doc.doctype=this.createDocumentType("html");doc.doctype.ownerDocument=doc;doc.appendChild(doc.doctype);var htmlNode=doc.createElement("html");doc.appendChild(htmlNode);var headNode=doc.createElement("head");htmlNode.appendChild(headNode);if(typeof title==="string"){var titleNode=doc.createElement("title");titleNode.appendChild(doc.createTextNode(title));headNode.appendChild(titleNode)}htmlNode.appendChild(doc.createElement("body"))}return doc}};function Node(symbol){checkSymbol(symbol)}Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var rootNode=this.getRootNode();return rootNode&&rootNode.nodeType===rootNode.DOCUMENT_NODE},contains:function(other){if(!other)return false;var parent=other;do{if(this===parent)return true;parent=other.parentNode}while(parent);return false},getRootNode:function(options){var parent=this;do{if(!parent.parentNode){return parent}parent=parent.parentNode}while(parent)},isEqualNode:function(otherNode){if(!otherNode)return false;if(this.nodeType!==otherNode.nodeType)return false;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==otherNode.name)return false;if(this.publicId!==otherNode.publicId)return false;if(this.systemId!==otherNode.systemId)return false;break;case this.ELEMENT_NODE:if(this.namespaceURI!==otherNode.namespaceURI)return false;if(this.prefix!==otherNode.prefix)return false;if(this.localName!==otherNode.localName)return false;if(this.attributes.length!==otherNode.attributes.length)return false;for(var i=0;i<this.attributes.length;i++){var attr=this.attributes.item(i);if(!attr.isEqualNode(otherNode.getAttributeNodeNS(attr.namespaceURI,attr.localName))){return false}}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==otherNode.namespaceURI)return false;if(this.localName!==otherNode.localName)return false;if(this.value!==otherNode.value)return false;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==otherNode.target||this.data!==otherNode.data){return false}break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==otherNode.data)return false;break}if(this.childNodes.length!==otherNode.childNodes.length){return false}for(var i=0;i<this.childNodes.length;i++){if(!this.childNodes[i].isEqualNode(otherNode.childNodes[i])){return false}}return true},isSameNode:function(otherNode){return this===otherNode},insertBefore:function(newChild,refChild){return _insertBefore(this,newChild,refChild)},replaceChild:function(newChild,oldChild){_insertBefore(this,newChild,oldChild,assertPreReplacementValidityInDocument);if(oldChild){this.removeChild(oldChild)}},removeChild:function(oldChild){return _removeChild(this,oldChild)},appendChild:function(newChild){return this.insertBefore(newChild,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(deep){return cloneNode(this.ownerDocument||this,this,deep)},normalize:function(){var child=this.firstChild;while(child){var next=child.nextSibling;if(next&&next.nodeType==TEXT_NODE&&child.nodeType==TEXT_NODE){this.removeChild(next);child.appendData(next.data)}else{child.normalize();child=next}}},isSupported:function(feature,version){return this.ownerDocument.implementation.hasFeature(feature,version)},lookupPrefix:function(namespaceURI){var el=this;while(el){var map=el._nsMap;if(map){for(var n in map){if(hasOwn(map,n)&&map[n]===namespaceURI){return n}}}el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},lookupNamespaceURI:function(prefix){var el=this;while(el){var map=el._nsMap;if(map){if(hasOwn(map,prefix)){return map[prefix]}}el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},isDefaultNamespace:function(namespaceURI){var prefix=this.lookupPrefix(namespaceURI);return prefix==null},compareDocumentPosition:function(other){if(this===other)return 0;var node1=other;var node2=this;var attr1=null;var attr2=null;if(node1 instanceof Attr){attr1=node1;node1=attr1.ownerElement}if(node2 instanceof Attr){attr2=node2;node2=attr2.ownerElement;if(attr1&&node1&&node2===node1){for(var i=0,attr;attr=node2.attributes[i];i++){if(attr===attr1)return DocumentPosition.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+DocumentPosition.DOCUMENT_POSITION_PRECEDING;if(attr===attr2)return DocumentPosition.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+DocumentPosition.DOCUMENT_POSITION_FOLLOWING}}}if(!node1||!node2||node2.ownerDocument!==node1.ownerDocument){return DocumentPosition.DOCUMENT_POSITION_DISCONNECTED+DocumentPosition.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(docGUID(node2.ownerDocument)>docGUID(node1.ownerDocument)?DocumentPosition.DOCUMENT_POSITION_FOLLOWING:DocumentPosition.DOCUMENT_POSITION_PRECEDING)}if(attr2&&node1===node2){return DocumentPosition.DOCUMENT_POSITION_CONTAINS+DocumentPosition.DOCUMENT_POSITION_PRECEDING}if(attr1&&node1===node2){return DocumentPosition.DOCUMENT_POSITION_CONTAINED_BY+DocumentPosition.DOCUMENT_POSITION_FOLLOWING}var chain1=[];var ancestor1=node1.parentNode;while(ancestor1){if(!attr2&&ancestor1===node2){return DocumentPosition.DOCUMENT_POSITION_CONTAINED_BY+DocumentPosition.DOCUMENT_POSITION_FOLLOWING}chain1.push(ancestor1);ancestor1=ancestor1.parentNode}chain1.reverse();var chain2=[];var ancestor2=node2.parentNode;while(ancestor2){if(!attr1&&ancestor2===node1){return DocumentPosition.DOCUMENT_POSITION_CONTAINS+DocumentPosition.DOCUMENT_POSITION_PRECEDING}chain2.push(ancestor2);ancestor2=ancestor2.parentNode}chain2.reverse();var ca=commonAncestor(chain1,chain2);for(var n in ca.childNodes){var child=ca.childNodes[n];if(child===node2)return DocumentPosition.DOCUMENT_POSITION_FOLLOWING;if(child===node1)return DocumentPosition.DOCUMENT_POSITION_PRECEDING;if(chain2.indexOf(child)>=0)return DocumentPosition.DOCUMENT_POSITION_FOLLOWING;if(chain1.indexOf(child)>=0)return DocumentPosition.DOCUMENT_POSITION_PRECEDING}return 0}};function _xmlEncoder(c){return c=="<"&&"&lt;"||c==">"&&"&gt;"||c=="&"&&"&amp;"||c=='"'&&"&quot;"||"&#"+c.charCodeAt()+";"}copy(NodeType,Node);copy(NodeType,Node.prototype);copy(DocumentPosition,Node);copy(DocumentPosition,Node.prototype);function _visitNode(node,callback){if(callback(node)){return true}if(node=node.firstChild){do{if(_visitNode(node,callback)){return true}}while(node=node.nextSibling)}}function Document(symbol,options){checkSymbol(symbol);var opt=options||{};this.ownerDocument=this;this.contentType=opt.contentType||MIME_TYPE.XML_APPLICATION;this.type=isHTMLMimeType(this.contentType)?"html":"xml"}function _onAddAttribute(doc,el,newAttr){doc&&doc._inc++;var ns=newAttr.namespaceURI;if(ns===NAMESPACE.XMLNS){el._nsMap[newAttr.prefix?newAttr.localName:""]=newAttr.value}}function _onRemoveAttribute(doc,el,newAttr,remove){doc&&doc._inc++;var ns=newAttr.namespaceURI;if(ns===NAMESPACE.XMLNS){delete el._nsMap[newAttr.prefix?newAttr.localName:""]}}function _onUpdateChild(doc,parent,newChild){if(doc&&doc._inc){doc._inc++;var childNodes=parent.childNodes;if(newChild&&!newChild.nextSibling){childNodes[childNodes.length++]=newChild}else{var child=parent.firstChild;var i=0;while(child){childNodes[i++]=child;child=child.nextSibling}childNodes.length=i;delete childNodes[childNodes.length]}}}function _removeChild(parentNode,child){if(parentNode!==child.parentNode){throw new DOMException(DOMException.NOT_FOUND_ERR,"child's parent is not parent")}var oldPreviousSibling=child.previousSibling;var oldNextSibling=child.nextSibling;if(oldPreviousSibling){oldPreviousSibling.nextSibling=oldNextSibling}else{parentNode.firstChild=oldNextSibling}if(oldNextSibling){oldNextSibling.previousSibling=oldPreviousSibling}else{parentNode.lastChild=oldPreviousSibling}_onUpdateChild(parentNode.ownerDocument,parentNode);child.parentNode=null;child.previousSibling=null;child.nextSibling=null;return child}function hasValidParentNodeType(node){return node&&(node.nodeType===Node.DOCUMENT_NODE||node.nodeType===Node.DOCUMENT_FRAGMENT_NODE||node.nodeType===Node.ELEMENT_NODE)}function hasInsertableNodeType(node){return node&&(node.nodeType===Node.CDATA_SECTION_NODE||node.nodeType===Node.COMMENT_NODE||node.nodeType===Node.DOCUMENT_FRAGMENT_NODE||node.nodeType===Node.DOCUMENT_TYPE_NODE||node.nodeType===Node.ELEMENT_NODE||node.nodeType===Node.PROCESSING_INSTRUCTION_NODE||node.nodeType===Node.TEXT_NODE)}function isDocTypeNode(node){return node&&node.nodeType===Node.DOCUMENT_TYPE_NODE}function isElementNode(node){return node&&node.nodeType===Node.ELEMENT_NODE}function isTextNode(node){return node&&node.nodeType===Node.TEXT_NODE}function isElementInsertionPossible(doc,child){var parentChildNodes=doc.childNodes||[];if(find(parentChildNodes,isElementNode)||isDocTypeNode(child)){return false}var docTypeNode=find(parentChildNodes,isDocTypeNode);return!(child&&docTypeNode&&parentChildNodes.indexOf(docTypeNode)>parentChildNodes.indexOf(child))}function isElementReplacementPossible(doc,child){var parentChildNodes=doc.childNodes||[];function hasElementChildThatIsNotChild(node){return isElementNode(node)&&node!==child}if(find(parentChildNodes,hasElementChildThatIsNotChild)){return false}var docTypeNode=find(parentChildNodes,isDocTypeNode);return!(child&&docTypeNode&&parentChildNodes.indexOf(docTypeNode)>parentChildNodes.indexOf(child))}function assertPreInsertionValidity1to5(parent,node,child){if(!hasValidParentNodeType(parent)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+parent.nodeType)}if(child&&child.parentNode!==parent){throw new DOMException(DOMException.NOT_FOUND_ERR,"child not in parent")}if(!hasInsertableNodeType(node)||isDocTypeNode(node)&&parent.nodeType!==Node.DOCUMENT_NODE){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Unexpected node type "+node.nodeType+" for parent node type "+parent.nodeType)}}function assertPreInsertionValidityInDocument(parent,node,child){var parentChildNodes=parent.childNodes||[];var nodeChildNodes=node.childNodes||[];if(node.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var nodeChildElements=nodeChildNodes.filter(isElementNode);if(nodeChildElements.length>1||find(nodeChildNodes,isTextNode)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment")}if(nodeChildElements.length===1&&!isElementInsertionPossible(parent,child)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}}if(isElementNode(node)){if(!isElementInsertionPossible(parent,child)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype")}}if(isDocTypeNode(node)){if(find(parentChildNodes,isDocTypeNode)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed")}var parentElementChild=find(parentChildNodes,isElementNode);if(child&&parentChildNodes.indexOf(parentElementChild)<parentChildNodes.indexOf(child)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}if(!child&&parentElementChild){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}}function assertPreReplacementValidityInDocument(parent,node,child){var parentChildNodes=parent.childNodes||[];var nodeChildNodes=node.childNodes||[];if(node.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var nodeChildElements=nodeChildNodes.filter(isElementNode);if(nodeChildElements.length>1||find(nodeChildNodes,isTextNode)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment")}if(nodeChildElements.length===1&&!isElementReplacementPossible(parent,child)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}}if(isElementNode(node)){if(!isElementReplacementPossible(parent,child)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype")}}if(isDocTypeNode(node)){function hasDoctypeChildThatIsNotChild(node){return isDocTypeNode(node)&&node!==child}if(find(parentChildNodes,hasDoctypeChildThatIsNotChild)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed")}var parentElementChild=find(parentChildNodes,isElementNode);if(child&&parentChildNodes.indexOf(parentElementChild)<parentChildNodes.indexOf(child)){throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}}function _insertBefore(parent,node,child,_inDocumentAssertion){assertPreInsertionValidity1to5(parent,node,child);if(parent.nodeType===Node.DOCUMENT_NODE){(_inDocumentAssertion||assertPreInsertionValidityInDocument)(parent,node,child)}var cp=node.parentNode;if(cp){cp.removeChild(node)}if(node.nodeType===DOCUMENT_FRAGMENT_NODE){var newFirst=node.firstChild;if(newFirst==null){return node}var newLast=node.lastChild}else{newFirst=newLast=node}var pre=child?child.previousSibling:parent.lastChild;newFirst.previousSibling=pre;newLast.nextSibling=child;if(pre){pre.nextSibling=newFirst}else{parent.firstChild=newFirst}if(child==null){parent.lastChild=newLast}else{child.previousSibling=newLast}do{newFirst.parentNode=parent}while(newFirst!==newLast&&(newFirst=newFirst.nextSibling));_onUpdateChild(parent.ownerDocument||parent,parent,node);if(node.nodeType==DOCUMENT_FRAGMENT_NODE){node.firstChild=node.lastChild=null}return node}Document.prototype={implementation:null,nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(newChild,refChild){if(newChild.nodeType===DOCUMENT_FRAGMENT_NODE){var child=newChild.firstChild;while(child){var next=child.nextSibling;this.insertBefore(child,refChild);child=next}return newChild}_insertBefore(this,newChild,refChild);newChild.ownerDocument=this;if(this.documentElement===null&&newChild.nodeType===ELEMENT_NODE){this.documentElement=newChild}return newChild},removeChild:function(oldChild){var removed=_removeChild(this,oldChild);if(removed===this.documentElement){this.documentElement=null}return removed},replaceChild:function(newChild,oldChild){_insertBefore(this,newChild,oldChild,assertPreReplacementValidityInDocument);newChild.ownerDocument=this;if(oldChild){this.removeChild(oldChild)}if(isElementNode(newChild)){this.documentElement=newChild}},importNode:function(importedNode,deep){return importNode(this,importedNode,deep)},getElementById:function(id){var rtv=null;_visitNode(this.documentElement,function(node){if(node.nodeType==ELEMENT_NODE){if(node.getAttribute("id")==id){rtv=node;return true}}});return rtv},createElement:function(tagName){var node=new Element(PDC);node.ownerDocument=this;if(this.type==="html"){tagName=tagName.toLowerCase()}if(hasDefaultHTMLNamespace(this.contentType)){node.namespaceURI=NAMESPACE.HTML}node.nodeName=tagName;node.tagName=tagName;node.localName=tagName;node.childNodes=new NodeList;var attrs=node.attributes=new NamedNodeMap;attrs._ownerElement=node;return node},createDocumentFragment:function(){var node=new DocumentFragment(PDC);node.ownerDocument=this;node.childNodes=new NodeList;return node},createTextNode:function(data){var node=new Text(PDC);node.ownerDocument=this;node.childNodes=new NodeList;node.appendData(data);return node},createComment:function(data){var node=new Comment(PDC);node.ownerDocument=this;node.childNodes=new NodeList;node.appendData(data);return node},createCDATASection:function(data){var node=new CDATASection(PDC);node.ownerDocument=this;node.childNodes=new NodeList;node.appendData(data);return node},createProcessingInstruction:function(target,data){var node=new ProcessingInstruction(PDC);node.ownerDocument=this;node.childNodes=new NodeList;node.nodeName=node.target=target;node.nodeValue=node.data=data;return node},createAttribute:function(name){if(!g.QName_exact.test(name)){throw new DOMException(DOMException.INVALID_CHARACTER_ERR,'invalid character in name "'+name+'"')}if(this.type==="html"){name=name.toLowerCase()}return this._createAttribute(name)},_createAttribute:function(name){var node=new Attr(PDC);node.ownerDocument=this;node.childNodes=new NodeList;node.name=name;node.nodeName=name;node.localName=name;node.specified=true;return node},createEntityReference:function(name){if(!g.Name.test(name)){throw new DOMException(DOMException.INVALID_CHARACTER_ERR,'not a valid xml name "'+name+'"')}if(this.type==="html"){throw new DOMException("document is an html document",DOMExceptionName.NotSupportedError)}var node=new EntityReference(PDC);node.ownerDocument=this;node.childNodes=new NodeList;node.nodeName=name;return node},createElementNS:function(namespaceURI,qualifiedName){var validated=validateAndExtract(namespaceURI,qualifiedName);var node=new Element(PDC);var attrs=node.attributes=new NamedNodeMap;node.childNodes=new NodeList;node.ownerDocument=this;node.nodeName=qualifiedName;node.tagName=qualifiedName;node.namespaceURI=validated[0];node.prefix=validated[1];node.localName=validated[2];attrs._ownerElement=node;return node},createAttributeNS:function(namespaceURI,qualifiedName){var validated=validateAndExtract(namespaceURI,qualifiedName);var node=new Attr(PDC);node.ownerDocument=this;node.childNodes=new NodeList;node.nodeName=qualifiedName;node.name=qualifiedName;node.specified=true;node.namespaceURI=validated[0];node.prefix=validated[1];node.localName=validated[2];return node}};_extends(Document,Node);function Element(symbol){checkSymbol(symbol);this._nsMap=Object.create(null)}Element.prototype={nodeType:ELEMENT_NODE,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===NAMESPACE.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(name){return!!this.getAttributeNode(name)},getAttribute:function(name){var attr=this.getAttributeNode(name);return attr?attr.value:null},getAttributeNode:function(name){if(this._isInHTMLDocumentAndNamespace()){name=name.toLowerCase()}return this.attributes.getNamedItem(name)},setAttribute:function(name,value){if(this._isInHTMLDocumentAndNamespace()){name=name.toLowerCase()}var attr=this.getAttributeNode(name);if(attr){attr.value=attr.nodeValue=""+value}else{attr=this.ownerDocument._createAttribute(name);attr.value=attr.nodeValue=""+value;this.setAttributeNode(attr)}},removeAttribute:function(name){var attr=this.getAttributeNode(name);attr&&this.removeAttributeNode(attr)},setAttributeNode:function(newAttr){return this.attributes.setNamedItem(newAttr)},setAttributeNodeNS:function(newAttr){return this.attributes.setNamedItemNS(newAttr)},removeAttributeNode:function(oldAttr){return this.attributes.removeNamedItem(oldAttr.nodeName)},removeAttributeNS:function(namespaceURI,localName){var old=this.getAttributeNodeNS(namespaceURI,localName);old&&this.removeAttributeNode(old)},hasAttributeNS:function(namespaceURI,localName){return this.getAttributeNodeNS(namespaceURI,localName)!=null},getAttributeNS:function(namespaceURI,localName){var attr=this.getAttributeNodeNS(namespaceURI,localName);return attr?attr.value:null},setAttributeNS:function(namespaceURI,qualifiedName,value){var validated=validateAndExtract(namespaceURI,qualifiedName);var localName=validated[2];var attr=this.getAttributeNodeNS(namespaceURI,localName);if(attr){attr.value=attr.nodeValue=""+value}else{attr=this.ownerDocument.createAttributeNS(namespaceURI,qualifiedName);attr.value=attr.nodeValue=""+value;this.setAttributeNode(attr)}},getAttributeNodeNS:function(namespaceURI,localName){return this.attributes.getNamedItemNS(namespaceURI,localName)},getElementsByClassName:function(classNames){var classNamesSet=toOrderedSet(classNames);return new LiveNodeList(this,function(base){var ls=[];if(classNamesSet.length>0){_visitNode(base,function(node){if(node!==base&&node.nodeType===ELEMENT_NODE){var nodeClassNames=node.getAttribute("class");if(nodeClassNames){var matches=classNames===nodeClassNames;if(!matches){var nodeClassNamesSet=toOrderedSet(nodeClassNames);matches=classNamesSet.every(arrayIncludes(nodeClassNamesSet))}if(matches){ls.push(node)}}}})}return ls})},getElementsByTagName:function(qualifiedName){var isHTMLDocument=(this.nodeType===DOCUMENT_NODE?this:this.ownerDocument).type==="html";var lowerQualifiedName=qualifiedName.toLowerCase();return new LiveNodeList(this,function(base){var ls=[];_visitNode(base,function(node){if(node===base||node.nodeType!==ELEMENT_NODE){return}if(qualifiedName==="*"){ls.push(node)}else{var nodeQualifiedName=node.getQualifiedName();var matchingQName=isHTMLDocument&&node.namespaceURI===NAMESPACE.HTML?lowerQualifiedName:qualifiedName;if(nodeQualifiedName===matchingQName){ls.push(node)}}});return ls})},getElementsByTagNameNS:function(namespaceURI,localName){return new LiveNodeList(this,function(base){var ls=[];_visitNode(base,function(node){if(node!==base&&node.nodeType===ELEMENT_NODE&&(namespaceURI==="*"||node.namespaceURI===namespaceURI)&&(localName==="*"||node.localName==localName)){ls.push(node)}});return ls})}};Document.prototype.getElementsByClassName=Element.prototype.getElementsByClassName;Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName;Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS;_extends(Element,Node);function Attr(symbol){checkSymbol(symbol);this.namespaceURI=null;this.prefix=null;this.ownerElement=null}Attr.prototype.nodeType=ATTRIBUTE_NODE;_extends(Attr,Node);function CharacterData(symbol){checkSymbol(symbol)}CharacterData.prototype={data:"",substringData:function(offset,count){return this.data.substring(offset,offset+count)},appendData:function(text){text=this.data+text;this.nodeValue=this.data=text;this.length=text.length},insertData:function(offset,text){this.replaceData(offset,0,text)},deleteData:function(offset,count){this.replaceData(offset,count,"")},replaceData:function(offset,count,text){var start=this.data.substring(0,offset);var end=this.data.substring(offset+count);text=start+text+end;this.nodeValue=this.data=text;this.length=text.length}};_extends(CharacterData,Node);function Text(symbol){checkSymbol(symbol)}Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(offset){var text=this.data;var newText=text.substring(offset);text=text.substring(0,offset);this.data=this.nodeValue=text;this.length=text.length;var newNode=this.ownerDocument.createTextNode(newText);if(this.parentNode){this.parentNode.insertBefore(newNode,this.nextSibling)}return newNode}};_extends(Text,CharacterData);function Comment(symbol){checkSymbol(symbol)}Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE};_extends(Comment,CharacterData);function CDATASection(symbol){checkSymbol(symbol)}CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE};_extends(CDATASection,Text);function DocumentType(symbol){checkSymbol(symbol)}DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE;_extends(DocumentType,Node);function Notation(symbol){checkSymbol(symbol)}Notation.prototype.nodeType=NOTATION_NODE;_extends(Notation,Node);function Entity(symbol){checkSymbol(symbol)}Entity.prototype.nodeType=ENTITY_NODE;_extends(Entity,Node);function EntityReference(symbol){checkSymbol(symbol)}EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE;_extends(EntityReference,Node);function DocumentFragment(symbol){checkSymbol(symbol)}DocumentFragment.prototype.nodeName="#document-fragment";DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE;_extends(DocumentFragment,Node);function ProcessingInstruction(symbol){checkSymbol(symbol)}ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE;_extends(ProcessingInstruction,CharacterData);function XMLSerializer(){}XMLSerializer.prototype.serializeToString=function(node,nodeFilter){return nodeSerializeToString.call(node,nodeFilter)};Node.prototype.toString=nodeSerializeToString;function nodeSerializeToString(nodeFilter){var buf=[];var refNode=this.nodeType===DOCUMENT_NODE&&this.documentElement||this;var prefix=refNode.prefix;var uri=refNode.namespaceURI;if(uri&&prefix==null){var prefix=refNode.lookupPrefix(uri);if(prefix==null){var visibleNamespaces=[{namespace:uri,prefix:null}]}}serializeToString(this,buf,nodeFilter,visibleNamespaces);return buf.join("")}function needNamespaceDefine(node,isHTML,visibleNamespaces){var prefix=node.prefix||"";var uri=node.namespaceURI;if(!uri){return false}if(prefix==="xml"&&uri===NAMESPACE.XML||uri===NAMESPACE.XMLNS){return false}var i=visibleNamespaces.length;while(i--){var ns=visibleNamespaces[i];if(ns.prefix===prefix){return ns.namespace!==uri}}return true}function addSerializedAttribute(buf,qualifiedName,value){buf.push(" ",qualifiedName,'="',value.replace(/[<>&"\t\n\r]/g,_xmlEncoder),'"')}function serializeToString(node,buf,nodeFilter,visibleNamespaces){if(!visibleNamespaces){visibleNamespaces=[]}var doc=node.nodeType===DOCUMENT_NODE?node:node.ownerDocument;var isHTML=doc.type==="html";if(nodeFilter){node=nodeFilter(node);if(node){if(typeof node=="string"){buf.push(node);return}}else{return}}switch(node.nodeType){case ELEMENT_NODE:var attrs=node.attributes;var len=attrs.length;var child=node.firstChild;var nodeName=node.tagName;var prefixedNodeName=nodeName;if(!isHTML&&!node.prefix&&node.namespaceURI){var defaultNS;for(var ai=0;ai<attrs.length;ai++){if(attrs.item(ai).name==="xmlns"){defaultNS=attrs.item(ai).value;break}}if(!defaultNS){for(var nsi=visibleNamespaces.length-1;nsi>=0;nsi--){var namespace=visibleNamespaces[nsi];if(namespace.prefix===""&&namespace.namespace===node.namespaceURI){defaultNS=namespace.namespace;break}}}if(defaultNS!==node.namespaceURI){for(var nsi=visibleNamespaces.length-1;nsi>=0;nsi--){var namespace=visibleNamespaces[nsi];if(namespace.namespace===node.namespaceURI){if(namespace.prefix){prefixedNodeName=namespace.prefix+":"+nodeName}break}}}}buf.push("<",prefixedNodeName);for(var i=0;i<len;i++){var attr=attrs.item(i);if(attr.prefix=="xmlns"){visibleNamespaces.push({prefix:attr.localName,namespace:attr.value})}else if(attr.nodeName=="xmlns"){visibleNamespaces.push({prefix:"",namespace:attr.value})}}for(var i=0;i<len;i++){var attr=attrs.item(i);if(needNamespaceDefine(attr,isHTML,visibleNamespaces)){var prefix=attr.prefix||"";var uri=attr.namespaceURI;addSerializedAttribute(buf,prefix?"xmlns:"+prefix:"xmlns",uri);visibleNamespaces.push({prefix:prefix,namespace:uri})}serializeToString(attr,buf,nodeFilter,visibleNamespaces)}if(nodeName===prefixedNodeName&&needNamespaceDefine(node,isHTML,visibleNamespaces)){var prefix=node.prefix||"";var uri=node.namespaceURI;addSerializedAttribute(buf,prefix?"xmlns:"+prefix:"xmlns",uri);visibleNamespaces.push({prefix:prefix,namespace:uri})}var canCloseTag=!child;if(canCloseTag&&(isHTML||node.namespaceURI===NAMESPACE.HTML)){canCloseTag=isHTMLVoidElement(nodeName)}if(canCloseTag){buf.push("/>")}else{buf.push(">");if(isHTML&&isHTMLRawTextElement(nodeName)){while(child){if(child.data){buf.push(child.data)}else{serializeToString(child,buf,nodeFilter,visibleNamespaces.slice())}child=child.nextSibling}}else{while(child){serializeToString(child,buf,nodeFilter,visibleNamespaces.slice());child=child.nextSibling}}buf.push("</",prefixedNodeName,">")}return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var child=node.firstChild;while(child){serializeToString(child,buf,nodeFilter,visibleNamespaces.slice());child=child.nextSibling}return;case ATTRIBUTE_NODE:return addSerializedAttribute(buf,node.name,node.value);case TEXT_NODE:return buf.push(node.data.replace(/[<&>]/g,_xmlEncoder));case CDATA_SECTION_NODE:return buf.push(g.CDATA_START,node.data,g.CDATA_END);case COMMENT_NODE:return buf.push(g.COMMENT_START,node.data,g.COMMENT_END);case DOCUMENT_TYPE_NODE:var pubid=node.publicId;var sysid=node.systemId;buf.push(g.DOCTYPE_DECL_START," ",node.name);if(pubid){buf.push(" ",g.PUBLIC," ",pubid);if(sysid&&sysid!=="."){buf.push(" ",sysid)}}else if(sysid&&sysid!=="."){buf.push(" ",g.SYSTEM," ",sysid)}if(node.internalSubset){buf.push(" [",node.internalSubset,"]")}buf.push(">");return;case PROCESSING_INSTRUCTION_NODE:return buf.push("<?",node.target," ",node.data,"?>");case ENTITY_REFERENCE_NODE:return buf.push("&",node.nodeName,";");default:buf.push("??",node.nodeName)}}function importNode(doc,node,deep){var node2;switch(node.nodeType){case ELEMENT_NODE:node2=node.cloneNode(false);node2.ownerDocument=doc;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:deep=true;break}if(!node2){node2=node.cloneNode(false)}node2.ownerDocument=doc;node2.parentNode=null;if(deep){var child=node.firstChild;while(child){node2.appendChild(importNode(doc,child,deep));child=child.nextSibling}}return node2}function cloneNode(doc,node,deep){var node2=new node.constructor(PDC);for(var n in node){if(hasOwn(node,n)){var v=node[n];if(typeof v!="object"){if(v!=node2[n]){node2[n]=v}}}}if(node.childNodes){node2.childNodes=new NodeList}node2.ownerDocument=doc;switch(node2.nodeType){case ELEMENT_NODE:var attrs=node.attributes;var attrs2=node2.attributes=new NamedNodeMap;var len=attrs.length;attrs2._ownerElement=node2;for(var i=0;i<len;i++){node2.setAttributeNode(cloneNode(doc,attrs.item(i),true))}break;case ATTRIBUTE_NODE:deep=true}if(deep){var child=node.firstChild;while(child){node2.appendChild(cloneNode(doc,child,deep));child=child.nextSibling}}return node2}function __set__(object,key,value){object[key]=value}try{if(Object.defineProperty){Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){_updateLiveList(this);return this.$$length}});Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(data){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:while(this.firstChild){this.removeChild(this.firstChild)}if(data||String(data)){this.appendChild(this.ownerDocument.createTextNode(data))}break;default:this.data=data;this.value=data;this.nodeValue=data}}});function getTextContent(node){switch(node.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var buf=[];node=node.firstChild;while(node){if(node.nodeType!==7&&node.nodeType!==8){buf.push(getTextContent(node))}node=node.nextSibling}return buf.join("");default:return node.nodeValue}}__set__=function(object,key,value){object["$$"+key]=value}}}catch(e){}exports._updateLiveList=_updateLiveList;exports.Attr=Attr;exports.CDATASection=CDATASection;exports.CharacterData=CharacterData;exports.Comment=Comment;exports.Document=Document;exports.DocumentFragment=DocumentFragment;exports.DocumentType=DocumentType;exports.DOMImplementation=DOMImplementation;exports.Element=Element;exports.Entity=Entity;exports.EntityReference=EntityReference;exports.LiveNodeList=LiveNodeList;exports.NamedNodeMap=NamedNodeMap;exports.Node=Node;exports.NodeList=NodeList;exports.Notation=Notation;exports.Text=Text;exports.ProcessingInstruction=ProcessingInstruction;exports.XMLSerializer=XMLSerializer},{"./conventions":34,"./errors":38,"./grammar":39}],37:[function(require,module,exports){"use strict";var freeze=require("./conventions").freeze;exports.XML_ENTITIES=freeze({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'});exports.HTML_ENTITIES=freeze({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"\t",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""});exports.entityMap=exports.HTML_ENTITIES},{"./conventions":34}],38:[function(require,module,exports){"use strict";var conventions=require("./conventions");function extendError(constructor,writableName){constructor.prototype=Object.create(Error.prototype,{constructor:{value:constructor},name:{value:constructor.name,enumerable:true,writable:writableName}})}var DOMExceptionName=conventions.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"});var DOMExceptionNames=Object.keys(DOMExceptionName);function isValidDomExceptionCode(value){return typeof value==="number"&&value>=1&&value<=25}function endsWithError(value){return typeof value==="string"&&value.substring(value.length-DOMExceptionName.Error.length)===DOMExceptionName.Error}function DOMException(messageOrCode,nameOrMessage){if(isValidDomExceptionCode(messageOrCode)){this.name=DOMExceptionNames[messageOrCode];this.message=nameOrMessage||""}else{this.message=messageOrCode;this.name=endsWithError(nameOrMessage)?nameOrMessage:DOMExceptionName.Error}if(Error.captureStackTrace)Error.captureStackTrace(this,DOMException)}extendError(DOMException,true);Object.defineProperties(DOMException.prototype,{code:{enumerable:true,get:function(){var code=DOMExceptionNames.indexOf(this.name);if(isValidDomExceptionCode(code))return code;return 0}}});var ExceptionCode={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};var entries=Object.entries(ExceptionCode);for(var i=0;i<entries.length;i++){var key=entries[i][0];DOMException[key]=entries[i][1]}function ParseError(message,locator){this.message=message;this.locator=locator;if(Error.captureStackTrace)Error.captureStackTrace(this,ParseError)}extendError(ParseError);exports.DOMException=DOMException;exports.DOMExceptionName=DOMExceptionName;exports.ExceptionCode=ExceptionCode;exports.ParseError=ParseError},{"./conventions":34}],39:[function(require,module,exports){"use strict";function detectUnicodeSupport(RegExpImpl){try{if(typeof RegExpImpl!=="function"){RegExpImpl=RegExp}var match=new RegExpImpl("","u").exec("");return!!match&&match[0].length===2}catch(error){}return false}var UNICODE_SUPPORT=detectUnicodeSupport();function chars(regexp){if(regexp.source[0]!=="["){throw new Error(regexp+" can not be used with chars")}return regexp.source.slice(1,regexp.source.lastIndexOf("]"))}function chars_without(regexp,search){if(regexp.source[0]!=="["){throw new Error("/"+regexp.source+"/ can not be used with chars_without")}if(!search||typeof search!=="string"){throw new Error(JSON.stringify(search)+" is not a valid search")}if(regexp.source.indexOf(search)===-1){throw new Error('"'+search+'" is not is /'+regexp.source+"/")}if(search==="-"&&regexp.source.indexOf(search)!==1){throw new Error('"'+search+'" is not at the first postion of /'+regexp.source+"/")}return new RegExp(regexp.source.replace(search,""),UNICODE_SUPPORT?"u":"")}function reg(args){var self=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(part){var isStr=typeof part==="string";if(isStr&&self===undefined&&part==="|"){throw new Error("use regg instead of reg to wrap expressions with `|`!")}return isStr?part:part.source}).join(""),UNICODE_SUPPORT?"mu":"m")}function regg(args){if(arguments.length===0){throw new Error("no parameters provided")}return reg.apply(regg,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var UNICODE_REPLACEMENT_CHARACTER="";var Char=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;if(UNICODE_SUPPORT){Char=reg("[",chars(Char),"\\u{10000}-\\u{10FFFF}","]")}var _SChar=/[\x20\x09\x0D\x0A]/;var SChar_s=chars(_SChar);var S=reg(_SChar,"+");var S_OPT=reg(_SChar,"*");var NameStartChar=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;if(UNICODE_SUPPORT){NameStartChar=reg("[",chars(NameStartChar),"\\u{10000}-\\u{10FFFF}","]")}var NameStartChar_s=chars(NameStartChar);var NameChar=reg("[",NameStartChar_s,chars(/[-.0-9\xB7]/),chars(/[\u0300-\u036F\u203F-\u2040]/),"]");var Name=reg(NameStartChar,NameChar,"*");var Nmtoken=reg(NameChar,"+");var EntityRef=reg("&",Name,";");var CharRef=regg(/&#[0-9]+;|&#x[0-9a-fA-F]+;/);var Reference=regg(EntityRef,"|",CharRef);var PEReference=reg("%",Name,";");var EntityValue=regg(reg('"',regg(/[^%&"]/,"|",PEReference,"|",Reference),"*",'"'),"|",reg("'",regg(/[^%&']/,"|",PEReference,"|",Reference),"*","'"));var AttValue=regg('"',regg(/[^<&"]/,"|",Reference),"*",'"',"|","'",regg(/[^<&']/,"|",Reference),"*","'");var NCNameStartChar=chars_without(NameStartChar,":");var NCNameChar=chars_without(NameChar,":");var NCName=reg(NCNameStartChar,NCNameChar,"*");var QName=reg(NCName,regg(":",NCName),"?");var QName_exact=reg("^",QName,"$");var QName_group=reg("(",QName,")");var SystemLiteral=regg(/"[^"]*"|'[^']*'/);var PI=reg(/^<\?/,"(",Name,")",regg(S,"(",Char,"*?)"),"?",/\?>/);var PubidChar=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/;var PubidLiteral=regg('"',PubidChar,'*"',"|","'",chars_without(PubidChar,"'"),"*'");var COMMENT_START="\x3c!--";var COMMENT_END="--\x3e";var Comment=reg(COMMENT_START,regg(chars_without(Char,"-"),"|",reg("-",chars_without(Char,"-"))),"*",COMMENT_END);var PCDATA="#PCDATA";var Mixed=regg(reg(/\(/,S_OPT,PCDATA,regg(S_OPT,/\|/,S_OPT,QName),"*",S_OPT,/\)\*/),"|",reg(/\(/,S_OPT,PCDATA,S_OPT,/\)/));var _children_quantity=/[?*+]?/;var children=reg(/\([^>]+\)/,_children_quantity);var contentspec=regg("EMPTY","|","ANY","|",Mixed,"|",children);var ELEMENTDECL_START="<!ELEMENT";var elementdecl=reg(ELEMENTDECL_START,S,regg(QName,"|",PEReference),S,regg(contentspec,"|",PEReference),S_OPT,">");var NotationType=reg("NOTATION",S,/\(/,S_OPT,Name,regg(S_OPT,/\|/,S_OPT,Name),"*",S_OPT,/\)/);var Enumeration=reg(/\(/,S_OPT,Nmtoken,regg(S_OPT,/\|/,S_OPT,Nmtoken),"*",S_OPT,/\)/);var EnumeratedType=regg(NotationType,"|",Enumeration);var AttType=regg(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",EnumeratedType);var DefaultDecl=regg(/#REQUIRED|#IMPLIED/,"|",regg(regg("#FIXED",S),"?",AttValue));var AttDef=regg(S,Name,S,AttType,S,DefaultDecl);var ATTLIST_DECL_START="<!ATTLIST";var AttlistDecl=reg(ATTLIST_DECL_START,S,Name,AttDef,"*",S_OPT,">");var ABOUT_LEGACY_COMPAT="about:legacy-compat";var ABOUT_LEGACY_COMPAT_SystemLiteral=regg('"'+ABOUT_LEGACY_COMPAT+'"',"|","'"+ABOUT_LEGACY_COMPAT+"'");var SYSTEM="SYSTEM";var PUBLIC="PUBLIC";var ExternalID=regg(regg(SYSTEM,S,SystemLiteral),"|",regg(PUBLIC,S,PubidLiteral,S,SystemLiteral));var ExternalID_match=reg("^",regg(regg(SYSTEM,S,"(?<SystemLiteralOnly>",SystemLiteral,")"),"|",regg(PUBLIC,S,"(?<PubidLiteral>",PubidLiteral,")",S,"(?<SystemLiteral>",SystemLiteral,")")));var NDataDecl=regg(S,"NDATA",S,Name);var EntityDef=regg(EntityValue,"|",regg(ExternalID,NDataDecl,"?"));var ENTITY_DECL_START="<!ENTITY";var GEDecl=reg(ENTITY_DECL_START,S,Name,S,EntityDef,S_OPT,">");var PEDef=regg(EntityValue,"|",ExternalID);var PEDecl=reg(ENTITY_DECL_START,S,"%",S,Name,S,PEDef,S_OPT,">");var EntityDecl=regg(GEDecl,"|",PEDecl);var PublicID=reg(PUBLIC,S,PubidLiteral);var NotationDecl=reg("<!NOTATION",S,Name,S,regg(ExternalID,"|",PublicID),S_OPT,">");var Eq=reg(S_OPT,"=",S_OPT);var VersionNum=/1[.]\d+/;var VersionInfo=reg(S,"version",Eq,regg("'",VersionNum,"'","|",'"',VersionNum,'"'));var EncName=/[A-Za-z][-A-Za-z0-9._]*/;var EncodingDecl=regg(S,"encoding",Eq,regg('"',EncName,'"',"|","'",EncName,"'"));var SDDecl=regg(S,"standalone",Eq,regg("'",regg("yes","|","no"),"'","|",'"',regg("yes","|","no"),'"'));var XMLDecl=reg(/^<\?xml/,VersionInfo,EncodingDecl,"?",SDDecl,"?",S_OPT,/\?>/);var DOCTYPE_DECL_START="<!DOCTYPE";var CDATA_START="<![CDATA[";var CDATA_END="]]>";var CDStart=/<!\[CDATA\[/;var CDEnd=/\]\]>/;var CData=reg(Char,"*?",CDEnd);var CDSect=reg(CDStart,CData);exports.chars=chars;exports.chars_without=chars_without;exports.detectUnicodeSupport=detectUnicodeSupport;exports.reg=reg;exports.regg=regg;exports.ABOUT_LEGACY_COMPAT=ABOUT_LEGACY_COMPAT;exports.ABOUT_LEGACY_COMPAT_SystemLiteral=ABOUT_LEGACY_COMPAT_SystemLiteral;exports.AttlistDecl=AttlistDecl;exports.CDATA_START=CDATA_START;exports.CDATA_END=CDATA_END;exports.CDSect=CDSect;exports.Char=Char;exports.Comment=Comment;exports.COMMENT_START=COMMENT_START;exports.COMMENT_END=COMMENT_END;exports.DOCTYPE_DECL_START=DOCTYPE_DECL_START;exports.elementdecl=elementdecl;exports.EntityDecl=EntityDecl;exports.EntityValue=EntityValue;exports.ExternalID=ExternalID;exports.ExternalID_match=ExternalID_match;exports.Name=Name;exports.NotationDecl=NotationDecl;exports.Reference=Reference;exports.PEReference=PEReference;exports.PI=PI;exports.PUBLIC=PUBLIC;exports.PubidLiteral=PubidLiteral;exports.QName=QName;exports.QName_exact=QName_exact;exports.QName_group=QName_group;exports.S=S;exports.SChar_s=SChar_s;exports.S_OPT=S_OPT;exports.SYSTEM=SYSTEM;exports.SystemLiteral=SystemLiteral;exports.UNICODE_REPLACEMENT_CHARACTER=UNICODE_REPLACEMENT_CHARACTER;exports.UNICODE_SUPPORT=UNICODE_SUPPORT;exports.XMLDecl=XMLDecl},{}],40:[function(require,module,exports){"use strict";var conventions=require("./conventions");exports.assign=conventions.assign;exports.hasDefaultHTMLNamespace=conventions.hasDefaultHTMLNamespace;exports.isHTMLMimeType=conventions.isHTMLMimeType;exports.isValidMimeType=conventions.isValidMimeType;exports.MIME_TYPE=conventions.MIME_TYPE;exports.NAMESPACE=conventions.NAMESPACE;var errors=require("./errors");exports.DOMException=errors.DOMException;exports.DOMExceptionName=errors.DOMExceptionName;exports.ExceptionCode=errors.ExceptionCode;exports.ParseError=errors.ParseError;var dom=require("./dom");exports.Attr=dom.Attr;exports.CDATASection=dom.CDATASection;exports.CharacterData=dom.CharacterData;exports.Comment=dom.Comment;exports.Document=dom.Document;exports.DocumentFragment=dom.DocumentFragment;exports.DocumentType=dom.DocumentType;exports.DOMImplementation=dom.DOMImplementation;exports.Element=dom.Element;exports.Entity=dom.Entity;exports.EntityReference=dom.EntityReference;exports.LiveNodeList=dom.LiveNodeList;exports.NamedNodeMap=dom.NamedNodeMap;exports.Node=dom.Node;exports.NodeList=dom.NodeList;exports.Notation=dom.Notation;exports.ProcessingInstruction=dom.ProcessingInstruction;exports.Text=dom.Text;exports.XMLSerializer=dom.XMLSerializer;var domParser=require("./dom-parser");exports.DOMParser=domParser.DOMParser;exports.normalizeLineEndings=domParser.normalizeLineEndings;exports.onErrorStopParsing=domParser.onErrorStopParsing;exports.onWarningStopParsing=domParser.onWarningStopParsing},{"./conventions":34,"./dom":36,"./dom-parser":35,"./errors":38}],41:[function(require,module,exports){"use strict";var conventions=require("./conventions");var g=require("./grammar");var errors=require("./errors");var isHTMLEscapableRawTextElement=conventions.isHTMLEscapableRawTextElement;var isHTMLMimeType=conventions.isHTMLMimeType;var isHTMLRawTextElement=conventions.isHTMLRawTextElement;var hasOwn=conventions.hasOwn;var NAMESPACE=conventions.NAMESPACE;var ParseError=errors.ParseError;var DOMException=errors.DOMException;var S_TAG=0;var S_ATTR=1;var S_ATTR_SPACE=2;var S_EQ=3;var S_ATTR_NOQUOT_VALUE=4;var S_ATTR_END=5;var S_TAG_SPACE=6;var S_TAG_CLOSE=7;function XMLReader(){}XMLReader.prototype={parse:function(source,defaultNSMap,entityMap){var domBuilder=this.domBuilder;domBuilder.startDocument();_copy(defaultNSMap,defaultNSMap=Object.create(null));parse(source,defaultNSMap,entityMap,domBuilder,this.errorHandler);domBuilder.endDocument()}};var ENTITY_REG=/&#?\w+;?/g;function parse(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){var isHTML=isHTMLMimeType(domBuilder.mimeType);if(source.indexOf(g.UNICODE_REPLACEMENT_CHARACTER)>=0){errorHandler.warning("Unicode replacement character detected, source encoding issues?")}function fixedFromCharCode(code){if(code>65535){code-=65536;var surrogate1=55296+(code>>10),surrogate2=56320+(code&1023);return String.fromCharCode(surrogate1,surrogate2)}else{return String.fromCharCode(code)}}function entityReplacer(a){var complete=a[a.length-1]===";"?a:a+";";if(!isHTML&&complete!==a){errorHandler.error("EntityRef: expecting ;");return a}var match=g.Reference.exec(complete);if(!match||match[0].length!==complete.length){errorHandler.error("entity not matching Reference production: "+a);return a}var k=complete.slice(1,-1);if(hasOwn(entityMap,k)){return entityMap[k]}else if(k.charAt(0)==="#"){return fixedFromCharCode(parseInt(k.substring(1).replace("x","0x")))}else{errorHandler.error("entity not found:"+a);return a}}function appendText(end){if(end>start){var xt=source.substring(start,end).replace(ENTITY_REG,entityReplacer);locator&&position(start);domBuilder.characters(xt,0,end-start);start=end}}var lineStart=0;var lineEnd=0;var linePattern=/\r\n?|\n|$/g;var locator=domBuilder.locator;function position(p,m){while(p>=lineEnd&&(m=linePattern.exec(source))){lineStart=lineEnd;lineEnd=m.index+m[0].length;locator.lineNumber++}locator.columnNumber=p-lineStart+1}var parseStack=[{currentNSMap:defaultNSMapCopy}];var unclosedTags=[];var start=0;while(true){try{var tagStart=source.indexOf("<",start);if(tagStart<0){if(!isHTML&&unclosedTags.length>0){return errorHandler.fatalError("unclosed xml tag(s): "+unclosedTags.join(", "))}if(!source.substring(start).match(/^\s*$/)){var doc=domBuilder.doc;var text=doc.createTextNode(source.substring(start));if(doc.documentElement){return errorHandler.error("Extra content at the end of the document")}doc.appendChild(text);domBuilder.currentElement=text}return}if(tagStart>start){var fromSource=source.substring(start,tagStart);if(!isHTML&&unclosedTags.length===0){fromSource=fromSource.replace(new RegExp(g.S_OPT.source,"g"),"");fromSource&&errorHandler.error("Unexpected content outside root element: '"+fromSource+"'")}appendText(tagStart)}switch(source.charAt(tagStart+1)){case"/":var end=source.indexOf(">",tagStart+2);var tagNameRaw=source.substring(tagStart+2,end>0?end:undefined);if(!tagNameRaw){return errorHandler.fatalError("end tag name missing")}var tagNameMatch=end>0&&g.reg("^",g.QName_group,g.S_OPT,"$").exec(tagNameRaw);if(!tagNameMatch){return errorHandler.fatalError('end tag name contains invalid characters: "'+tagNameRaw+'"')}if(!domBuilder.currentElement&&!domBuilder.doc.documentElement){return}var currentTagName=unclosedTags[unclosedTags.length-1]||domBuilder.currentElement.tagName||domBuilder.doc.documentElement.tagName||"";if(currentTagName!==tagNameMatch[1]){var tagNameLower=tagNameMatch[1].toLowerCase();if(!isHTML||currentTagName.toLowerCase()!==tagNameLower){return errorHandler.fatalError('Opening and ending tag mismatch: "'+currentTagName+'" != "'+tagNameRaw+'"')}}var config=parseStack.pop();unclosedTags.pop();var localNSMap=config.localNSMap;domBuilder.endElement(config.uri,config.localName,currentTagName);if(localNSMap){for(var prefix in localNSMap){if(hasOwn(localNSMap,prefix)){domBuilder.endPrefixMapping(prefix)}}}end++;break;case"?":locator&&position(tagStart);end=parseProcessingInstruction(source,tagStart,domBuilder,errorHandler);break;case"!":locator&&position(tagStart);end=parseDoctypeCommentOrCData(source,tagStart,domBuilder,errorHandler,isHTML);break;default:locator&&position(tagStart);var el=new ElementAttributes;var currentNSMap=parseStack[parseStack.length-1].currentNSMap;var end=parseElementStartPart(source,tagStart,el,currentNSMap,entityReplacer,errorHandler,isHTML);var len=el.length;if(!el.closed){if(isHTML&&conventions.isHTMLVoidElement(el.tagName)){el.closed=true}else{unclosedTags.push(el.tagName)}}if(locator&&len){var locator2=copyLocator(locator,{});for(var i=0;i<len;i++){var a=el[i];position(a.offset);a.locator=copyLocator(locator,{})}domBuilder.locator=locator2;if(appendElement(el,domBuilder,currentNSMap)){parseStack.push(el)}domBuilder.locator=locator}else{if(appendElement(el,domBuilder,currentNSMap)){parseStack.push(el)}}if(isHTML&&!el.closed){end=parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)}else{end++}}}catch(e){if(e instanceof ParseError){throw e}else if(e instanceof DOMException){throw new ParseError(e.name+": "+e.message,domBuilder.locator,e)}errorHandler.error("element parse error: "+e);end=-1}if(end>start){start=end}else{appendText(Math.max(tagStart,start)+1)}}}function copyLocator(f,t){t.lineNumber=f.lineNumber;t.columnNumber=f.columnNumber;return t}function parseElementStartPart(source,start,el,currentNSMap,entityReplacer,errorHandler,isHTML){function addAttribute(qname,value,startIndex){if(hasOwn(el.attributeNames,qname)){return errorHandler.fatalError("Attribute "+qname+" redefined")}if(!isHTML&&value.indexOf("<")>=0){return errorHandler.fatalError("Unescaped '<' not allowed in attributes values")}el.addValue(qname,value.replace(/[\t\n\r]/g," ").replace(ENTITY_REG,entityReplacer),startIndex)}var attrName;var value;var p=++start;var s=S_TAG;while(true){var c=source.charAt(p);switch(c){case"=":if(s===S_ATTR){attrName=source.slice(start,p);s=S_EQ}else if(s===S_ATTR_SPACE){s=S_EQ}else{throw new Error("attribute equal must after attrName")}break;case"'":case'"':if(s===S_EQ||s===S_ATTR){if(s===S_ATTR){errorHandler.warning('attribute value must after "="');attrName=source.slice(start,p)}start=p+1;p=source.indexOf(c,start);if(p>0){value=source.slice(start,p);addAttribute(attrName,value,start-1);s=S_ATTR_END}else{throw new Error("attribute value no end '"+c+"' match")}}else if(s==S_ATTR_NOQUOT_VALUE){value=source.slice(start,p);addAttribute(attrName,value,start);errorHandler.warning('attribute "'+attrName+'" missed start quot('+c+")!!");start=p+1;s=S_ATTR_END}else{throw new Error('attribute value must after "="')}break;case"/":switch(s){case S_TAG:el.setTagName(source.slice(start,p));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:s=S_TAG_CLOSE;el.closed=true;case S_ATTR_NOQUOT_VALUE:case S_ATTR:break;case S_ATTR_SPACE:el.closed=true;break;default:throw new Error("attribute invalid close char('/')")}break;case"":errorHandler.error("unexpected end of input");if(s==S_TAG){el.setTagName(source.slice(start,p))}return p;case">":switch(s){case S_TAG:el.setTagName(source.slice(start,p));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:break;case S_ATTR_NOQUOT_VALUE:case S_ATTR:value=source.slice(start,p);if(value.slice(-1)==="/"){el.closed=true;value=value.slice(0,-1)}case S_ATTR_SPACE:if(s===S_ATTR_SPACE){value=attrName}if(s==S_ATTR_NOQUOT_VALUE){errorHandler.warning('attribute "'+value+'" missed quot(")!');addAttribute(attrName,value,start)}else{if(!isHTML){errorHandler.warning('attribute "'+value+'" missed value!! "'+value+'" instead!!')}addAttribute(value,value,start)}break;case S_EQ:if(!isHTML){return errorHandler.fatalError("AttValue: ' or \" expected")}}return p;case"":c=" ";default:if(c<=" "){switch(s){case S_TAG:el.setTagName(source.slice(start,p));s=S_TAG_SPACE;break;case S_ATTR:attrName=source.slice(start,p);s=S_ATTR_SPACE;break;case S_ATTR_NOQUOT_VALUE:var value=source.slice(start,p);errorHandler.warning('attribute "'+value+'" missed quot(")!!');addAttribute(attrName,value,start);case S_ATTR_END:s=S_TAG_SPACE;break}}else{switch(s){case S_ATTR_SPACE:if(!isHTML){errorHandler.warning('attribute "'+attrName+'" missed value!! "'+attrName+'" instead2!!')}addAttribute(attrName,attrName,start);start=p;s=S_ATTR;break;case S_ATTR_END:errorHandler.warning('attribute space is required"'+attrName+'"!!');case S_TAG_SPACE:s=S_ATTR;start=p;break;case S_EQ:s=S_ATTR_NOQUOT_VALUE;start=p;break;case S_TAG_CLOSE:throw new Error("elements closed character '/' and '>' must be connected to")}}}p++}}function appendElement(el,domBuilder,currentNSMap){var tagName=el.tagName;var localNSMap=null;var i=el.length;while(i--){var a=el[i];var qName=a.qName;var value=a.value;var nsp=qName.indexOf(":");if(nsp>0){var prefix=a.prefix=qName.slice(0,nsp);var localName=qName.slice(nsp+1);var nsPrefix=prefix==="xmlns"&&localName}else{localName=qName;prefix=null;nsPrefix=qName==="xmlns"&&""}a.localName=localName;if(nsPrefix!==false){if(localNSMap==null){localNSMap=Object.create(null);_copy(currentNSMap,currentNSMap=Object.create(null))}currentNSMap[nsPrefix]=localNSMap[nsPrefix]=value;a.uri=NAMESPACE.XMLNS;domBuilder.startPrefixMapping(nsPrefix,value)}}var i=el.length;while(i--){a=el[i];if(a.prefix){if(a.prefix==="xml"){a.uri=NAMESPACE.XML}if(a.prefix!=="xmlns"){a.uri=currentNSMap[a.prefix]}}}var nsp=tagName.indexOf(":");if(nsp>0){prefix=el.prefix=tagName.slice(0,nsp);localName=el.localName=tagName.slice(nsp+1)}else{prefix=null;localName=el.localName=tagName}var ns=el.uri=currentNSMap[prefix||""];domBuilder.startElement(ns,localName,tagName,el);if(el.closed){domBuilder.endElement(ns,localName,tagName);if(localNSMap){for(prefix in localNSMap){if(hasOwn(localNSMap,prefix)){domBuilder.endPrefixMapping(prefix)}}}}else{el.currentNSMap=currentNSMap;el.localNSMap=localNSMap;return true}}function parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){var isEscapableRaw=isHTMLEscapableRawTextElement(tagName);if(isEscapableRaw||isHTMLRawTextElement(tagName)){var elEndStart=source.indexOf("</"+tagName+">",elStartEnd);var text=source.substring(elStartEnd+1,elEndStart);if(isEscapableRaw){text=text.replace(ENTITY_REG,entityReplacer)}domBuilder.characters(text,0,text.length);return elEndStart}return elStartEnd+1}function _copy(source,target){for(var n in source){if(hasOwn(source,n)){target[n]=source[n]}}}function parseUtils(source,start){var index=start;function char(n){n=n||0;return source.charAt(index+n)}function skip(n){n=n||1;index+=n}function skipBlanks(){var blanks=0;while(index<source.length){var c=char();if(c!==" "&&c!=="\n"&&c!=="\t"&&c!=="\r"){return blanks}blanks++;skip()}return-1}function substringFromIndex(){return source.substring(index)}function substringStartsWith(text){return source.substring(index,index+text.length)===text}function substringStartsWithCaseInsensitive(text){return source.substring(index,index+text.length).toUpperCase()===text.toUpperCase()}function getMatch(args){var expr=g.reg("^",args);var match=expr.exec(substringFromIndex());if(match){skip(match[0].length);return match[0]}return null}return{char:char,getIndex:function(){return index},getMatch:getMatch,getSource:function(){return source},skip:skip,skipBlanks:skipBlanks,substringFromIndex:substringFromIndex,substringStartsWith:substringStartsWith,substringStartsWithCaseInsensitive:substringStartsWithCaseInsensitive}}function parseDoctypeInternalSubset(p,errorHandler){function parsePI(p,errorHandler){var match=g.PI.exec(p.substringFromIndex());if(!match){return errorHandler.fatalError("processing instruction is not well-formed at position "+p.getIndex())}if(match[1].toLowerCase()==="xml"){return errorHandler.fatalError("xml declaration is only allowed at the start of the document, but found at position "+p.getIndex())}p.skip(match[0].length);return match[0]}var source=p.getSource();if(p.char()==="["){p.skip(1);var intSubsetStart=p.getIndex();while(p.getIndex()<source.length){p.skipBlanks();if(p.char()==="]"){var internalSubset=source.substring(intSubsetStart,p.getIndex());p.skip(1);return internalSubset}var current=null;if(p.char()==="<"&&p.char(1)==="!"){switch(p.char(2)){case"E":if(p.char(3)==="L"){current=p.getMatch(g.elementdecl)}else if(p.char(3)==="N"){current=p.getMatch(g.EntityDecl)}break;case"A":current=p.getMatch(g.AttlistDecl);break;case"N":current=p.getMatch(g.NotationDecl);break;case"-":current=p.getMatch(g.Comment);break}}else if(p.char()==="<"&&p.char(1)==="?"){current=parsePI(p,errorHandler)}else if(p.char()==="%"){current=p.getMatch(g.PEReference)}else{return errorHandler.fatalError("Error detected in Markup declaration")}if(!current){return errorHandler.fatalError("Error in internal subset at position "+p.getIndex())}}return errorHandler.fatalError("doctype internal subset is not well-formed, missing ]")}}function parseDoctypeCommentOrCData(source,start,domBuilder,errorHandler,isHTML){var p=parseUtils(source,start);switch(isHTML?p.char(2).toUpperCase():p.char(2)){case"-":var comment=p.getMatch(g.Comment);if(comment){domBuilder.comment(comment,g.COMMENT_START.length,comment.length-g.COMMENT_START.length-g.COMMENT_END.length);return p.getIndex()}else{return errorHandler.fatalError("comment is not well-formed at position "+p.getIndex())}case"[":var cdata=p.getMatch(g.CDSect);if(cdata){if(!isHTML&&!domBuilder.currentElement){return errorHandler.fatalError("CDATA outside of element")}domBuilder.startCDATA();domBuilder.characters(cdata,g.CDATA_START.length,cdata.length-g.CDATA_START.length-g.CDATA_END.length);domBuilder.endCDATA();return p.getIndex()}else{return errorHandler.fatalError("Invalid CDATA starting at position "+start)}case"D":{if(domBuilder.doc&&domBuilder.doc.documentElement){return errorHandler.fatalError("Doctype not allowed inside or after documentElement at position "+p.getIndex())}if(isHTML?!p.substringStartsWithCaseInsensitive(g.DOCTYPE_DECL_START):!p.substringStartsWith(g.DOCTYPE_DECL_START)){return errorHandler.fatalError("Expected "+g.DOCTYPE_DECL_START+" at position "+p.getIndex())}p.skip(g.DOCTYPE_DECL_START.length);if(p.skipBlanks()<1){return errorHandler.fatalError("Expected whitespace after "+g.DOCTYPE_DECL_START+" at position "+p.getIndex())}var doctype={name:undefined,publicId:undefined,systemId:undefined,internalSubset:undefined};doctype.name=p.getMatch(g.Name);if(!doctype.name)return errorHandler.fatalError("doctype name missing or contains unexpected characters at position "+p.getIndex());if(isHTML&&doctype.name.toLowerCase()!=="html"){errorHandler.warning("Unexpected DOCTYPE in HTML document at position "+p.getIndex())}p.skipBlanks();if(p.substringStartsWith(g.PUBLIC)||p.substringStartsWith(g.SYSTEM)){var match=g.ExternalID_match.exec(p.substringFromIndex());if(!match){return errorHandler.fatalError("doctype external id is not well-formed at position "+p.getIndex())}if(match.groups.SystemLiteralOnly!==undefined){doctype.systemId=match.groups.SystemLiteralOnly}else{doctype.systemId=match.groups.SystemLiteral;doctype.publicId=match.groups.PubidLiteral}p.skip(match[0].length)}else if(isHTML&&p.substringStartsWithCaseInsensitive(g.SYSTEM)){p.skip(g.SYSTEM.length);if(p.skipBlanks()<1){return errorHandler.fatalError("Expected whitespace after "+g.SYSTEM+" at position "+p.getIndex())}doctype.systemId=p.getMatch(g.ABOUT_LEGACY_COMPAT_SystemLiteral);if(!doctype.systemId){return errorHandler.fatalError("Expected "+g.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+g.SYSTEM+" at position "+p.getIndex())}}if(isHTML&&doctype.systemId&&!g.ABOUT_LEGACY_COMPAT_SystemLiteral.test(doctype.systemId)){errorHandler.warning("Unexpected doctype.systemId in HTML document at position "+p.getIndex())}if(!isHTML){p.skipBlanks();doctype.internalSubset=parseDoctypeInternalSubset(p,errorHandler)}p.skipBlanks();if(p.char()!==">"){return errorHandler.fatalError("doctype not terminated with > at position "+p.getIndex())}p.skip(1);domBuilder.startDTD(doctype.name,doctype.publicId,doctype.systemId,doctype.internalSubset);domBuilder.endDTD();return p.getIndex()}default:return errorHandler.fatalError('Not well-formed XML starting with "<!" at position '+start)}}function parseProcessingInstruction(source,start,domBuilder,errorHandler){var match=source.substring(start).match(g.PI);if(!match){return errorHandler.fatalError("Invalid processing instruction starting at position "+start)}if(match[1].toLowerCase()==="xml"){if(start>0){return errorHandler.fatalError("processing instruction at position "+start+" is an xml declaration which is only at the start of the document")}if(!g.XMLDecl.test(source.substring(start))){return errorHandler.fatalError("xml declaration is not well-formed")}}domBuilder.processingInstruction(match[1],match[2]);return start+match[0].length}function ElementAttributes(){this.attributeNames=Object.create(null)}ElementAttributes.prototype={setTagName:function(tagName){if(!g.QName_exact.test(tagName)){throw new Error("invalid tagName:"+tagName)}this.tagName=tagName},addValue:function(qName,value,offset){if(!g.QName_exact.test(qName)){throw new Error("invalid attribute:"+qName)}this.attributeNames[qName]=this.length;this[this.length++]={qName:qName,value:value,offset:offset}},length:0,getLocalName:function(i){return this[i].localName},getLocator:function(i){return this[i].locator},getQName:function(i){return this[i].qName},getURI:function(i){return this[i].uri},getValue:function(i){return this[i].value}};exports.XMLReader=XMLReader;exports.parseUtils=parseUtils;exports.parseDoctypeCommentOrCData=parseDoctypeCommentOrCData},{"./conventions":34,"./errors":38,"./grammar":39}],"/src/js/docxtemplater.js":[function(require,module,exports){(function(Buffer){"use strict";var _excluded=["modules"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var DocUtils=require("./doc-utils.js");var _require=require("./get-relation-types.js"),getRelsTypes=_require.getRelsTypes;var _require2=require("./get-content-types.js"),collectContentTypes=_require2.collectContentTypes,getContentTypes=_require2.getContentTypes;var moduleWrapper=require("./module-wrapper.js");var traits=require("./traits.js");var commonModule=require("./modules/common.js");var createScope=require("./scope-manager.js");var Lexer=require("./lexer.js");var _require3=require("./get-tags.js"),_getTags=_require3.getTags;var logErrors=require("./error-logger.js");var _require4=require("./errors.js"),throwMultiError=_require4.throwMultiError,throwResolveBeforeCompile=_require4.throwResolveBeforeCompile,throwRenderInvalidTemplate=_require4.throwRenderInvalidTemplate,throwRenderTwice=_require4.throwRenderTwice,XTInternalError=_require4.XTInternalError,XTTemplateError=_require4.XTTemplateError,throwFileTypeNotIdentified=_require4.throwFileTypeNotIdentified,throwFileTypeNotHandled=_require4.throwFileTypeNotHandled,throwApiVersionError=_require4.throwApiVersionError;DocUtils.getRelsTypes=getRelsTypes;DocUtils.traits=traits;DocUtils.moduleWrapper=moduleWrapper;DocUtils.collectContentTypes=collectContentTypes;DocUtils.getContentTypes=getContentTypes;var getDefaults=DocUtils.getDefaults,str2xml=DocUtils.str2xml,xml2str=DocUtils.xml2str,concatArrays=DocUtils.concatArrays,uniq=DocUtils.uniq,getDuplicates=DocUtils.getDuplicates,stableSort=DocUtils.stableSort,pushArray=DocUtils.pushArray,utf8ToWord=DocUtils.utf8ToWord,invertMap=DocUtils.invertMap;var ctXML="[Content_Types].xml";var relsFile="_rels/.rels";var currentModuleApiVersion=[3,47,0];function throwIfDuplicateModules(modules){var duplicates=getDuplicates(modules.map(function(_ref){var name=_ref.name;return name}));if(duplicates.length>0){throw new XTInternalError('Detected duplicate module "'.concat(duplicates[0],'"'))}}function addXmlFileNamesFromXmlContentType(doc){for(var _i2=0,_doc$modules2=doc.modules;_i2<_doc$modules2.length;_i2++){var _module=_doc$modules2[_i2];for(var _i4=0,_ref3=_module.xmlContentTypes||[];_i4<_ref3.length;_i4++){var contentType=_ref3[_i4];var candidates=doc.invertedContentTypes[contentType]||[];for(var _i6=0;_i6<candidates.length;_i6++){var candidate=candidates[_i6];if(doc.zip.files[candidate]){doc.options.xmlFileNames.push(candidate)}}}}}function reorderModules(modules){return stableSort(modules,function(m1,m2){return(m2.priority||0)-(m1.priority||0)})}function zipFileOrder(files){var allFiles=[];for(var name in files){allFiles.push(name)}var resultFiles=[ctXML,relsFile];var prefixes=["word/","xl/","ppt/"];for(var _i8=0;_i8<allFiles.length;_i8++){var _name=allFiles[_i8];for(var _i0=0;_i0<prefixes.length;_i0++){var prefix=prefixes[_i0];if(_name.indexOf("".concat(prefix))===0){resultFiles.push(_name)}}}for(var _i10=0;_i10<allFiles.length;_i10++){var _name2=allFiles[_i10];if(resultFiles.indexOf(_name2)===-1){resultFiles.push(_name2)}}return resultFiles}function deprecatedMessage(obj,message){if(obj.hideDeprecations===true){return}console.warn(message)}function deprecatedMethod(obj,method){if(obj.hideDeprecations===true){return}return deprecatedMessage(obj,'Deprecated method ".'.concat(method,'", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ').concat((new Error).stack))}function dropUnsupportedFileTypesModules(doc){doc.modules=doc.modules.filter(function(module){if(!module.supportedFileTypes){return true}if(!Array.isArray(module.supportedFileTypes)){throw new Error("The supportedFileTypes field of the module must be an array")}var isSupportedModule=module.supportedFileTypes.includes(doc.fileType);if(!isSupportedModule){module.on("detached")}return isSupportedModule})}function verifyErrors(doc){var compiled=doc.compiled;doc.errors=concatArrays(Object.keys(compiled).map(function(name){return compiled[name].allErrors}));if(doc.errors.length!==0){if(doc.options.errorLogging){logErrors(doc.errors,doc.options.errorLogging)}throwMultiError(doc.errors)}}function isBuffer(v){return typeof Buffer!=="undefined"&&typeof Buffer.isBuffer==="function"&&Buffer.isBuffer(v)}var Docxtemplater=function(){function Docxtemplater(zip){var _ref4=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref4$modules=_ref4.modules,modules=_ref4$modules===void 0?[]:_ref4$modules,options=_objectWithoutProperties(_ref4,_excluded);_classCallCheck(this,Docxtemplater);this.targets=[];this.rendered=false;this.scopeManagers={};this.compiled={};this.modules=[commonModule()];this.xmlDocuments={};if(arguments.length===0){deprecatedMessage(this,"Deprecated docxtemplater constructor with no arguments, view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ".concat((new Error).stack));this.hideDeprecations=true;this.setOptions(options)}else{this.hideDeprecations=true;this.setOptions(options);if(isBuffer(zip)){throw new Error("You passed a Buffer to the Docxtemplater constructor. The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)")}if(!zip||!zip.files||typeof zip.file!=="function"){throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)")}if(!Array.isArray(modules)){throw new Error("The modules argument of docxtemplater's constructor must be an array")}for(var _i12=0;_i12<modules.length;_i12++){var _module2=modules[_i12];this.attachModule(_module2)}this.loadZip(zip);this.compile();this.v4Constructor=true}this.hideDeprecations=false}return _createClass(Docxtemplater,[{key:"verifyApiVersion",value:function verifyApiVersion(neededVersion){neededVersion=neededVersion.split(".").map(function(i){return parseInt(i,10)});if(neededVersion.length!==3){throwApiVersionError("neededVersion is not a valid version",{neededVersion:neededVersion,explanation:"the neededVersion must be an array of length 3"})}if(neededVersion[0]!==currentModuleApiVersion[0]){throwApiVersionError("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:neededVersion,currentModuleApiVersion:currentModuleApiVersion,explanation:"moduleAPIVersionMismatch : needed=".concat(neededVersion.join("."),", current=").concat(currentModuleApiVersion.join("."))})}if(neededVersion[1]>currentModuleApiVersion[1]){throwApiVersionError("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:neededVersion,currentModuleApiVersion:currentModuleApiVersion,explanation:"moduleAPIVersionMismatch : needed=".concat(neededVersion.join("."),", current=").concat(currentModuleApiVersion.join("."))})}if(neededVersion[1]===currentModuleApiVersion[1]&&neededVersion[2]>currentModuleApiVersion[2]){throwApiVersionError("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:neededVersion,currentModuleApiVersion:currentModuleApiVersion,explanation:"moduleAPIVersionMismatch : needed=".concat(neededVersion.join("."),", current=").concat(currentModuleApiVersion.join("."))})}return true}},{key:"setModules",value:function setModules(obj){for(var _i14=0,_this$modules2=this.modules;_i14<_this$modules2.length;_i14++){var _module3=_this$modules2[_i14];_module3.set(obj)}}},{key:"sendEvent",value:function sendEvent(eventName){for(var _i16=0,_this$modules4=this.modules;_i16<_this$modules4.length;_i16++){var _module4=_this$modules4[_i16];_module4.on(eventName)}}},{key:"attachModule",value:function attachModule(module){if(this.v4Constructor){throw new XTInternalError("attachModule() should not be called manually when using the v4 constructor")}deprecatedMethod(this,"attachModule");var moduleType=_typeof(module);if(moduleType==="function"){throw new XTInternalError("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.")}if(!module||moduleType!=="object"){throw new XTInternalError("Cannot attachModule with a falsy value")}if(module.requiredAPIVersion){this.verifyApiVersion(module.requiredAPIVersion)}if(module.attached===true){if(typeof module.clone==="function"){module=module.clone()}else{throw new Error('Cannot attach a module that was already attached : "'.concat(module.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'))}}module.attached=true;var wrappedModule=moduleWrapper(module);this.modules.push(wrappedModule);wrappedModule.on("attached");if(this.fileType){dropUnsupportedFileTypesModules(this)}return this}},{key:"setOptions",value:function setOptions(options){var _this$delimiters,_this$delimiters2;if(this.v4Constructor){throw new Error("setOptions() should not be called manually when using the v4 constructor")}deprecatedMethod(this,"setOptions");if(!options){throw new Error("setOptions should be called with an object as first parameter")}this.options={};var defaults=getDefaults();for(var key in defaults){var defaultValue=defaults[key];this.options[key]=options[key]!=null?options[key]:this[key]||defaultValue;this[key]=this.options[key]}(_this$delimiters=this.delimiters).start&&(_this$delimiters.start=utf8ToWord(this.delimiters.start));(_this$delimiters2=this.delimiters).end&&(_this$delimiters2.end=utf8ToWord(this.delimiters.end));return this}},{key:"loadZip",value:function loadZip(zip){if(this.v4Constructor){throw new Error("loadZip() should not be called manually when using the v4 constructor")}deprecatedMethod(this,"loadZip");if(zip.loadAsync){throw new XTInternalError("Docxtemplater doesn't handle JSZip version >=3, please use pizzip")}this.zip=zip;this.updateFileTypeConfig();this.modules=concatArrays([this.fileTypeConfig.baseModules.map(function(moduleFunction){return moduleFunction()}),this.modules]);for(var _i18=0,_this$modules6=this.modules;_i18<_this$modules6.length;_i18++){var _module5=_this$modules6[_i18];_module5.zip=this.zip;_module5.docxtemplater=this}dropUnsupportedFileTypesModules(this);return this}},{key:"precompileFile",value:function precompileFile(fileName){var currentFile=this.createTemplateClass(fileName);currentFile.preparse();this.compiled[fileName]=currentFile}},{key:"compileFile",value:function compileFile(fileName){this.compiled[fileName].parse()}},{key:"getScopeManager",value:function getScopeManager(to,currentFile,tags){var _this$scopeManagers;(_this$scopeManagers=this.scopeManagers)[to]||(_this$scopeManagers[to]=createScope({tags:tags,parser:this.parser,cachedParsers:currentFile.cachedParsers}));return this.scopeManagers[to]}},{key:"resolveData",value:function resolveData(data){var _this=this;deprecatedMethod(this,"resolveData");var errors=[];if(!Object.keys(this.compiled).length){throwResolveBeforeCompile()}return Promise.resolve(data).then(function(data){_this.data=data;_this.setModules({data:_this.data,Lexer:Lexer});_this.mapper=_this.modules.reduce(function(value,module){return module.getRenderedMap(value)},{});return Promise.all(Object.keys(_this.mapper).map(function(to){var _this$mapper$to=_this.mapper[to],from=_this$mapper$to.from,data=_this$mapper$to.data;return Promise.resolve(data).then(function(data){var currentFile=_this.compiled[from];currentFile.filePath=to;currentFile.scopeManager=_this.getScopeManager(to,currentFile,data);return currentFile.resolveTags(data).then(function(result){currentFile.scopeManager.finishedResolving=true;return result},function(errs){pushArray(errors,errs)})})})).then(function(resolved){if(errors.length!==0){if(_this.options.errorLogging){logErrors(errors,_this.options.errorLogging)}throwMultiError(errors)}return concatArrays(resolved)})})}},{key:"compile",value:function compile(){deprecatedMethod(this,"compile");this.updateFileTypeConfig();throwIfDuplicateModules(this.modules);this.modules=reorderModules(this.modules);if(Object.keys(this.compiled).length){return this}var options=this.options;for(var _i20=0,_this$modules8=this.modules;_i20<_this$modules8.length;_i20++){var _module6=_this$modules8[_i20];options=_module6.optionsTransformer(options,this)}this.options=options;this.options.xmlFileNames=uniq(this.options.xmlFileNames);for(var _i22=0,_this$options$xmlFile2=this.options.xmlFileNames;_i22<_this$options$xmlFile2.length;_i22++){var fileName=_this$options$xmlFile2[_i22];var content=this.zip.files[fileName].asText();this.xmlDocuments[fileName]=str2xml(content)}this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments});this.getTemplatedFiles();this.sendEvent("before-preparse");for(var _i24=0,_this$templatedFiles2=this.templatedFiles;_i24<_this$templatedFiles2.length;_i24++){var _fileName=_this$templatedFiles2[_i24];if(this.zip.files[_fileName]!=null){this.precompileFile(_fileName)}}this.sendEvent("after-preparse");for(var _i26=0,_this$templatedFiles4=this.templatedFiles;_i26<_this$templatedFiles4.length;_i26++){var _fileName2=_this$templatedFiles4[_i26];if(this.zip.files[_fileName2]!=null){this.compiled[_fileName2].parse({noPostParse:true})}}this.sendEvent("after-parse");for(var _i28=0,_this$templatedFiles6=this.templatedFiles;_i28<_this$templatedFiles6.length;_i28++){var _fileName3=_this$templatedFiles6[_i28];if(this.zip.files[_fileName3]!=null){this.compiled[_fileName3].postparse()}}this.sendEvent("after-postparse");this.setModules({compiled:this.compiled});verifyErrors(this);return this}},{key:"updateFileTypeConfig",value:function updateFileTypeConfig(){this.relsTypes=getRelsTypes(this.zip);var _getContentTypes=getContentTypes(this.zip),overrides=_getContentTypes.overrides,defaults=_getContentTypes.defaults,contentTypes=_getContentTypes.contentTypes,contentTypeXml=_getContentTypes.contentTypeXml;if(contentTypeXml){this.filesContentTypes=collectContentTypes(overrides,defaults,this.zip);this.invertedContentTypes=invertMap(this.filesContentTypes);this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})}var fileType;if(this.zip.files.mimetype){fileType="odt"}for(var _i30=0,_this$modules0=this.modules;_i30<_this$modules0.length;_i30++){var _module7=_this$modules0[_i30];fileType=_module7.getFileType({zip:this.zip,contentTypes:contentTypes,contentTypeXml:contentTypeXml,overrides:overrides,defaults:defaults,doc:this})||fileType}this.fileType=fileType;if(fileType==="odt"){throwFileTypeNotHandled(fileType)}if(!fileType){throwFileTypeNotIdentified(this.zip)}addXmlFileNamesFromXmlContentType(this);dropUnsupportedFileTypesModules(this);this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig;if(!this.fileTypeConfig){if(Docxtemplater.FileTypeConfig[this.fileType]){this.fileTypeConfig=Docxtemplater.FileTypeConfig[this.fileType]()}else{var message='Filetype "'.concat(this.fileType,'" is not supported');var id="filetype_not_supported";if(this.fileType==="xlsx"){message='Filetype "'.concat(this.fileType,'" is supported only with the paid XlsxModule');id="xlsx_filetype_needs_xlsx_module"}var err=new XTTemplateError(message);err.properties={id:id,explanation:message};throw err}}return this}},{key:"renderAsync",value:function renderAsync(data){var _this2=this;this.hideDeprecations=true;var promise=this.resolveData(data);this.hideDeprecations=false;return promise.then(function(){return _this2.render()})}},{key:"render",value:function render(data){if(this.rendered){throwRenderTwice()}this.rendered=true;if(Object.keys(this.compiled).length===0){this.compile()}if(this.errors.length>0){throwRenderInvalidTemplate()}if(arguments.length>0){this.data=data}this.setModules({data:this.data,Lexer:Lexer});this.mapper||(this.mapper=this.modules.reduce(function(value,module){return module.getRenderedMap(value)},{}));var output=[];for(var to in this.mapper){var _this$mapper$to2=this.mapper[to],from=_this$mapper$to2.from,_data=_this$mapper$to2.data;var currentFile=this.compiled[from];currentFile.scopeManager=this.getScopeManager(to,currentFile,_data);currentFile.render(to);output.push([to,currentFile.content,currentFile]);delete currentFile.content}for(var _i32=0;_i32<output.length;_i32++){var outputPart=output[_i32];var _outputPart=_slicedToArray(outputPart,3),content=_outputPart[1],_currentFile=_outputPart[2];for(var _i34=0,_this$modules10=this.modules;_i34<_this$modules10.length;_i34++){var _module8=_this$modules10[_i34];if(_module8.preZip){var result=_module8.preZip(content,_currentFile);if(typeof result==="string"){outputPart[1]=result}}}}for(var _i36=0;_i36<output.length;_i36++){var _output$_i=_slicedToArray(output[_i36],2),_to=_output$_i[0],_content=_output$_i[1];this.zip.file(_to,_content,{createFolders:true})}verifyErrors(this);this.sendEvent("syncing-zip");this.syncZip();this.sendEvent("synced-zip");return this}},{key:"syncZip",value:function syncZip(){for(var fileName in this.xmlDocuments){this.zip.remove(fileName);var content=xml2str(this.xmlDocuments[fileName]);this.zip.file(fileName,content,{createFolders:true})}}},{key:"setData",value:function setData(data){deprecatedMethod(this,"setData");this.data=data;return this}},{key:"getZip",value:function getZip(){return this.zip}},{key:"createTemplateClass",value:function createTemplateClass(path){var content=this.zip.files[path].asText();return this.createTemplateClassFromContent(content,path)}},{key:"createTemplateClassFromContent",value:function createTemplateClassFromContent(content,filePath){var xmltOptions={filePath:filePath,contentType:this.filesContentTypes[filePath],relsType:this.relsTypes[filePath]};var defaults=getDefaults();var defaultKeys=pushArray(Object.keys(defaults),["filesContentTypes","fileTypeConfig","fileType","modules"]);for(var _i38=0;_i38<defaultKeys.length;_i38++){var key=defaultKeys[_i38];xmltOptions[key]=this[key]}return new Docxtemplater.XmlTemplater(content,xmltOptions)}},{key:"getFullText",value:function getFullText(path){return this.createTemplateClass(path||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function getTemplatedFiles(){this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip);pushArray(this.templatedFiles,this.targets);this.templatedFiles=uniq(this.templatedFiles);return this.templatedFiles}},{key:"getTags",value:function getTags(){var result={headers:[],footers:[]};for(var key in this.compiled){var contentType=this.filesContentTypes[key];if(contentType==="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"){result.document={target:key,tags:_getTags(this.compiled[key].postparsed)}}if(contentType==="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"){result.headers.push({target:key,tags:_getTags(this.compiled[key].postparsed)})}if(contentType==="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"){result.footers.push({target:key,tags:_getTags(this.compiled[key].postparsed)})}}return result}},{key:"toBuffer",value:function toBuffer(options){return this.zip.generate(_objectSpread(_objectSpread({compression:"DEFLATE",fileOrder:zipFileOrder},options),{},{type:"nodebuffer"}))}},{key:"toBlob",value:function toBlob(options){return this.zip.generate(_objectSpread(_objectSpread({compression:"DEFLATE",fileOrder:zipFileOrder},options),{},{type:"blob"}))}},{key:"toBase64",value:function toBase64(options){return this.zip.generate(_objectSpread(_objectSpread({compression:"DEFLATE",fileOrder:zipFileOrder},options),{},{type:"base64"}))}},{key:"toUint8Array",value:function toUint8Array(options){return this.zip.generate(_objectSpread(_objectSpread({compression:"DEFLATE",fileOrder:zipFileOrder},options),{},{type:"uint8array"}))}},{key:"toArrayBuffer",value:function toArrayBuffer(options){return this.zip.generate(_objectSpread(_objectSpread({compression:"DEFLATE",fileOrder:zipFileOrder},options),{},{type:"arraybuffer"}))}}])}();Docxtemplater.DocUtils=DocUtils;Docxtemplater.Errors=require("./errors.js");Docxtemplater.XmlTemplater=require("./xml-templater.js");Docxtemplater.FileTypeConfig=require("./file-type-config.js");Docxtemplater.XmlMatcher=require("./xml-matcher.js");module.exports=Docxtemplater;module.exports["default"]=Docxtemplater}).call(this,require("buffer").Buffer)},{"./doc-utils.js":5,"./error-logger.js":6,"./errors.js":7,"./file-type-config.js":8,"./get-content-types.js":10,"./get-relation-types.js":11,"./get-tags.js":13,"./lexer.js":15,"./module-wrapper.js":17,"./modules/common.js":18,"./scope-manager.js":29,"./traits.js":30,"./xml-matcher.js":32,"./xml-templater.js":33,buffer:2}]},{},[])("/src/js/docxtemplater.js")});
